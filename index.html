<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Desktop App</title>
    <link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Cpath d='M0 2v20h32v-20h-32zM30 20h-28v-16h28v16zM21 24h-10l-1 4-2 2h16l-2-2z'%3E%3C/path%3E%3C/svg%3E" />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Cpath d='M0 2v20h32v-20h-32zM30 20h-28v-16h28v16zM21 24h-10l-1 4-2 2h16l-2-2z'%3E%3C/path%3E%3C/svg%3E" />
    <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/kindeditor@4.1.10/plugins/code/prettify.css" />
    <style type="text/css">
        #loader{position:fixed;top:0;right:0;bottom:0;left:0;background-color:rgba(0,0,0,.1);z-index:99999}
        #loader .inner{position:absolute;top:0;right:0;bottom:0;left:0;width:240px;height:130px;margin:auto;padding-top:15px;text-align:center;color:#777;background-color:rgba(255,255,255,.8);z-index:100;border-radius:15px}
        #carousel-example-generic>.carousel-inner>.item>a.thumbnail{padding:0;margin-bottom:0}
        #carousel-example-generic>.carousel-inner>.item>a>img{max-height:150px}
        @media screen and (min-width:768px){#carousel-example-generic>.carousel-inner>.item>a>img{max-height:200px}}
        @media screen and (min-width:992px){#carousel-example-generic>.carousel-inner>.item>a>img{max-height:280px}}
        @media screen and (min-width:1200px){#carousel-example-generic>.carousel-inner>.item>a>img{max-height:380px}}
        .entry-content{font-size:16px}
        .entry-content>*{margin:25px 0}
        .entry-content>.tts{margin:0;padding:0;border:0;border-radius:0;background-color:#fde6e0}
        .entry-content>div.tts,.entry-content>p.tts{margin:15px 0;padding:10px;border:1px solid #dcd6d6;border-radius:3px;background-color:#f9f2f4}
        pre.prettyprint{font-size:13px}
        pre.prettyprint>ol.linenums>li{list-style-type:decimal}
        .share-container{max-width:600px;margin:10px auto}
        .share-container>.share-btn,.share-container>.share-to{display:inline-block;width:40px;height:40px;margin:3px;border-radius:50%;position:relative}
        .share-container>.share-btn{background:#f8f9fa;border:1px solid #ddd;transition:all .3s}
        .share-container>.share-btn:hover{transform:scale(1.1);box-shadow:0 2px 8px rgba(0,0,0,.3);text-decoration:none}
        .share-container>.share-btn>.share-icon,.share-container>.share-to>.share-icon{position:absolute;top:50%;left:50%;margin-left:-30%;margin-top:-30%;width:60%;height:60%}
        .share-container>.wechat{background-color:#09bb07}
        .share-container>.qq{background-color:#12b7f5}
        .share-container>.weibo{background-color:#e6162d}
        .share-container>.facebook{background-color:#1877f2}
        .share-container>.twitter{background-color:#1da1f2}
        .share-container>.linkedin{background-color:#0a66c2}
        .share-container>.pinterest{background-color:#bd081c}
        .share-container>.whatsapp{background-color:#25d366}
        .share-container>.telegram{background-color:#2aabee}
        .share-container>.email{background-color:#777}
        .share-container>.share-btn>.share-icon>path{fill:#fff}
        #loading{margin:15px 0}
        .icon-loading::before{content:'';display:inline-block;min-width:16px;min-height:16px}
        .thumbnail img,img.img-thumbnail{min-width:64px;min-height:64px}
        .icon-loading::before,.carousel .carousel-inner .item img,.thumbnail img,img.img-thumbnail{background:url('data:image/gif;base64,R0lGODlhEAAQAPULAOfn597e3qWlpb29va2trcbGxu/v787OzrW1tdbW1vf392RkZJCQkCUlJf///3Nzc4uLiz09PW9vbz4+Pj8/Pzo6OpiYmH19fUFBQS4uLo2NjUBAQGtra5SUlH9/fzk5OWdnZ4GBgTU1NXZ2di8vLzw8PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwH//wAh+QQFBgALACwAAAAAEAAQAEAGlsCFcOEQIkbFoVDQaQaUQgMCQRg4RqOBYtQ5IAQEBeCrWAQAC4Ag4VUnFoZEMk0aLTqkxUGAhu7nQglvQwoFHWFQAwIFBkoABGgFBA4KBIOOI294lAhPQwBoCCQDeHsHC2JFASN1CmVEhQIIaIoCAp5KhQMDBZ8HgGZ9RF8HhQkKBgFaCWCvqFMOkgsFAo1QlEIHVqhzQQAh+QQFBgALACwAAAAADQALAAAFQeAijovwkOQTLE8kRsNoPGe7QFEhGkuRt4nI6QY5sASLWIS3AJggJIUBQUrEUKLDAIEAYEUDAqH7JRlW5cUBWQ4BACH5BAUGAAsALAEAAAAPAAgAAAU+4CKORDeeYwcsnrcYLsoKS+d2n7wcXmIvn1hggRAkaoPAgZBLfD4Gw0CAODkUnifCIQIcZB7TaFAwyADiRQgAIfkEBQYACwAsAwAAAA0ACgAABTzgIi6DMJ4GIgrXolzHqBAquwhVPAYmYQUVyylAKgASg1ahUlGMHKcLc3CqWkzV7MViIWRFQGbluyBQRSEAIfkECQYACgAsBQAAAAsADQAABT6gohyDaIqGUhCikJhlISiIFJyBDEjIORqBA2QkkfhEEIzkcFQQek1kcXiUYJRHRCHquM58CQkgiWmWEgJHCAAh+QQFBgALACwFAAAACwAQAAAGacDF4jBwCI8Lw6JAcCgQgeNgSRgKAEdBgGkQHBYKgGNwMAACBEPC4lEojAsnwWNJxJHLAh5pYNP3AB6CHnBHCHpCCkgOHiUeUQUJYQQlAAIlJQoCCQcWCCUICwkIhUKYWHsLAKCpQkpHQQAh+QQFBgALACwGAAQACgAMAAAFO+AiigqACONYCESQjsebEoKAvIYAQWhaxLIFZAMBLASBBIJj4nAUBGdhgwoURJzNIptIbbSLzSDlJKVCACH5BAkGAAsALAMABQANAAsAAAZHwIVwSEQAiMhEAslUFAaDAnNIqA4WS+QhKwQxBSGBYYEIeAGBQsigDgkHIkQIdAARFoDDwiByg0QLcwFDBSKDf3sgUkxzU0EAIfkEBQYADwAsAQAFAA8ACwAABFfwPYGUk04VCuQDx+U9STI+hXE+2jAUkmCeBoIQg3QIohd0EsOi0VCcBoLUg8gALJqABMOQEBAUiACqQWAsEgsYVSRcOLyPLtCTaOS8DgPjcMrEGBeLJwIAIfkEBQYACwAsAAAGAA0ACgAABTjgIhaMaJrSNEnHeTJSXLh0gtCvioupyBAGQ2KgGM0SEwSBERAkTorYQlAaCAwmAGtaWhCeNOspBAAh+QQFBgALACwAAAMACwANAAAFPOBSBMuxnOjyUILxFOkCMBRlKHGeMk+f5KuaDhUY6BQCykO3ahGMC1LJFHgNEIAYg7EYEES7n3eByx2gIQAh+QQFBgALACwAAAEACAAOAAAFOuAiBtkhnkaWnYlYZASxSLAiSW1CS8p5aieBZhj43XA+EcDkGwx9AgliUUj0Fi2AIMEUIaYFHwFADQEAOw==') center no-repeat}
    </style>
</head>

<body>
    <div id="app"></div>
    <script src="https://fastly.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/kindeditor@4.1.10/plugins/code/prettify.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/jquery.qrcode@1.0.3/jquery.qrcode.min.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(function ($) {
            // IE跨域兼容
            $.support.cors = true;
            var render = {
                api: document.domain.match(/localhost|127.0.0.1/i) ? '.' : 'https://jesus-christ.pages.dev',
                token: typeof window.localStorage === 'object' ? localStorage.getItem('webToken') || '' : '',
                langs: ['co', 'gn', 'rw', 'ha', 'no', 'af', 'yo', 'en', 'gom', 'la', 'ne', 'fr', 'cs', 'haw', 'ka', 'ru', 'zh-CN', 'fa', 'bho', 'hi', 'be', 'sw', 'is', 'yi', 'ak', 'ga', 'gu', 'km', 'sk', 'iw', 'kn', 'hu', 'ta', 'ar', 'bn', 'az', 'sm', 'su', 'da', 'sn', 'bm', 'lt', 'vi', 'mt', 'tk', 'as', 'ca', 'si', 'ceb', 'gd', 'sa', 'pl', 'gl', 'lv', 'uk', 'tt', 'cy', 'ja', 'tl', 'ay', 'lo', 'te', 'ro', 'ht', 'doi', 'sv', 'mai', 'th', 'hy', 'my', 'ps', 'hmn', 'dv', 'zh-TW', 'lb', 'sd', 'ku', 'tr', 'mk', 'bg', 'ms', 'lg', 'mr', 'et', 'ml', 'de', 'sl', 'ur', 'pt', 'ig', 'ckb', 'om', 'el', 'es', 'fy', 'so', 'am', 'ny', 'pa', 'eu', 'it', 'sq', 'ko', 'tg', 'fi', 'ky', 'ee', 'hr', 'qu', 'bs', 'mi', 'or', 'ti', 'kk', 'nl', 'kri', 'ln', 'mg', 'mn', 'lus', 'xh', 'zu', 'sr', 'nso', 'st', 'eo', 'mni-Mtei', 'ug', 'uz', 'ilo', 'id', 'jw', 'ts'],
                login: 0,
                timer: null,
                rotateTimer: null,
                affixTop: 0,
                docHeight: 0,
                // 语音朗读
                stopped: true,
                audio: new Audio(),
                audioArray: [],
                textArray: [],
                nodes: [],
                speechInstance: null,
                offLine: false,
                ttsApi: '',
                playErrors: 0,
                playErrorTimer: null,
                voice: '',
                // 定义参数
                lang: 'zh-CN',
                type: 'index',
                slug: 'i',
                p: 1,
                q: '',
                anchor: '',
                limit: 10,
                site_url: '',
                cdn_url: '',
                // 内存缓存
                cache: {},
                init: function () {
                    $(window).on('hashchange', render.router);
                    $(window).on('load', render.router);
                },

                // 哈希路由
                router: function () {
                    var config = render.getConfig() || {};
                    var match = render.parseHash();
                    var lang = config.lang || match[0] || navigator.language || navigator.userLanguage || 'zh-CN';
                    if (/-cn|sg/i.test(lang)) lang = 'zh-CN';
                    if (/-tw|hk|mo/i.test(lang)) lang = 'zh-TW';
                    if (render.langs.indexOf(lang) === -1) {
                        lang = lang.split('-')[0];
                        if (render.langs.indexOf(lang) === -1) {
                            lang = 'zh-CN';
                        }
                    }
                    render.lang = lang;
                    if (match.length) {
                        render.type = match[1];
                        render.slug = match[2];
                        render.p = parseInt(match[3] || 1);
                        render.q = decodeURIComponent(match[4] || '');
                        render.anchor = match[5] || '';
                        if (typeof window.localStorage === 'object' && render.lang != match[0]) location.hash = '#' + render.route();
                        render.setConfig();
                    } else {
                        render.type = config.type || 'index';
                        render.slug = config.slug || 'i';
                        render.p = parseInt(config.p || 1);
                        render.q = decodeURIComponent(config.q || '');
                        render.anchor = config.anchor || '';
                        location.hash = '#'+ render.route();
                    }
                    var t = new Date();
                    var y = t.getFullYear() + '';
                    var m = ('0' + (t.getMonth() + 1)).slice(-2);
                    var d = ('0' + (t.getDate() + 1)).slice(-2); // +1 day
                    if (render.cache[render.lang] && render.cache[render.lang].expires < new Date(y + '-' + m + '-' + d).getTime()) {
                        render.beforeSend();
                        render.dispatch(render.cache[render.lang].datas);
                    } else {
                        $.ajax({
                            url: render.api + '/static/upload/json/' + (render.lang.match(/^zh-/) ? 'zh-CN' : render.lang) + '.json',
                            type: 'GET',
                            dataType: 'json',
                            data: { token: render.token },
                            beforeSend: render.beforeSend,
                            success: render.success,
                            error: render.error,
                        });
                    }
                },

                // 获取设置
                getConfig: function() {
                    return render.getItem('multiBlogConfig');
                },

                // 存储设置
                setConfig: function(lang, type, slug, p, q, anchor) {
                    render.setItem('multiBlogConfig', { lang: lang || render.lang, type: type || render.type, slug: slug || render.slug, p: p || render.p, q: encodeURIComponent(q || '') || encodeURIComponent(render.q), anchor: anchor || render.anchor });
                },

                // 本地存储
                getItem: function (key, type) {
                    var storage = !type ? 'localStorage' : 'sessionStorage';
                    if (typeof window[storage] !== 'object') return false;
                    var value = window[storage].getItem(key);
                    try {
                        return JSON.parse(value)
                    } catch (e) {
                        return value;
                    }
                },
                setItem: function (key, value, type) {
                    var storage = !type ? 'localStorage' : 'sessionStorage';
                    if (typeof window[storage] !== 'object') return false;
                    try {
                        if (typeof value === 'object') {
                            value = JSON.stringify(value);
                        }
                        window[storage].setItem(key, value);
                    } catch (e) {
                        return false;
                    }
                },
                removeItem: function (key, type) {
                    var storage = !type ? 'localStorage' : 'sessionStorage';
                    if (typeof window[storage] !== 'object') return false;
                    try {
                        window[storage].removeItem(key);
                    } catch (e) {
                        return false;
                    }
                },

                // 定义路由
                route: function(lang, type, slug, p, q, anchor) {
                    var path = '';
                    var base = '';
                    if ((type || render.type) == 'index') base = '';
                    if (['category', 'tag', 'page'].indexOf((type || render.type)) !== -1) base = (type || render.type) + '/' + (slug || render.slug);
                    if ((type || render.type) == 'search') base = 'search';
                    if ((type || render.type) == 'detail') base = (slug || render.slug);
                    path += ((lang || render.lang) == 'zh-CN' ? '' : '/' + (lang || render.lang)) + '/' + base + ((p || render.p) == 1 ? '' : (base ? '/' : '') + 'page-' + (p || render.p));
                    path += ((p || render.p) == 1 && (type || render.type) == 'index' ? '' : '.html');
                    path += ((q !== undefined ? q : render.q) && (q !== undefined ? q : render.q).length > 0 ? '?q=' + (q !== undefined ? q : render.q) : '');
                    path += (anchor !== undefined ? anchor : render.anchor);
                    return path;
                },

                // 解析哈希路径
                parseHash: function() {
                    var hash = location.hash.replace('#', '');
                    var lang = 'zh-CN';
                    var match;
                    if (match = hash.match(new RegExp('^/(' + render.langs.join('|') + ')/'))) {
                        lang = match[1];
                        hash = hash.replace(new RegExp('^/'+ match[1] +'/'), '/');
                    }
                    var matches = [];
                    if (match = (hash.match(/^\/$/) || hash.match(/^\/page-(\d+).html$/))) {
                        matches = [lang, 'index', 'i', match[1] ? parseInt(match[1]) : 1, '', ''];
                    } else if (match = (hash.match(/^\/(category|tag|page)\/([a-z0-9_-]+).html$/) || hash.match(/^\/(category|tag|page)\/([a-z0-9_-]+)\/page-(\d+).html$/))) {
                        matches = [lang, match[1], match[2], match[3] ? parseInt(match[3]) : 1, '', '']
                    } else if (match = (hash.match(/^\/search.html\?q=([\s\S]*)$/) || hash.match(/^\/search\/page-(\d+).html\?q=([\s\S]*)$/))) {
                        matches = [lang, 'search', 'i', match[2] == undefined ? 1 : parseInt(match[1]), match[2] == undefined ? match[1] : match[2], ''];
                    } else if (match = (hash.match(/^\/([a-z0-9_-]+).html$/) || hash.match(/^\/([a-z0-9_-]+).html(#\w.+)$/) || hash.match(/^\/([a-z0-9_-]+)\/page-(\d+).html$/))) {
                        matches = [lang, 'detail', match[1], match[2] ? (match[2].match(/^\d+/) ? parseInt(match[2]) : 1) : 1, '', match[2] ? (match[2].match(/^#\w.+/) ? match[2] : '') : ''];
                    }
                    return matches;
                },

                // 路由到页面
                success: function (res) {
                    if (!res || res.code) {
                        return $('#app').html(render.info('Error', 'Message: ' + res.msg));
                    }
                    // cache data
                    render.cache[render.lang] = {
                        expires: new Date().getTime(),
                        datas: res.data
                    };
                    render.dispatch(res.data);
                },

                // dispatch datas
                dispatch: function(data) {
                    render.site_url = document.domain.match(/localhost|127.0.0.1/i) ? '.' : (data.setting.site ? data.setting.site : data.site_url);
                    render.cdn_url = document.domain.match(/localhost|127.0.0.1/i) ? '.' : (data.setting.static ? data.setting.static : render.site_url);
                    $('head>title').text(render.title(data));
                    $('head>link[rel*="icon"]').each(function(i, elem) {
                        if (data.setting.webLogo) elem.href = data.setting.webLogo.replace(/^.*?(\/static\/.+)$/, render.cdn_url + '$1');
                    });
                    render.voice = data.voice || '';
                    var route = render.route();
                    var pos = route.indexOf('#');
                    var arr = [];
                    if (render.type && render[render.type]) {
                        arr.push(render.header(data));
                        arr.push(render[render.type](data));
                        arr.push(render.footer(data));
                        $('#app').html(arr.join('\n')).parent().parent().stop().animate({
                            scrollTop: (pos !== -1 ? $(route.substr(pos)).offset().top : 0)
                        }, function() {
                            render.sanitize(data);
                        });
                    } else {
                        $('#app').html(render.err404());
                    }
                },

                // Err404页面
                err404: function () {
                    var arr = [];
                    arr.push('<div class="container" style="max-width:480px;margin:25px auto;">\n');
                    arr.push('\t<div class="row">\n');
                    arr.push('\t\t<div class="col-md-12">\n');
                    arr.push('\t\t\t<h1>404 Not found <span>:(</span></h1>\n');
                    arr.push('\t\t\t<p>Sorry, but the page you were trying to view does not exist.</p>\n');
                    arr.push('\t\t\t<p>It looks like this was the result of either:</p>\n');
                    arr.push('\t\t\t<ul>\n');
                    arr.push('\t\t\t\t<li>a mistyped address</li>\n');
                    arr.push('\t\t\t\t<li>an out-of-date link</li>\n');
                    arr.push('\t\t\t</ul>\n');
                    arr.push('\t\t\t<p>\n');
                    arr.push('\t\t\t\t<a href="javascript:history.go(-1);" title="Previous page">Previous page</a> &nbsp;\n');
                    arr.push('\t\t\t\t<a href="#' + render.route(render.lang, 'index', 'i', 1, '', '') + '" title="Back to home">Back to home</a>\n');
                    arr.push('\t\t\t</p>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 公共头部
                header: function (data) {
                    var arr = [];
                    arr.push('<nav class="navbar navbar-default navbar-static-top">\n');
                    arr.push('\t<div class="container">\n');
                    if (render.type != 'detail' && render.type != 'page') arr.push('\t\t<h1 class="hidden">' + data.setting.webName + '</h1>\n');
                    arr.push('\t\t<div class="navbar-header">\n');
                    arr.push('\t\t\t<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">\n');
                    arr.push('\t\t\t\t<span class="sr-only">Toggle navigation</span>\n');
                    arr.push('\t\t\t\t<span class="icon-bar"></span>\n');
                    arr.push('\t\t\t\t<span class="icon-bar"></span>\n');
                    arr.push('\t\t\t\t<span class="icon-bar"></span>\n');
                    arr.push('\t\t\t\n');
                    arr.push('\t\t\t</button>\n');
                    arr.push('\t\t\t<a class="navbar-brand" style="padding:8px 8px 8px 15px;" href="#' + render.route(render.lang, 'index', 'i', 1, '', '') + '" title="' + data.setting.webName + '">' + (data.setting.webLogo ? '<img src="' + data.setting.webLogo.replace(/^.*?(\/static\/.+)$/, render.cdn_url + '$1') + '" style="width:32px;height:auto;" alt="' + data.setting.webName + '" title="' + data.setting.webName + '" />' : data.setting.webName) + '</a>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t\t<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">\n');
                    arr.push('\t\t\t<ul class="nav navbar-nav">\n');
                    arr.push('\t\t\t\t<li' + (render.type == 'index' && render.slug == 'i' ? ' class="active"' : '') + '><a href="#' + render.route(render.lang, 'index', 'i', 1, '', '') + '" title="' + (data.localize && data.localize.home ? data.localize.home : '首页') + '">' + (data.localize && data.localize.home ? data.localize.home : '首页') + '<span class="sr-only">(current)</span></a></li>\n');
                    // 分类导航
                    render.levels(data.categories, 0, 0).forEach(function (item) {
                        if (item.children.length) {
                            arr.push('\t\t\t\t<li class="dropdown">\n');
                            arr.push('\t\t\t\t\t<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">' + item.name + ' <span class="caret"></span></a>\n');
                            arr.push('\t\t\t\t\t<ul class="dropdown-menu">\n');
                            item.children.forEach(function (children) {
                                arr.push('\t\t\t\t\t\t<li' + (render.type == 'category' && children.slug == render.slug ? ' class="active"' : '') + '><a href="#' + render.route(render.lang, 'category', children.slug, 1, '', '') + '" title="' + children.name + '">' + children.name + '</a></li>\n');
                                if (children.children.length) {
                                    arr.push('\t\t\t\t\t\t<li role="separator" class="divider"></li>\n');
                                    children.children.forEach(function (child) {
                                        arr.push('\t\t\t\t\t\t<li' + (render.type == 'category' && child.slug == render.slug ? ' class="active"' : '') + '><a href="#' + render.route(render.lang, 'category', child.slug, 1, '', '') + '" title="' + child.name + '">' + child.name + '</a></li>\n');
                                    });
                                }
                            });
                            arr.push('\t\t\t\t\t</ul>\n');
                            arr.push('\t\t\t\t</li>\n');
                        } else {
                            arr.push('\t\t\t\t<li' + (render.type == 'category' && item.slug == render.slug ? ' class="active"' : '') + '><a href="#' + render.route(render.lang, 'category', item.slug, 1, '', '') + '" title="' + item.name + '">' + item.name + '</a></li>\n');
                        }
                    });
                    // 页面导航
                    render.levels(data.pages.filter(function(el, i) {
                        return el.is_nav == 0;
                    }), 0, 0).forEach(function (item) {
                        if (item.children.length) {
                            arr.push('\t\t\t\t<li class="dropdown">\n');
                            arr.push('\t\t\t\t\t<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">' + item.title + ' <span class="caret"></span></a>\n');
                            arr.push('\t\t\t\t\t<ul class="dropdown-menu">\n');
                            item.children.forEach(function (children) {
                                arr.push('\t\t\t\t\t\t<li' + (render.type == 'page' && children.slug == render.slug ? ' class="active"' : '') + '><a href="#' + render.route(render.lang, 'page', children.slug, 1, '', '') + '" title="' + children.title + '">' + children.title + '</a></li>\n');
                                if (children.children.length) {
                                    arr.push('\t\t\t\t\t\t<li role="separator" class="divider"></li>\n');
                                    children.children.forEach(function (child) {
                                        arr.push('\t\t\t\t\t\t<li' + (render.type == 'page' && child.slug == render.slug ? ' class="active"' : '') + '><a href="#' + render.route(render.lang, 'page', child.slug, 1, '', '') + '" title="' + child.title + '">' + child.title + '</a></li>\n');
                                    });
                                }
                            });
                            arr.push('\t\t\t\t\t</ul>\n');
                            arr.push('\t\t\t\t</li>\n');
                        } else {
                            arr.push('\t\t\t\t<li' + (render.type == 'page' && item.slug == render.slug ? ' class="active"' : '') + '><a href="#' + render.route(render.lang, 'page', item.slug, 1, '', '') + '" title="' + item.title + '">' + item.title + '</a></li>\n');
                        }
                    });
                    // 多语切换
                    if (data.langs && data.langs.length) {
                        arr.push('\t\t\t\t<li class="dropdown">\n');
                        arr.push('\t\t\t\t\t<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">' + (data.localize && data.localize.language ? data.localize.language : '语言') + ' <span class="caret"></span></a>\n');
                        arr.push('\t\t\t\t\t<ul class="dropdown-menu dropdown-language" style="max-height:450px;overflow-y:scroll;">\n');
                        data.langs.forEach(function (_lang) {
                            arr.push('\t\t\t\t\t\t<li' + (_lang.slug == render.lang ? ' class="active"' : '') + '><a href="javascript:;" class="multiLang" data-lang="' + _lang.slug + '" title="' + _lang.name + ' (' + _lang.title + ') ">' + _lang.name + ' (' + _lang.title + ') </a></li>\n');
                        });
                        arr.push('\t\t\t\t\t</ul>\n');
                        arr.push('\t\t\t\t</li>\n');
                    }
                    arr.push('\t\t\t</ul>\n');
                    // 顶部搜索
                    arr.push('\t\t\t<div class="navbar-form navbar-right">\n');
                    arr.push('\t\t\t\t<form class="form-group search-form">\n');
                    arr.push('\t\t\t\t\t<div class="input-group">\n');
                    arr.push('\t\t\t\t\t\t<input type="text" class="form-control" placeholder="' + (data.localize && data.localize.search ? data.localize.search : '搜索') + '..." name="q" value="' + render.q + '" required="required" />\n');
                    arr.push('\t\t\t\t\t\t<span class="input-group-btn">\n');
                    arr.push('\t\t\t\t\t\t\t<button type="submit" class="btn btn-default"><span class="glyphicon glyphicon-search"></span></button>\n');
                    arr.push('\t\t\t\t\t\t</span>\n');
                    arr.push('\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t</form>\n');
                    arr.push('\t\t\t</div>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t</div>\n');
                    arr.push('</nav>\n');
                    // 面包屑导航
                    arr.push('<div class="container">\n');
                    arr.push('\t<div class="row">\n');
                    arr.push('\t\t<div class="col-md-12">\n');
                    arr.push('\t\t\t<ol class="breadcrumb">\n');
                    render.crumbs(data).forEach(function (item, i) {
                        if (item.link == undefined) {
                            arr.push('\t\t\t\t<li class="active">' + item.name + '</li>\n');
                        } else {
                            arr.push('\t\t\t\t<li><a href="#' + item.link + '" title="' + item.name + '">' + item.name + '</a></li>\n');
                        }
                    });
                    arr.push('\t\t\t</ol>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 侧边栏
                sidebar: function (data) {
                    var arr = [];
                    var articles = [];
                    arr.push('<div class="col-md-4">\n');
                    // 语言切换
                    if (data.langs && data.langs.length) {
                        arr.push('\t<div class="panel panel-default">\n');
                        arr.push('\t\t<div class="panel-heading">\n');
                        arr.push('\t\t\t<h3 class="panel-title">' + (data.localize && data.localize.language ? data.localize.language : '语言') + '</h3>\n');
                        arr.push('\t\t</div>\n');
                        arr.push('\t\t<div class="panel-body">\n');
                        arr.push('\t\t\t<div class="form-inline" style="margin-bottom:15px;">\n');
                        arr.push('\t\t\t\t<div class="form-group select-language">\n');
                        arr.push('\t\t\t\t\t<a href="javascript:;" class="multiLang" data-lang="en"' + (render.lang == 'en' ? ' style="text-decoration:underline"' : '') + '>English</a> | <a href="javascript:;" class="multiLang ignore" data-lang="zh-CN"' + (render.lang == 'zh-CN' ? ' style="text-decoration:underline"' : '') + '>简体中文</a> | <a href="javascript:;" class="multiLang" data-lang="zh-TW"' + (render.lang == 'zh-TW' ? ' style="text-decoration:underline"' : '') + '>繁體中文</a>\n');
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t\t<div class="form-horizontal" style="padding:0 15px;">\n');
                        arr.push('\t\t\t\t<div class="form-group">\n');
                        arr.push('\t\t\t\t\t<label for="selectLanguage">' + (data.localize && data.localize.choose_language ? data.localize.choose_language : '选择语言') + ':</label>\n');
                        arr.push('\t\t\t\t\t<select id="selectLanguage" class="selectLanguage form-control" size="0" onmousedown="if(this.options.length>11){this.size=12}" onblur="this.size=0" onchange="this.size=0">\n');
                        data.langs.forEach(function (_lang) {
                            arr.push('\t\t\t\t\t\t<option value="' + _lang.slug + '"' + (_lang.slug == render.lang ? ' selected' : '') + '>' + _lang.name + ' (' + _lang.title + ') </option>\n');
                        });
                        arr.push('\t\t\t\t\t</select>\n');
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                        arr.push('\t</div>\n');
                    }
                    // 分类目录
                    arr.push('\t<div class="panel panel-default">\n');
                    arr.push('\t\t<div class="panel-heading">\n');
                    arr.push('\t\t\t<h3 class="panel-title">' + (data.localize && data.localize.category_title ? data.localize.category_title : '分类目录') + '</h3>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t\t<div class="panel-body">\n');
                    arr.push('\t\t\t<div class="list-group">\n');
                    if (data.categories.length) {
                        data.categories.forEach(function (item) {
                            if (parseInt(item.num)) {
                                arr.push('\t\t\t\t<a href="#' + render.route(render.lang, 'category', item.slug, 1, '', '') + '" title="' + item.name + '" class="list-group-item' + (render.type == 'category' && item.slug == render.slug ? ' active' : '') + '"><span class="badge">' + item.num + '</span>' + item.name + '</a>\n');
                            }
                        });
                    } else {
                        arr.push('\t\t\t<p class="text-muted">' + (data.localize && data.localize.no_categories ? data.localize.no_categories : '还没有分类') + '</p>\n');
                    }
                    arr.push('\t\t\t</div>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t</div>\n');
                    // 页面
                    if (data.pages.length) {
                        arr.push('\t<div class="panel panel-default panel-pages">\n');
                        arr.push('\t\t<div class="panel-heading">\n');
                        arr.push('\t\t\t<h3 class="panel-title">' + (data.localize && data.localize.page_title ? data.localize.page_title : '页面') + '</h3>\n');
                        arr.push('\t\t</div>\n');
                        arr.push('\t\t<div class="panel-body">\n');
                        arr.push('\t\t\t<div class="list-group">\n');
                        data.pages.forEach(function (item) {
                            if (parseInt(item.pid)) {
                                arr.push('\t\t\t\t<a href="#' + render.route(render.lang, 'page', item.slug, 1, '', '') + '" data-slug="' + item.slug + '" data-id="' + item.id + '" title="' + item.title + '" class="list-group-item' + (render.type == 'page' && item.slug == render.slug ? ' active' : '') + '"><span class="badge"></span>' + item.title + '</a>\n');
                            }
                        });
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                        arr.push('\t</div>\n');
                    }
                    // 标签
                    arr.push('\t<div class="panel panel-default">\n');
                    arr.push('\t\t<div class="panel-heading">\n');
                    arr.push('\t\t\t<h3 class="panel-title">' + (data.localize && data.localize.tag_title ? data.localize.tag_title : '标签') + '</h3>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t\t<div class="panel-body">\n');
                    if (data.tags.length) {
                        data.tags.forEach(function (item, i) {
                            arr.push('\t\t\t<a class="label label-' + (i % 6 == 0 ? 'primary' : (i % 6 == 1 ? 'success' : (i % 6 == 2 ? 'info' : (i % 6 == 3 ? 'warning' : (i % 6 == 4 ? 'danger' : (i % 6 == 5 ? 'default' : 'primary')))))) + '" href="#' + render.route(render.lang, 'tag', item.slug, 1, '', '') + '" title="' + item.name + ' (' + item.num + ' ' + (data.localize && data.localize.articles ? data.localize.articles : '篇文章') + ')" rel="nofollow">' + item.name + '(' + item.num + ')</a>\n');
                        });
                    } else {
                        arr.push('\t\t\t<p class="text-muted">' + (data.localize && data.localize.no_tags ? data.localize.no_tags : '还没有标签') + '</p>\n');
                    }
                    arr.push('\t\t</div>\n');
                    arr.push('\t</div>\n');
                    // 热门文章
                    articles = data.articles.filter(function(item, i) {
                        return item.likes > 0;
                    }).sort(function(a, b) {
                        return b.likes - a.likes;
                    }).slice(0, data.setting.hot_num);
                    arr.push('\t<div class="panel panel-default">\n');
                    arr.push('\t\t<div class="panel-heading">\n');
                    arr.push('\t\t\t<h3 class="panel-title">' + (data.localize && data.localize.hot_title ? data.localize.hot_title : '热门文章') + '</h3>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t\t<div class="panel-body">\n');
                    arr.push('\t\t\t<div class="list-group">\n');
                    if (articles.length) {
                        articles.forEach(function (item) {
                            arr.push('\t\t\t\t<a href="#' + render.route(render.lang, 'detail', item.slug, 1, '', '') + '"' + (render.type == 'detail' && item.slug == render.slugd ? ' rel="nofollow"' : '') + ' title="' + item.title.replace(/<[^>]*>/g, ' ') + '" class="list-group-item' + (render.type == 'detail' && item.slug == render.slug ? ' active' : '') + '"><span class="badge">' + item.likes + '</span><span class="glyphicon glyphicon-fire' + (render.type != 'detail' && item.slug != render.slug ? ' text-muted' : '') + '" aria-hidden="true"></span> ' + item.title + '</a>\n');
                        });
                    } else {
                        arr.push('\t\t\t\t<p class="text-muted">' + (data.localize && data.localize.no_hots ? data.localize.no_hots : '还没有热门') + '</p>\n')
                    }
                    arr.push('\t\t\t</div>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t</div>\n');
                    // 本类更新
                    if (render.type == 'detail' || render.type == 'category') {
                        var obj = data[render.type == 'detail' ? 'articles' : 'categories'].filter(function(elem, i) {
                                return elem.slug == render.slug;
                            })[0];
                        var cat_id = obj ? obj[render.type == 'detail' ? 'category_id' : 'id'] : 0;
                        arr.push('\t<div class="panel panel-default" id="panel-affix">\n');
                        arr.push('\t\t<div class="panel-heading">\n');
                        obj = data.categories.filter(function(item, i) {
                            return item.id == cat_id;
                        })[0];
                        arr.push('\t\t\t<h3 class="panel-title">' + (obj ? obj.name : (data.localize && data.localize.uncategoried ? data.localize.uncategoried : '未分类')) + '</h3>\n');
                        arr.push('\t\t</div>\n');
                        arr.push('\t\t<div class="panel-body">\n');
                        // 搜索框
                        arr.push('\t\t\t<div class="row">\n');
                        arr.push('\t\t\t\t<div class="col-md-12">\n');
                        arr.push('\t\t\t\t\t<form class="form-group search-form">\n');
                        arr.push('\t\t\t\t\t\t<div class="input-group">\n');
                        arr.push('\t\t\t\t\t\t\t<input type="text" class="form-control" name="q" value="' + render.q + '" placeholder="Search for..." required="required" />\n');
                        arr.push('\t\t\t\t\t\t\t<span class="input-group-btn">\n');
                        arr.push('\t\t\t\t\t\t\t\t<button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>\n');
                        arr.push('\t\t\t\t\t\t\t</span>\n');
                        arr.push('\t\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t</form>\n');
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t\t<div class="row">\n');
                        arr.push('\t\t\t\t<div class="col-md-12">\n');
                        arr.push('\t\t\t\t\t<div class="list-group">\n');
                        var cat_ids = render.trees(data.categories, cat_id || -1, 0).map(function(item, i) {
                            return item.id;
                        });
                        cat_ids.unshift(cat_id);
                        articles = data.articles.filter(function(item, i) {
                            return cat_ids.indexOf(item.category_id) !== -1;
                        });
                        if (articles.length) {
                            articles.forEach(function (item, i) {
                                arr.push('\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'detail', item.slug, 1, '', '') + '"' + (render.type == 'detail' && item.slug == render.slug ? ' rel="nofollow"' : '') + ' title="' + item.title.replace(/<[^>]*>/g, ' ') + '" class="list-group-item' + (render.type == 'detail' && item.slug == render.slug ? ' active' : '') + (i > 9 ? ' hidden' : '') + '">' + ((item.likes > 0 && item.update_at > Math.floor(Date.now() / 1000) - 24 * 3600 * 30) || item.likes > 99 ? '<span class="badge">Hot</span>' : '') + '<span class="glyphicon glyphicon-list-alt' + (render.type != 'detail' && item.slug != render.slug ? ' text-muted' : '') + '" aria-hidden="true"></span> ' + item.title + '</a>\n');
                                if (i == articles.length - 1 && i > 9) {
                                    arr.push('\t\t\t\t\t\t<nav aria-label="Page navigation">\n');
                                    arr.push('\t\t\t\t\t\t\t<ul class="pager pager-list" data-index="0">\n');
                                    arr.push('\t\t\t\t\t\t\t\t<li class="disabled" data-type="prev"><a href="javascript:;" title="Previous">Previous</a></li>\n');
                                    arr.push('\t\t\t\t\t\t\t\t<li data-type="next"><a href="javascript:;" title="Next">Next</a></li>\n');
                                    arr.push('\t\t\t\t\t\t\t\t<li data-type="all"><a href="javascript:;" title="All">All</a></li>\n');
                                    arr.push('\t\t\t\t\t\t\t</ul>\n');
                                    arr.push('\t\t\t\t\t\t</nav>\n');
                                }
                            });
                        } else {
                            arr.push('\t\t\t\t\t\t<p class="text-muted">' + (data.localize && data.localize.no_articles ? data.localize.no_articles : '还没有文章') + '</p>\n');
                        }
                        arr.push('\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                        arr.push('\t</div>\n');
                    }
                    // 首页评论
                    if (render.type == 'index' && render.slug == 'i') {
                        arr.push('\t<div class="panel panel-default">\n');
                        arr.push('\t\t<div class="panel-heading">\n');
                        arr.push('\t\t\t<h3 class="panel-title">' + (data.localize && data.localize.comment_title ? data.localize.comment_title : '最新评论') + '</h3>\n');
                        arr.push('\t\t</div>\n');
                        arr.push('\t\t<div class="panel-body">\n');
                        var user = render.format(data.users, 'username');
                        var comments = data.comments.filter(function(item, i) {
                            return item.pid == 0;
                        }).slice(0, data.setting.comm_num);
                        if (comments.length) {
                            var obj = render.format(data.articles.filter(function(item, i) {
                                return comments.map(function(elem, i) {
                                    return elem.article_id;
                                }).indexOf(item.id) !== -1;
                            }), 'id');
                            var user = render.format(data.users, 'username');
                            comments.forEach(function (item, i) {
                                arr.push('\t\t\t<div class="media">\n');
                                arr.push('\t\t\t\t<a href="#' + render.route(render.lang, 'detail', obj[item.article_id].slug, render.p, '', '#comment-' + item.id) + '" title="' + item.article_title + '">\n');
                                arr.push('\t\t\t\t\t<div class="media-left">\n');
                                arr.push('\t\t\t\t\t\t<img class="media-object img-circle avatar" style="width: 64px;height: 64px;background-color: #f1f1f1;" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + (user[item.author] && user[item.author].avatar ? user[item.author].avatar.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') : '') + '" alt="' + (user[item.author] && user[item.author].nickname ? user[item.author].nickname : item.author) + '" title="' + (user[item.author] && user[item.author].nickname ? user[item.author].nickname : item.author) + '" />\n');
                                arr.push('\t\t\t\t\t</div>\n');
                                arr.push('\t\t\t\t\t<div class="media-body">\n');
                                arr.push('\t\t\t\t\t\t<h4 class="media-heading"><strong>' + (user[item.author] && user[item.author].nickname ? user[item.author].nickname : item.author) + '</strong> <cite>' + (data.localize && data.localize.say ? data.localize.say : '说道') + ': </cite></h4>\n');
                                arr.push('\t\t\t\t\t\t<span class="text-muted">' + render.cutstr(item.comment.replace(/<[^>]*>/g, ' ').replace(/\s+/, ' '), 70) + '</span>\n');
                                arr.push('\t\t\t\t\t</div>\n');
                                arr.push('\t\t\t\t</a>\n');
                                arr.push('\t\t\t</div>\n');
                                if (i != comments.length - 1) {
                                    arr.push('\t\t\t<hr>\n');
                                }
                            });
                        } else {
                            arr.push('\t\t\t<p class="text-muted">' + (data.localize && data.localize.no_comments ? data.localize.no_comments : '还没有评论') + '</p>\n');
                        }
                        arr.push('\t\t</div>\n');
                        arr.push('\t</div>\n');
                    }
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 列表项目
                list: function (data, articles) {
                    var arr = [];
                    arr.push('<div class="panel panel-default">\n');
                    if (render.type != 'category' && render.type != 'detail') {
                        arr.push('\t<div class="panel-heading">' + render.name(data) + '</div>\n');
                    }
                    arr.push('\t<div class="panel-body">\n');
                    if (articles.length) {
                        arr.push(render.list_item(articles.slice((render.p - 1) * render.limit, render.p * render.limit)));
                    } else {
                        arr.push('\t\t<div class="row">\n');
                        arr.push('\t\t\t<div class="col-md-12">\n');
                        arr.push('\t\t\t\t<p class="text-center text-muted">' + (data.localize && data.localize.no_articles ? data.localize.no_articles : '还没有文章') + '</p>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                    }
                    // 分页
                    if (articles.length) {
                        arr.push(render.pager(articles.length, render.limit));
                    }
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 相册项目
                grid: function (data, articles) {
                    var arr = [];
                    arr.push('<div class="panel panel-default">\n');
                    arr.push('\t<div class="panel-heading">' + render.name(data) + '</div>\n');
                    arr.push('\t<div class="panel-body">\n');
                    articles.slice((render.p - 1) * parseInt(data.setting.page_num), render.p * parseInt(data.setting.page_num)).forEach(function (item) {
                        arr.push('\t\t<div class="col-sm-6 col-md-4">\n');
                        arr.push('\t\t\t<a class="thumbnail" href="#' + render.route(render.lang, 'detail', item.slug, 1, '', '') + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '">\n');
                        arr.push('\t\t\t\t<img style="width:100%;height:100px;background-color:#f1f1f1;" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + (item.cover ? item.cover : '') + '" alt="' + item.title + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '" />\n');
                        arr.push('\t\t\t\t<div class="caption">\n');
                        arr.push('\t\t\t\t\t<h2 style="margin:0;font-size:14.7px;">' + item.title + '</h2>\n');
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t</a>\n');
                        arr.push('\t\t</div>\n');
                    });
                    // 分页
                    arr.push(render.pager(articles.length, parseInt(data.setting.page_num)));
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 列表项目
                list_item: function(list) {
                    var arr = [];
                    list.forEach(function (item) {
                        arr.push('\t\t<div class="row">\n');
                        arr.push('\t\t\t<div class="col-md-12">\n');
                        arr.push('\t\t\t\t<div class="panel panel-default">\n');
                        arr.push('\t\t\t\t\t<div class="panel-body">\n');
                        arr.push('\t\t\t\t\t\t<div class="row">\n');
                        var match = item.content.match(/<img[^>]*src=["']([^"']*)["'][^>]*>/i);
                        item.cover = (item.cover || (match ? match[1] : '')).replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1');
                        if (item.cover) {
                            arr.push('\t\t\t\t\t\t\t<div class="col-sm-3 col-md-3">\n');
                            arr.push('\t\t\t\t\t\t\t\t<a class="thumbnail" href="#' + render.route(render.lang, 'detail', item.slug, 1, '', '') + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '"><img style="width:100%;max-height:100px;background-color:#f1f1f1;" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + item.cover + '" alt="' + item.title.replace(/<[^>]*>/g, ' ') + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '" /></a>\n');
                            arr.push('\t\t\t\t\t\t\t</div>\n');
                        }
                        arr.push('\t\t\t\t\t\t\t<div class="' + (item.cover ? 'col-sm-9 col-md-9' : 'col-sm-12 col-md-12') + '">\n');
                        arr.push('\t\t\t\t\t\t\t\t<h2 style="margin-top: 0;">\n');
                        arr.push('\t\t\t\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'detail', item.slug, 1, '', '') + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '">' + item.title + '</a>\n');
                        if (item.update_at > Math.floor(Date.now() / 1000) - 24 * 3600 * 3) {
                            arr.push('\t\t\t\t\t\t\t\t\t<span class="label label-success">New</span>\n');
                        }
                        if ((item.likes > 0 && item.update_at > Math.floor(Date.now() / 1000) - 24 * 3600 * 30) || item.likes > 99) {
                            arr.push('\t\t\t\t\t\t\t\t\t<span class="label label-danger">Hot</span>\n');
                        }
                        arr.push('\t\t\t\t\t\t\t\t</h2>\n');
                        arr.push('\t\t\t\t\t\t\t\t<p>' + (item.description ? item.description : render.cutstr(item.content.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' '), 140)) + '</p>\n');
                        arr.push('\t\t\t\t\t\t\t\t<p>\n');
                        arr.push('\t\t\t\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'detail', item.slug, 1, '', '') + '" title="Read more" rel="nofollow" class="btn btn-primary pull-right" role="button"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Read more</a>\n');
                        arr.push('\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-time text-muted" aria-hidden="true"></span>\n');
                        var t = new Date(item.create_at * 1000);
                        var y = '' + t.getFullYear();
                        var m = ('0' + (t.getMonth() + 1)).slice(-2);
                        var d = ('0' + t.getDate()).slice(-2);
                        arr.push('\t\t\t\t\t\t\t\t\t<span class="text-muted">' + (m + '/' + d + '/' + y.slice(-2)) + '</span> &nbsp;\n');
                        arr.push('\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-eye-open text-muted" aria-hidden="true"></span>\n');
                        arr.push('\t\t\t\t\t\t\t\t\t<span class="text-muted">' + item.views + '</span>\n');
                        arr.push('\t\t\t\t\t\t\t\t</p>\n');
                        arr.push('\t\t\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                    });
                    return arr.join('');
                },

                // 页面列表
                list_page: function (pages) {
                    var arr = [];
                    arr.push('<div class="panel panel-default">\n');
                    arr.push('\t<div class="panel-body">\n');
                    if (pages.length) {
                        pages.forEach(function (item) {
                            arr.push('\t\t<div class="row">\n');
                            arr.push('\t\t\t<div class="col-md-12">\n');
                            arr.push('\t\t\t\t<div class="panel panel-default">\n');
                            arr.push('\t\t\t\t\t<div class="panel-body">\n');
                            arr.push('\t\t\t\t\t\t<div class="row">\n');
                            var match = item.content.match(/<img[^>]*src=["']([^"']*)["'][^>]*>/i);
                            item.cover = (item.cover || (match ? match[1] : '')).replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1');
                            if (item.cover) {
                                arr.push('\t\t\t\t\t\t\t<div class="col-sm-3 col-md-3">\n');
                                arr.push('\t\t\t\t\t\t\t\t<a class="thumbnail" href="#' + render.route(render.lang, 'page', item.slug, 1, '', '') + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '"><img style="width:100%;max-height:100px;background-color:#f1f1f1;" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + item.cover + '" alt="' + item.title + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '" /></a>\n');
                                arr.push('\t\t\t\t\t\t\t</div>\n');
                            }
                            arr.push('\t\t\t\t\t\t\t<div class="' + (item.cover ? 'col-sm-9 col-md-9' : 'col-sm-12 col-md-12') + '">\n');
                            arr.push('\t\t\t\t\t\t\t\t<h2 style="margin-top: 0;">\n');
                            arr.push('\t\t\t\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'page', item.slug, 1, '', '') + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '">' + item.title + '</a>\n');
                            if (item.time > Math.floor(Date.now() / 1000) - 24 * 3600 * 3) {
                                arr.push('\t\t\t\t\t\t\t\t\t\t<span class="label label-success">New</span>\n');
                            }
                            arr.push('\t\t\t\t\t\t\t\t</h2>\n');
                            arr.push('\t\t\t\t\t\t\t\t<p>' + render.cutstr(item.content.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' '), 140) + '</p>\n');
                            arr.push('\t\t\t\t\t\t\t\t<p>\n');
                            arr.push('\t\t\t\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'page', item.slug, 1, '', '') + '" title="Read more" rel="nofollow" class="btn btn-primary pull-right" role="button"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Read more</a>\n');
                            arr.push('\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-time text-muted" aria-hidden="true"></span>\n');
                            var t = new Date(item.time * 1000);
                            var y = '' + t.getFullYear();
                            var m = ('0' + (t.getMonth() + 1)).slice(-2);
                            var d = ('0' + t.getDate()).slice(-2);
                            arr.push('\t\t\t\t\t\t\t\t\t<span class="text-muted">' + (m + '/' + d + '/' + y.slice(-2)) + '</span>\n');
                            arr.push('\t\t\t\t\t\t\t\t</p>\n');
                            arr.push('\t\t\t\t\t\t\t</div>\n');
                            arr.push('\t\t\t\t\t\t</div>\n');
                            arr.push('\t\t\t\t\t</div>\n');
                            arr.push('\t\t\t\t</div>\n');
                            arr.push('\t\t\t</div>\n');
                            arr.push('\t\t</div>\n');
                        });
                    } else {
                        arr.push('\t\t<div class="row">\n');
                        arr.push('\t\t\t<div class="col-md-12">\n');
                        arr.push('\t\t\t\t<p class="text-center text-muted">' + (data.localize && data.localize.no_pages ? data.localize.no_pages : '还没有页面') + '</p>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                    }
                    // 分页
                    if (pages.length) {
                        arr.push(render.pager(pages.length, render.limit));
                    }
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 公共底部
                footer: function (data) {
                    var arr = [];
                    arr.push('<div class="container">\n');
                    arr.push('\t<div class="row">\n');
                    arr.push('\t\t<div class="col-md-12">\n');
                    if (render.type == 'index' && render.slug == 'i') {
                        arr.push('\t\t\t<div class="panel panel-default">\n');
                        arr.push('\t\t\t\t<div class="panel-body">\n');
                        arr.push('\t\t\t\t\t<span class="text-muted">' + (data.localize && data.localize.friend_link ? data.localize.friend_link : '友情链接') + ':</span>\n');
                        arr.push('\t\t\t\t\t<a href="' + render.site_url + render.route(render.lang, 'index', 'i', 1, '', '') + '" title="' + data.setting.webName + '">' + data.setting.webName + '</a>\n');
                        data.links.forEach(function (item) {
                            arr.push('\t\t\t\t\t<span class="text-muted">-</span> <a href="' + item.url + '" title="' + item.name + '">' + item.name + '</a>\n');
                        });
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t</div>\n');
                    }
                    arr.push('\t\t\t<p class="text-center">\n');
                    arr.push('\t\t\t\t<a class="login" href="javascript:;" rel="nofollow" title="' + (data.localize && data.localize.login ? data.localize.login : '登录') + '">' + (data.localize && data.localize.login ? data.localize.login : '登录') + '</a> &nbsp;|&nbsp;\n');
                    arr.push('\t\t\t\t<a class="register" href="javascript:;" rel="nofollow" title="' + (data.localize && data.localize.register ? data.localize.register : '注册') + '">' + (data.localize && data.localize.register ? data.localize.register : '注册') + '</a> &nbsp;|&nbsp;\n');
                    arr.push('\t\t\t\t<a href="javascript:;" class="logout" rel="nofollow" title="' + (data.localize && data.localize.logout ? data.localize.logout : '登出') + '">' + (data.localize && data.localize.logout ? data.localize.logout : '登出') + '</a> &nbsp;|&nbsp;\n');
                    arr.push('\t\t\t\t<a href="javascript:;" class="client" rel="nofollow" title="' + (data.localize && data.localize.client ? data.localize.client : '客户端') + '">' + (data.localize && data.localize.client ? data.localize.client : '客户端') + '</a> &nbsp;|&nbsp;\n');
                    arr.push('\t\t\t\t<a href="javascript:;" class="console" rel="nofollow" title="' + (data.localize && data.localize.console ? data.localize.console : '控制台') + '">' + (data.localize && data.localize.console ? data.localize.console : '控制台') + '</a>\n');
                    arr.push('\t\t\t</p>\n');
                    arr.push('\t\t\t<p class="text-center">' + data.setting.copyright + '</p>\n');
                    arr.push('\t\t\t<p class="text-center">\n');
                    arr.push('\t\t\t\t<a href="https://beian.miit.gov.cn/" rel="nofollow" title="ICP">' + data.setting.icp + '</a>\n');
                    arr.push('\t\t\t</p>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    // 回顶与播放\n');
                    arr.push('<div class="fixed-bottom">\n');
                    arr.push('\t<div class="play-btn' + (data.setting.voice_read == '0' || render.type !== 'detail' ? ' hidden' : '') + '" title="' + (data.localize && data.localize.audio_play ? data.localize.audio_play : '语音播放') + '"><span class="glyphicon glyphicon-play" aria-hidden="true"></span></div>\n');
                    arr.push('\t<div class="back-top" style="margin-top:3px" title="' + (data.localize && data.localize.back_top ? data.localize.back_top : '回到顶部') + '"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span></div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // name
                name: function(data) {
                    var name = '';
                    // index
                    if (render.type == 'index') {
                        name = data.localize && data.localize.newest ? data.localize.newest : '最新文章';
                    }
                    // category
                    if (render.type == 'category') {
                        var items = data.categories.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) name = items[0].name;
                    }
                    // tag
                    if (render.type == 'tag') {
                        var items = data.tags.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) name = items[0].name;
                    }
                    // search
                    if (render.type == 'search' && render.slug == 'i') {
                        name = data.localize && data.localize.search_result ? data.localize.search_result : '搜索结果';
                    }
                    // detail
                    if (render.type == 'detail') {
                        var items = data.articles.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) {
                            items = data.categories.filter(function(item, i) {
                                return item.id == items[0].category_id;
                            });
                        }
                        if (items.length) name = items[0].name;
                    }
                     // page
                    if (render.type == 'page') {
                        var items = data.pages.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) name = items[0].title;
                    }
                    // page 404
                    if (name == '') name = data.localize && data.localize.page_not_found ? data.localize.page_not_found : '页面未找到';
                    return name.replace(/<[^>]*>/g, ' ');
                },

                // title
                title: function(data) {
                    var parent = [];
                    // category
                    if (render.type == 'category') {
                        var items = data.categories.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) parent = render.parents(data.categories, items[0].id);
                    }
                    // tag
                    if (render.type == 'tag') {
                        var items = data.tags.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) parent.push(items[0]);
                    }
                    // search
                    if (render.type == 'search' && render.slug == 'i') {
                        parent.unshift({ name: data.localize && data.localize.search_result ? data.localize.search_result : '搜索结果' });
                    }
                    // detail
                    if (render.type == 'detail') {
                        var items = data.articles.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) parent.unshift(items[0]);
                    } 
                    // page
                    if (render.type == 'page') {
                        var items = data.pages.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) parent = render.parents(data.pages, items[0].id);
                    }
                    // page 404
                    if (render.type !== 'index' && render.slug !== 'i' && parent.length == 0) {
                        parent.unshift({ name: (data.localize && data.localize.page_not_found ? data.localize.page_not_found : '页面未找到') });
                    }
                    // Home page
                    parent.push({ name: data.setting.webName });
                    parent = parent.map(function(item, i) {
                        return (item.name || item.title).replace(/<[^>]*>/g, ' ');
                    });
                    return parent.join(' - ');
                },

                // crumbs
                crumbs: function(data) {
                    var parent = [];
                    // index
                    if (render.type == 'index' && render.slug == 'i') {
                        parent.unshift({ name: data.setting.webName });
                    }
                    // category
                    if (render.type == 'category') {
                        var items = data.categories.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) {
                            parent = render.parents(data.categories, items[0].id);
                            parent.shift();
                            parent.unshift({ name: items[0].name });
                        }
                    }
                    // tag
                    if (render.type == 'tag') {
                        var items = data.tags.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) {
                            parent.push(items[0]);
                            parent.shift();
                            parent.unshift({ name: items[0].name });
                        }
                    }
                    // search
                    if (render.type == 'search' && render.slug == 'i') {
                        parent.unshift({ name: data.localize && data.localize.search_result ? data.localize.search_result : '搜索结果' });
                    }
                    // detail
                    if (render.type == 'detail') {
                        var items = data.articles.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) {
                            parent = render.parents(data.categories, items[0].category_id);
                            parent.unshift({ name: items[0].title });
                        }
                    }
                    // page
                    if (render.type == 'page') {
                        var items = data.pages.filter(function(item, i) {
                            return item.slug == render.slug;
                        });
                        if (items.length) {
                            parent = render.parents(data.pages, items[0].id);
                            parent.shift();
                            parent.unshift({ name: items[0].title });
                        }
                    }
                    // add link
                    parent.forEach(function(item, i) {
                        if (item.slug) item.link = render.route(render.lang, render.type == 'detail' ? 'category' : render.type, item.slug, 1, '', '');
                        if (item.title) item.name = (item.name || item.title).replace(/<[^>]*>/g, ' ');
                    });
                    // page 404
                    if (render.type !== 'index' && render.slug !== 'i' && parent.length == 0) {
                        parent.unshift({ name: (data.localize && data.localize.page_not_found ? data.localize.page_not_found : '页面未找到') });
                    }
                    // breadcrumbs
                    var crumbs = [];
                    parent.push({ name: data.localize && data.localize.home ? data.localize.home : 'Home', link: render.route(render.lang, 'index', 'i', 1, '', '') });
                    return parent.reverse();
                },

                // 首页
                index: function (data) {
                    var arr = [];
                    arr.push('<div class="container">\n');
                    arr.push('\t<div class="row">\n');
                    // 左侧列表
                    arr.push('\t\t<div class="col-md-8">\n');
                    // 轮播图
                    arr.push('\t\t\t<div class="row">\n');
                    arr.push('\t\t\t\t<div class="col-md-12">\n');
                    arr.push('\t\t\t\t\t<div class="panel panel-default">\n');
                    arr.push('\t\t\t\t\t\t<div class="panel-body">\n');
                    arr.push('\t\t\t\t\t\t\t<div id="carousel-example-generic" class="carousel slide" data-ride="carousel">\n');
                    arr.push('\t\t\t\t\t\t\t\t<ol class="carousel-indicators">\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<li data-target="#carousel-example-generic" data-slide-to="1"></li>\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<li data-target="#carousel-example-generic" data-slide-to="2"></li>\n');
                    if (data.setting.slide_image_4) {
                        arr.push('\t\t\t\t\t\t\t\t\t<li data-target="#carousel-example-generic" data-slide-to="3"></li>\n');
                    }
                    if (data.setting.slide_image_5) {
                        arr.push('\t\t\t\t\t\t\t\t\t<li data-target="#carousel-example-generic" data-slide-to="4"></li>\n');
                    }
                    arr.push('\t\t\t\t\t\t\t\t</ol>\n');
                    arr.push('\t\t\t\t\t\t\t\t<div class="carousel-inner" role="listbox">\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<div class="item active">\n');
                    if (data.setting.slide_image_1) {
                        arr.push('\t\t\t\t\t\t\t\t\t\t<a href="#' + data.setting.slide_url_1.replace(/^.*?(\/static\/.+?\.html)$/i, '$1') + '" title="First Slide"><img width="100%" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + data.setting.slide_image_1.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + '" alt="First Slide" /><div class="carousel-caption"></div></a>\n');
                    } else {
                        arr.push('\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" title="First Slide"><img width="100%" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iOTAwIiBoZWlnaHQ9IjUwMCIgdmlld0JveD0iMCAwIDkwMCA1MDAiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiPjwhLS0KU291cmNlIFVSTDogaG9sZGVyLmpzLzkwMHg1MDAvYXV0by8jNzc3OiM1NTUvdGV4dDpGaXJzdCBzbGlkZQpDcmVhdGVkIHdpdGggSG9sZGVyLmpzIDIuNi4wLgpMZWFybiBtb3JlIGF0IGh0dHA6Ly9ob2xkZXJqcy5jb20KKGMpIDIwMTItMjAxNSBJdmFuIE1hbG9waW5za3kgLSBodHRwOi8vaW1za3kuY28KLS0+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48IVtDREFUQVsjaG9sZGVyXzE3ZjNiNmE1ODY5IHRleHQgeyBmaWxsOiM1NTU7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LWZhbWlseTpBcmlhbCwgSGVsdmV0aWNhLCBPcGVuIFNhbnMsIHNhbnMtc2VyaWYsIG1vbm9zcGFjZTtmb250LXNpemU6NDVwdCB9IF1dPjwvc3R5bGU+PC9kZWZzPjxnIGlkPSJob2xkZXJfMTdmM2I2YTU4NjkiPjxyZWN0IHdpZHRoPSI5MDAiIGhlaWdodD0iNTAwIiBmaWxsPSIjNzc3Ii8+PGc+PHRleHQgeD0iMzA4Ljg1NzEzMTk1ODAwNzgiIHk9IjI3MC43NDI4NTgxMjM3NzkzIj5GaXJzdCBzbGlkZTwvdGV4dD48L2c+PC9nPjwvc3ZnPg==" alt="First Slide" /><div class="carousel-caption"></div></a>\n');
                    }
                    arr.push('\t\t\t\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<div class="item">\n');
                    if (data.setting.slide_image_2) {
                        arr.push('\t\t\t\t\t\t\t\t\t\t<a href="#' + data.setting.slide_url_2.replace(/^.*?(\/static\/.+?\.html)$/i, '$1') + '" title="Second Slide"><img width="100%" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + data.setting.slide_image_2.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + '" alt="Second Slide" /><div class="carousel-caption"></div></a>\n');
                    } else {
                        arr.push('\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" title="Second Slide"><img width="100%" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iOTAwIiBoZWlnaHQ9IjUwMCIgdmlld0JveD0iMCAwIDkwMCA1MDAiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiPjwhLS0KU291cmNlIFVSTDogaG9sZGVyLmpzLzkwMHg1MDAvYXV0by8jNjY2OiM0NDQvdGV4dDpTZWNvbmQgc2xpZGUKQ3JlYXRlZCB3aXRoIEhvbGRlci5qcyAyLjYuMC4KTGVhcm4gbW9yZSBhdCBodHRwOi8vaG9sZGVyanMuY29tCihjKSAyMDEyLTIwMTUgSXZhbiBNYWxvcGluc2t5IC0gaHR0cDovL2ltc2t5LmNvCi0tPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PCFbQ0RBVEFbI2hvbGRlcl8xN2YzYjZhMjBiMSB0ZXh0IHsgZmlsbDojNDQ0O2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1mYW1pbHk6QXJpYWwsIEhlbHZldGljYSwgT3BlbiBTYW5zLCBzYW5zLXNlcmlmLCBtb25vc3BhY2U7Zm9udC1zaXplOjQ1cHQgfSBdXT48L3N0eWxlPjwvZGVmcz48ZyBpZD0iaG9sZGVyXzE3ZjNiNmEyMGIxIj48cmVjdCB3aWR0aD0iOTAwIiBoZWlnaHQ9IjUwMCIgZmlsbD0iIzY2NiIvPjxnPjx0ZXh0IHg9IjI2NS43MTQyNzkxNzQ4MDQ3IiB5PSIyNzAuNzQyODU4MTIzNzc5MyI+U2Vjb25kIHNsaWRlPC90ZXh0PjwvZz48L2c+PC9zdmc+" alt="Second Slide" /><div class="carousel-caption"></div></a>\n');
                    }
                    arr.push('\t\t\t\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<div class="item">\n');
                    if (data.setting.slide_image_3) {
                        arr.push('\t\t\t\t\t\t\t\t\t\t<a href="#' + data.setting.slide_url_3.replace(/^.*?(\/static\/.+?\.html)$/i, '$1') + '" title="Third Slide"><img width="100%" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + data.setting.slide_image_3.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + '" alt="Third Slide" /><div class="carousel-caption"></div></a>\n');
                    } else {
                        arr.push('\t\t\t\t\t\t\t\t\t\t<a href="javascript:;" title="Third Slide"><img width="100%" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iOTAwIiBoZWlnaHQ9IjUwMCIgdmlld0JveD0iMCAwIDkwMCA1MDAiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiPjwhLS0KU291cmNlIFVSTDogaG9sZGVyLmpzLzkwMHg1MDAvYXV0by8jNTU1OiMzMzMvdGV4dDpUaGlyZCBzbGlkZQpDcmVhdGVkIHdpdGggSG9sZGVyLmpzIDIuNi4wLgpMZWFybiBtb3JlIGF0IGh0dHA6Ly9ob2xkZXJqcy5jb20KKGMpIDIwMTItMjAxNSBJdmFuIE1hbG9waW5za3kgLSBodHRwOi8vaW1za3kuY28KLS0+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48IVtDREFUQVsjaG9sZGVyXzE3ZjNiNmExZjM1IHRleHQgeyBmaWxsOiMzMzM7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LWZhbWlseTpBcmlhbCwgSGVsdmV0aWNhLCBPcGVuIFNhbnMsIHNhbnMtc2VyaWYsIG1vbm9zcGFjZTtmb250LXNpemU6NDVwdCB9IF1dPjwvc3R5bGU+PC9kZWZzPjxnIGlkPSJob2xkZXJfMTdmM2I2YTFmMzUiPjxyZWN0IHdpZHRoPSI5MDAiIGhlaWdodD0iNTAwIiBmaWxsPSIjNTU1Ii8+PGc+PHRleHQgeD0iMjk4Ljg1NzEzMTk1ODAwNzgiIHk9IjI3MC43NDI4NTgxMjM3NzkzIj5UaGlyZCBzbGlkZTwvdGV4dD48L2c+PC9nPjwvc3ZnPg==" alt="Third Slide" /><div class="carousel-caption"></div></a>\n');
                    }
                    arr.push('\t\t\t\t\t\t\t\t\t</div>\n');
                    if (data.setting.slide_image_4) {
                        arr.push('\t\t\t\t\t\t\t\t\t<div class="item">\n');
                        arr.push('\t\t\t\t\t\t\t\t\t\t<a href="#' + data.setting.slide_url_4.replace(/^.*?(\/static\/.+?\.html)$/i, '$1') + '" title="Fourth Slide"><img width="100%" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + data.setting.slide_image_4.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + '" alt="Fourth Slide" /><div class="carousel-caption"></div></a>\n');
                        arr.push('\t\t\t\t\t\t\t\t\t</div>\n');
                    }
                    if (data.setting.slide_image_5) {
                        arr.push('\t\t\t\t\t\t\t\t\t<div class="item">\n');
                        arr.push('\t\t\t\t\t\t\t\t\t\t<a href="#' + data.setting.slide_url_5.replace(/^.*?(\/static\/.+?\.html)$/i, '$1') + '" title="Five Slide"><img width="100%" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + data.setting.slide_image_5.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + '" alt="Five Slide" /><div class="carousel-caption"></div></a>\n');
                        arr.push('\t\t\t\t\t\t\t\t\t</div>\n');
                    }
                    arr.push('\t\t\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t\t\t\t<a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<span class="sr-only">Previous</span>\n');
                    arr.push('\t\t\t\t\t\t\t\t</a>\n');
                    arr.push('\t\t\t\t\t\t\t\t<a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<span class="sr-only">Next</span>\n');
                    arr.push('\t\t\t\t\t\t\t\t</a>\n');
                    arr.push('\t\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t</div>\n');
                    arr.push('\t\t\t</div>\n');
                    // 左侧面板列表
                    arr.push(render.list(data, data.articles));
                    arr.push('\t\t</div>\n');
                    // 右侧侧边栏
                    arr.push(render.sidebar(data));
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 分类页
                category: function (data) {
                    var arr = [];
                    var articles = [];
                    var items = data.categories.filter(function(item, i) {
                        return render.slug == item.slug;
                    });
                    if (items.length) {
                        cat_ids = render.trees(data.categories, items[0].id, 0).map(function(item, i) {
                            return item.id;
                        });
                        cat_ids.unshift(items[0].id);
                        articles = data.articles.filter(function(item, i) {
                            return cat_ids.indexOf(item.category_id) !== -1;
                        });
                        arr.push('<div class="container">\n');
                        arr.push('\t<div class="row">\n');
                        // 左侧列表
                        arr.push('\t\t<div class="col-md-8">\n');
                        // 左侧顶部
                        if (items[0] && items[0].is_gallery == '1') {
                            // 相册列表
                            arr.push(render.grid(data, articles));
                        } else {
                            // 分类列表
                            arr.push('\t\t\t<div class="panel panel-default">\n');
                            arr.push('\t\t\t\t<div class="panel-body">\n');
                            // 搜索框
                            arr.push('\t\t\t\t\t<div class="row">\n');
                            arr.push('\t\t\t\t\t\t<div class="col-md-12">\n');
                            arr.push('\t\t\t\t\t\t\t<form class="input-group search-form">\n');
                            arr.push('\t\t\t\t\t\t\t\t<input type="text" name="q" value="' + render.q + '" class="form-control" placeholder="Search for..." required="required" />\n');
                            arr.push('\t\t\t\t\t\t\t\t<span class="input-group-btn">\n');
                            arr.push('\t\t\t\t\t\t\t\t\t<button class="btn btn-default" type="submit">\n');
                            arr.push('\t\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-search" aria-hidden="true"></span>\n');
                            arr.push('\t\t\t\t\t\t\t\t\t</button>\n');
                            arr.push('\t\t\t\t\t\t\t\t</span>\n');
                            arr.push('\t\t\t\t\t\t\t</form>\n');
                            arr.push('\t\t\t\t\t\t</div>\n');
                            arr.push('\t\t\t\t\t</div>\n');
                            arr.push('\t\t\t\t\t<hr>\n');
                            // 分类描述
                            arr.push('\t\t\t\t\t<div class="row">\n');
                            arr.push('\t\t\t\t\t\t<div class="col-sm-2 col-md-2">\n');
                            arr.push('\t\t\t\t\t\t\t<img class="img-thumbnail" style="width:100%;max-height:100px;background-color:#f1f1f1;background-image:none;" src="' + (items[0] && items[0].cover ? items[0].cover.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') : 'data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'32\' height=\'32\' viewBox=\'0 0 32 32\'%3E%3Cpath d=\'M18.007 9.040l7.585-2.545 6.362 18.962-7.585 2.545zM0 28h8v-22h-8v22zM2 10h4v2h-4v-2zM10 28h8v-22h-8v22zM12 10h4v2h-4v-2z\'%3E%3C/path%3E%3C/svg%3E%0A') + '" alt="' + (items[0] && items[0].name ? items[0].name : (data.localize && data.localize.uncategoried ? data.localize.uncategoried : '未分类')) + '" title="' + (data.category && data.category.name ? data.category.name : (data.localize && data.localize.uncategoried ? data.localize.uncategoried : '未分类')) + '" />\n');
                            arr.push('\t\t\t\t\t\t</div>\n');
                            arr.push('\t\t\t\t\t\t<div class="col-sm-10 col-md-10">\n');
                            arr.push('\t\t\t\t\t\t\t<h1 style="margin-top: 0;">' + (items[0] && items[0].name ? items[0].name : (data.localize && data.localize.uncategoried ? data.localize.uncategoried : '未分类')) + ' <span class="label label-info">' + (items.length ? render.trees(data.categories, items[0].id, 0).reduce(function(p, n) {
                                return parseInt(p) + parseInt(n.num);
                            }, items[0].num) : 0) + ' ' + (data.localize && data.localize.articles ? data.localize.articles : '篇文章') + '</span></h1>\n');
                            arr.push('\t\t\t\t\t\t\t<p class="well well-sm">' + (items[0] && items[0].description ? items[0].description.replace(/<[^>]*>/g, ' ') : (data.localize && data.localize.no_description ? data.localize.no_description : '还没有描述信息')) + '</p>\n');
                            arr.push('\t\t\t\t\t\t</div>\n');
                            arr.push('\t\t\t\t\t</div>\n');
                            arr.push('\t\t\t\t</div>\n');
                            arr.push('\t\t\t</div>\n');
                            // 左侧面板列表
                            arr.push(render.list(data, articles));
                        }
                        arr.push('\t\t</div>\n');
                        // 右侧侧栏
                        arr.push(render.sidebar(data));
                        arr.push('\t</div>\n');
                        arr.push('</div>\n');
                    } else {
                        var title = data.localize && data.localize.page_not_found ? data.localize.page_not_found : '页面未找到';
                        var msg = data.localize && data.localize.sorry_not_found ? data.localize.sorry_not_found : '抱歉，你要访问的页面不存在！'
                        arr.push(render.info(title, msg));
                    }
                    return arr.join('');
                },

                // 标签页
                tag: function (data) {
                    var arr = [];
                    var articles = [];
                    var items = data.tags.filter(function(item, i) {
                        return item.slug == render.slug;
                    });
                    if (items.length) {
                        articles = data.articles.filter(function(item, i) {
                            var tag_ids = JSON.parse(item.tag_ids || '[]').map(function(item, i) {
                                return parseInt(item);
                            });
                            return tag_ids.indexOf(parseInt(items[0].id)) !== -1;
                        });
                        arr.push('<div class="container">\n');
                        arr.push('\t<div class="row">\n');
                        // left list
                        arr.push('\t\t<div class="col-md-8">\n');
                        // panel left list
                        arr.push(render.list(data, articles));
                        arr.push('\t\t</div>\n');
                        // right sidebar
                        arr.push(render.sidebar(data));
                        arr.push('\t</div>\n');
                        arr.push('</div>\n');
                    } else {
                        var title = data.localize && data.localize.page_not_found ? data.localize.page_not_found : '页面未找到';
                        var msg = data.localize && data.localize.sorry_not_found ? data.localize.sorry_not_found : '抱歉，你要访问的页面不存在！'
                        arr.push(render.info(title, msg));
                    }
                    return arr.join('');
                },

                // 搜索页
                search: function (data) {
                    var arr = [];
                    var articles = [];
                    if (render.q) {
                        articles = data.articles.filter(function(item, i) {
                            return item.title.match(new RegExp(render.q, 'i'));
                        });
                    }
                    arr.push('<div class="container">\n');
                    arr.push('\t<div class="row">\n');
                    // 左侧列表
                    arr.push('\t\t<div class="col-md-8">\n');
                    // 搜索框
                    arr.push('\t\t\t<div class="panel panel-default">\n');
                    arr.push('\t\t\t\t<div class="panel-body">\n');
                    arr.push('\t\t\t\t\t<div class="row">\n');
                    arr.push('\t\t\t\t\t\t<div class="col-md-12">\n');
                    arr.push('\t\t\t\t\t\t\t<form class="input-group search-form">\n');
                    arr.push('\t\t\t\t\t\t\t\t<input type="text" name="q" value="' + render.q + '" class="form-control" placeholder="Search for..." required="required" />\n');
                    arr.push('\t\t\t\t\t\t\t\t<span class="input-group-btn">\n');
                    arr.push('\t\t\t\t\t\t\t\t\t<button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>\n');
                    arr.push('\t\t\t\t\t\t\t\t</span>\n');
                    arr.push('\t\t\t\t\t\t\t</form>\n');
                    arr.push('\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t</div>\n');
                    arr.push('\t\t\t</div>\n');
                    // panel left list
                    arr.push(render.list(data, articles));
                    arr.push('\t\t</div>\n');
                    arr.push(render.sidebar(data));
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 详情页
                detail: function (data) {
                    var arr = [];
                    var article = data.articles.filter(function(item, i) {
                        return item.slug == render.slug;
                    })[0];
                    var category = undefined;
                    if (article) {
                        category = data.categories.filter(function(item, i) {
                            return item.id == article.category_id;
                        })[0];
                        arr.push('<div class="container">\n');
                        arr.push('\t<div class="row">\n');
                        // 左侧列表
                        arr.push('\t\t<div class="col-md-8">\n');
                        // 详情内容
                        arr.push('\t\t\t<div class="panel panel-default">\n');
                        arr.push('\t\t\t\t<div class="panel-body">\n');
                        arr.push('\t\t\t\t\t<h1 class="text-center" id="title">' + (article ? article.title : (data.localize && data.localize.untitled ? data.localize.untitled : '无标题')) + '</h1>\n');
                        arr.push('\t\t\t\t\t<br>\n');
                        // 元信息
                        arr.push('\t\t\t\t\t<div class="panel panel-default">\n');
                        arr.push('\t\t\t\t\t\t<div class="panel-body">\n');
                        arr.push('\t\t\t\t\t\t\t<div class="pull-left">\n')
                        var t = new Date(article ? article.create_at * 1000 : 0);
                        var y = '' + t.getFullYear();
                        var m = ('0' + (t.getMonth() + 1)).slice(-2);
                        var d = ('0' + t.getDate()).slice(-2);
                        arr.push('\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-time text-muted" aria-hidden="true"></span> ' + (m + '/' + d + '/' + y.slice(-2)) + ' &nbsp;&nbsp;\n');
                        arr.push('\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-eye-open text-muted" aria-hidden="true"></span> <span class="post-views">' + parseInt(article ? article.views : 0) + '</span> &nbsp;&nbsp;\n');
                        arr.push('\t\t\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t\t\t<div class="pull-right">\n');
                        arr.push('\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-folder-open text-muted" aria-hidden="true"></span> &nbsp;' + (category ? '<a href="#' + render.route(render.lang, 'category', category.slug, 1, '', '') + '" title="' + category.name + '">' + category.name + '</a>' : 'uncategoried') + '\n');
                        arr.push('\t\t\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t</div>\n');
                        // 工具栏
                        arr.push('\t\t\t\t\t<div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">\n');
                        // 语音朗读
                        if (data.setting.voice_read == '1') {
                            arr.push('\t\t\t\t\t\t<div class="btn-group" role="group" aria-label="First group">\n');
                            arr.push('\t\t\t\t\t\t\t<button type="button" class="btn btn-default" disabled="disabled" aria-label="Left Align">\n');
                            arr.push('\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-headphones" aria-hidden="true"></span>\n');
                            arr.push('\t\t\t\t\t\t\t</button>\n');
                            arr.push('\t\t\t\t\t\t\t<button type="button" class="btn btn-default btn-play"' + (!data.voice ? ' disabled="disabled"' : '') + ' aria-label="Left Align">\n');
                            arr.push('\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-play" aria-hidden="true"></span>\n');
                            arr.push('\t\t\t\t\t\t\t</button>\n');
                            arr.push('\t\t\t\t\t\t</div>\n');
                        } else {
                            arr.push('\t\t\t\t\t\t<div class="btn-group pull-left" role="group" aria-label="First group">\n');
                            arr.push('\t\t\t\t\t\t\t<a href="' + render.cdn_url + '/app.html" download="H5' + data.setting.webName + '.html" role="button" title="H5 ' + (data.localize && data.localize.client ? data.localize.client : '客户端') + '" class="btn btn-default" aria-label="Left Align">\n');
                            arr.push('\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-phone" aria-hidden="true"></span> H5 ' + (data.localize && data.localize.client ? data.localize.client : '客户端') + '\n');
                            arr.push('\t\t\t\t\t\t\t</a>\n');
                            arr.push('\t\t\t\t\t\t</div>\n');
                        }
                        // 文字缩放
                        arr.push('\t\t\t\t\t\t<div class="btn-group pull-right ignore" role="group" aria-label="Second group">\n');
                        arr.push('\t\t\t\t\t\t\t<button type="button" class="btn btn-default font-zoom" data-size="bigger" aria-label="Right Align">\n');
                        arr.push('\t\t\t\t\t\t\t\tA <sup>+</sup>\n');
                        arr.push('\t\t\t\t\t\t\t</button>\n');
                        arr.push('\t\t\t\t\t\t\t<button type="button" class="btn btn-default font-zoom" data-size="smaller" aria-label="Right Align">\n');
                        arr.push('\t\t\t\t\t\t\t\tA <sup>-</sup>\n');
                        arr.push('\t\t\t\t\t\t\t</button>\n');
                        arr.push('\t\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t<div id="loading"></div>\n');
                        // 内容区域
                        arr.push('\t\t\t\t\t<div class="entry-content">\n');
                        if (article && article.description) {
                            arr.push('\t\t\t\t\t\t<p class="lead">' + article.description + '</p>\n');
                        }
                        if (article) {
                            arr.push('\t\t\t\t\t\t' + article.content.replace(/<img[^>]*src=(["'])([^"']+)(["'])[^>]*>/gi, function(match, p1, p2, p3) {
                            return '<img src='+ p1 + 'data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' + p3 +' data-src='+ p1 + p2.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + p3 +' class='+ p1 + 'img-thumbnail' + p3 +' alt='+ p1 + article.title.replace(/<[^>]*>/g, ' ') + p3 +' title='+ p1 + article.title.replace(/<[^>]*>/g, ' ') + p3 +' />';
                        }) + '\n');
                        } else {
                            arr.push('\t\t\t\t\t\t' + (data.localize && data.localize.no_datas ? data.localize.no_datas : '还没有数据') + '\n');
                        }
                        arr.push('\t\t\t\t\t</div>\n');
                        // 分享按钮
                        arr.push('\t\t\t\t\t<div class="share-container text-center">\n');
                        arr.push('\t\t\t\t\t\t<span class="share-to">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 32 32">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M27 22c-1.411 0-2.685 0.586-3.594 1.526l-13.469-6.734c0.041-0.258 0.063-0.522 0.063-0.791s-0.022-0.534-0.063-0.791l13.469-6.734c0.909 0.94 2.183 1.526 3.594 1.526 2.761 0 5-2.239 5-5s-2.239-5-5-5-5 2.239-5 5c0 0.269 0.022 0.534 0.063 0.791l-13.469 6.734c-0.909-0.94-2.183-1.526-3.594-1.526-2.761 0-5 2.239-5 5s2.239 5 5 5c1.411 0 2.685-0.586 3.594-1.526l13.469 6.734c-0.041 0.258-0.063 0.522-0.063 0.791 0 2.761 2.239 5 5 5s5-2.239 5-5c0-2.761-2.239-5-5-5z" fill="#777777"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</span>\n');
                        // 微信
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn wechat" data-platform="wechat" title="' + (data.localize && data.localize.wechat ? data.localize.wechat : '微信') + '">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 32 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M9.063 7.203c0-0.859-0.562-1.422-1.422-1.422-0.844 0-1.703 0.562-1.703 1.422 0 0.844 0.859 1.406 1.703 1.406 0.859 0 1.422-0.562 1.422-1.406zM20.672 15.125c0-0.562-0.562-1.125-1.422-1.125-0.562 0-1.125 0.562-1.125 1.125 0 0.578 0.562 1.141 1.125 1.141 0.859 0 1.422-0.562 1.422-1.141zM16.984 7.203c0-0.859-0.562-1.422-1.406-1.422-0.859 0-1.703 0.562-1.703 1.422 0 0.844 0.844 1.406 1.703 1.406 0.844 0 1.406-0.562 1.406-1.406zM26.906 15.125c0-0.562-0.578-1.125-1.422-1.125-0.562 0-1.125 0.562-1.125 1.125 0 0.578 0.562 1.141 1.125 1.141 0.844 0 1.422-0.562 1.422-1.141zM22.75 8.922c-0.359-0.047-0.719-0.063-1.094-0.063-5.375 0-9.625 4.016-9.625 8.953 0 0.828 0.125 1.625 0.359 2.375-0.359 0.031-0.703 0.047-1.062 0.047-1.422 0-2.547-0.281-3.969-0.562l-3.953 1.984 1.125-3.406c-2.828-1.984-4.531-4.547-4.531-7.656 0-5.391 5.094-9.625 11.328-9.625 5.563 0 10.453 3.391 11.422 7.953zM32 17.687c0 2.547-1.687 4.813-3.969 6.516l0.859 2.828-3.109-1.703c-1.141 0.281-2.281 0.578-3.406 0.578-5.391 0-9.625-3.687-9.625-8.219s4.234-8.219 9.625-8.219c5.094 0 9.625 3.687 9.625 8.219z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // QQ
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn qq" data-platform="qq" title="QQ">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 28 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M4.219 12.594c-0.109-0.266-0.125-0.531-0.125-0.812 0-0.438 0.281-1.141 0.547-1.469-0.016-0.406 0.156-1.234 0.469-1.5 0-2.891 2.234-6.531 4.844-7.781 1.609-0.766 3.297-1.031 5.063-1.031 1.375 0 2.875 0.328 4.156 0.859 3.672 1.547 4.5 4.422 5.281 8.094l0.016 0.078c0.453 0.688 0.859 1.5 0.859 2.344 0 0.422-0.281 0.844-0.281 1.219 0 0.031 0.094 0.156 0.109 0.187 1.344 1.984 2.562 4.141 2.562 6.609 0 0.547-0.297 2.453-1.172 2.453-0.609 0-1.281-1.484-1.5-1.891-0.016-0.016-0.031-0.016-0.047-0.016l-0.078 0.063c-0.5 1.297-1.047 2.516-2.063 3.484 0.891 0.859 2.328 0.781 2.594 2.266-0.078 0.172-0.047 0.359-0.172 0.531-0.891 1.344-3.281 1.516-4.719 1.516-1.906 0-3.453-0.5-5.25-1.031-0.375-0.109-0.938-0.047-1.344-0.094-0.953 1.047-3.281 1.328-4.625 1.328-1.188 0-5.781-0.078-5.781-2.109 0-0.875 0.187-1.125 0.797-1.687 0.484-0.094 0.844-0.359 1.406-0.391 0.078 0 0.141-0.016 0.219-0.031 0.016-0.016 0.031-0.016 0.031-0.063l-0.031-0.047c-1.078-0.25-2.594-2.969-2.828-4.094l-0.078-0.047c-0.109 0-0.156 0.234-0.187 0.313-0.344 0.797-1.156 1.656-2.063 1.75h-0.016c-0.125 0-0.078-0.125-0.172-0.156-0.219-0.516-0.359-0.984-0.359-1.563 0-3.125 1.5-5.437 3.938-7.281z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // 微博
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn weibo" data-platform="weibo" title="Weibo">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 28 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M10.547 20.062c0.438-0.719 0.203-1.547-0.531-1.859-0.703-0.297-1.641 0.016-2.078 0.703-0.453 0.703-0.234 1.531 0.469 1.859 0.719 0.328 1.687 0.016 2.141-0.703zM12.016 18.172c0.156-0.281 0.063-0.594-0.219-0.703-0.281-0.094-0.625 0.031-0.781 0.297-0.156 0.281-0.078 0.578 0.203 0.703 0.281 0.109 0.641-0.016 0.797-0.297zM14.734 19.844c-0.938 2.125-3.656 3.281-5.969 2.531-2.234-0.719-3.172-2.922-2.203-4.906 0.969-1.937 3.453-3.031 5.656-2.469 2.297 0.594 3.453 2.75 2.516 4.844zM19.609 17.344c-0.297-3.047-4.297-5.141-8.937-4.688-4.641 0.469-8.141 3.297-7.844 6.344s4.297 5.141 8.937 4.688c4.641-0.469 8.141-3.297 7.844-6.344zM24.422 17.406c0 3.516-5.063 7.938-12.672 7.938-5.812 0-11.75-2.812-11.75-7.453 0-2.422 1.531-5.219 4.172-7.859 3.531-3.531 7.641-5.125 9.188-3.578 0.688 0.672 0.75 1.859 0.313 3.266-0.219 0.719 0.672 0.313 0.672 0.328 2.844-1.203 5.328-1.266 6.234 0.031 0.484 0.688 0.438 1.656 0 2.781-0.203 0.516 0.063 0.594 0.453 0.719 1.609 0.5 3.391 1.703 3.391 3.828zM23.266 7.656c0.891 0.984 1.141 2.344 0.75 3.531-0.156 0.484-0.672 0.75-1.156 0.594s-0.75-0.672-0.594-1.156v0c0.187-0.594 0.063-1.25-0.375-1.734s-1.078-0.672-1.672-0.547v0c-0.5 0.109-1-0.203-1.094-0.703-0.109-0.5 0.203-0.984 0.703-1.094 1.219-0.266 2.547 0.109 3.437 1.109zM26.094 5.109c1.844 2.031 2.328 4.812 1.547 7.25v0c-0.187 0.562-0.781 0.875-1.344 0.688s-0.875-0.781-0.703-1.344v0c0.562-1.734 0.219-3.719-1.094-5.156-1.313-1.453-3.234-2-5.016-1.625-0.578 0.125-1.156-0.25-1.281-0.828s0.25-1.141 0.828-1.266v0c2.516-0.531 5.219 0.234 7.063 2.281z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // Facebook
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn facebook" data-platform="facebook" title="Facebook">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 16 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M14.984 0.187v4.125h-2.453c-1.922 0-2.281 0.922-2.281 2.25v2.953h4.578l-0.609 4.625h-3.969v11.859h-4.781v-11.859h-3.984v-4.625h3.984v-3.406c0-3.953 2.422-6.109 5.953-6.109 1.687 0 3.141 0.125 3.563 0.187z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // Twitter
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn twitter" data-platform="twitter" title="Twitter">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 26 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M25.312 6.375c-0.688 1-1.547 1.891-2.531 2.609 0.016 0.219 0.016 0.438 0.016 0.656 0 6.672-5.078 14.359-14.359 14.359-2.859 0-5.516-0.828-7.75-2.266 0.406 0.047 0.797 0.063 1.219 0.063 2.359 0 4.531-0.797 6.266-2.156-2.219-0.047-4.078-1.5-4.719-3.5 0.313 0.047 0.625 0.078 0.953 0.078 0.453 0 0.906-0.063 1.328-0.172-2.312-0.469-4.047-2.5-4.047-4.953v-0.063c0.672 0.375 1.453 0.609 2.281 0.641-1.359-0.906-2.25-2.453-2.25-4.203 0-0.938 0.25-1.797 0.688-2.547 2.484 3.062 6.219 5.063 10.406 5.281-0.078-0.375-0.125-0.766-0.125-1.156 0-2.781 2.25-5.047 5.047-5.047 1.453 0 2.766 0.609 3.687 1.594 1.141-0.219 2.234-0.641 3.203-1.219-0.375 1.172-1.172 2.156-2.219 2.781 1.016-0.109 2-0.391 2.906-0.781z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // LinkedIn
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn linkedin" data-platform="linkedin" title="LinkedIn">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 24 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M5.453 9.766v15.484h-5.156v-15.484h5.156zM5.781 4.984c0.016 1.484-1.109 2.672-2.906 2.672v0h-0.031c-1.734 0-2.844-1.188-2.844-2.672 0-1.516 1.156-2.672 2.906-2.672 1.766 0 2.859 1.156 2.875 2.672zM24 16.375v8.875h-5.141v-8.281c0-2.078-0.75-3.5-2.609-3.5-1.422 0-2.266 0.953-2.641 1.875-0.125 0.344-0.172 0.797-0.172 1.266v8.641h-5.141c0.063-14.031 0-15.484 0-15.484h5.141v2.25h-0.031c0.672-1.062 1.891-2.609 4.672-2.609 3.391 0 5.922 2.219 5.922 6.969z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // Pinterest
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn pinterest" data-platform="pinterest" title="Pinterest">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 20 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M0 9.328c0-5.766 5.281-9.328 10.625-9.328 4.906 0 9.375 3.375 9.375 8.547 0 4.859-2.484 10.25-8.016 10.25-1.313 0-2.969-0.656-3.609-1.875-1.188 4.703-1.094 5.406-3.719 9l-0.219 0.078-0.141-0.156c-0.094-0.984-0.234-1.953-0.234-2.938 0-3.187 1.469-7.797 2.188-10.891-0.391-0.797-0.5-1.766-0.5-2.641 0-1.578 1.094-3.578 2.875-3.578 1.313 0 2.016 1 2.016 2.234 0 2.031-1.375 3.938-1.375 5.906 0 1.344 1.109 2.281 2.406 2.281 3.594 0 4.703-5.187 4.703-7.953 0-3.703-2.625-5.719-6.172-5.719-4.125 0-7.313 2.969-7.313 7.156 0 2.016 1.234 3.047 1.234 3.531 0 0.406-0.297 1.844-0.812 1.844-0.078 0-0.187-0.031-0.266-0.047-2.234-0.672-3.047-3.656-3.047-5.703z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // WhatsApp
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn whatsapp" data-platform="whatsapp" title="WhatsApp">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 24 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M15.391 15.219c0.266 0 2.812 1.328 2.922 1.516 0.031 0.078 0.031 0.172 0.031 0.234 0 0.391-0.125 0.828-0.266 1.188-0.359 0.875-1.813 1.437-2.703 1.437-0.75 0-2.297-0.656-2.969-0.969-2.234-1.016-3.625-2.75-4.969-4.734-0.594-0.875-1.125-1.953-1.109-3.031v-0.125c0.031-1.031 0.406-1.766 1.156-2.469 0.234-0.219 0.484-0.344 0.812-0.344 0.187 0 0.375 0.047 0.578 0.047 0.422 0 0.5 0.125 0.656 0.531 0.109 0.266 0.906 2.391 0.906 2.547 0 0.594-1.078 1.266-1.078 1.625 0 0.078 0.031 0.156 0.078 0.234 0.344 0.734 1 1.578 1.594 2.141 0.719 0.688 1.484 1.141 2.359 1.578 0.109 0.063 0.219 0.109 0.344 0.109 0.469 0 1.25-1.516 1.656-1.516zM12.219 23.5c5.406 0 9.812-4.406 9.812-9.812s-4.406-9.812-9.812-9.812-9.812 4.406-9.812 9.812c0 2.063 0.656 4.078 1.875 5.75l-1.234 3.641 3.781-1.203c1.594 1.047 3.484 1.625 5.391 1.625zM12.219 1.906c6.5 0 11.781 5.281 11.781 11.781s-5.281 11.781-11.781 11.781c-1.984 0-3.953-0.5-5.703-1.469l-6.516 2.094 2.125-6.328c-1.109-1.828-1.687-3.938-1.687-6.078 0-6.5 5.281-11.781 11.781-11.781z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // Telegram
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn telegram" data-platform="telegram" title="Telegram">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 28 28">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M18.578 20.422l2.297-10.828c0.203-0.953-0.344-1.328-0.969-1.094l-13.5 5.203c-0.922 0.359-0.906 0.875-0.156 1.109l3.453 1.078 8.016-5.047c0.375-0.25 0.719-0.109 0.438 0.141l-6.484 5.859-0.25 3.563c0.359 0 0.516-0.156 0.703-0.344l1.687-1.625 3.5 2.578c0.641 0.359 1.094 0.172 1.266-0.594zM28 14c0 7.734-6.266 14-14 14s-14-6.266-14-14 6.266-14 14-14 14 6.266 14 14z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        // Email
                        arr.push('\t\t\t\t\t\t<a href="javascript:;" rel="nofollow" class="share-btn email" data-platform="email" title="Email">\n');
                        arr.push('\t\t\t\t\t\t\t<svg class="share-icon" viewBox="0 0 32 32">\n');
                        arr.push('\t\t\t\t\t\t\t\t<path d="M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM8 8h16c0.286 0 0.563 0.061 0.817 0.177l-8.817 10.286-8.817-10.287c0.254-0.116 0.531-0.177 0.817-0.177zM6 22v-12c0-0.042 0.002-0.084 0.004-0.125l5.864 6.842-5.8 5.8c-0.045-0.167-0.069-0.34-0.069-0.517zM24 24h-16c-0.177 0-0.35-0.024-0.517-0.069l5.691-5.691 2.826 3.297 2.826-3.297 5.691 5.691c-0.167 0.045-0.34 0.069-0.517 0.069zM26 22c0 0.177-0.024 0.35-0.069 0.517l-5.8-5.8 5.865-6.842c0.003 0.041 0.004 0.083 0.004 0.125v12z"></path>\n');
                        arr.push('\t\t\t\t\t\t\t</svg>\n');
                        arr.push('\t\t\t\t\t\t</a>\n');
                        arr.push('\t\t\t\t\t</div>\n');
                        // 下载内容
                        arr.push('\t\t\t\t\t<div class="text-center">\n');
                        arr.push('\t\t\t\t\t\t<div class="btn-group">\n');
                        arr.push('\t\t\t\t\t\t\t<a type="button" class="btn btn-info' + (data.download ? '' : ' btn-download') + '" aria-label="Download" href="' + (data.download ? data.download : 'javascript:;') + '" title="' + (data.localize && data.localize.download_content ? data.localize.download_content : '下载内容') + '"' + (article && data.download ? ' download="'+ (render.lang == 'zh-CN' ? '' : render.lang +'-') +'ID'+ (Array(7).join('0') + article.id).slice(-7) +'-'+ article.title.split(/\s+/).join('-') +'-'+ data.setting.webName +'.html"' : '') + '><span class="glyphicon glyphicon-download-alt" aria-label="Download"></span> ' + (data.localize && data.localize.download_content ? data.localize.download_content : '下载内容') + '</a>\n');
                        arr.push('\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t<div class="btn-group">\n');
                        arr.push('\t\t\t\t\t\t<button type="button" class="btn btn-warning btn-favorite" aria-label="Favorite" title="' + (data.localize && data.localize.favorite_article ? data.localize.favorite_article : '收藏文章') + '"><span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span> ' + (data.localize && data.localize.favorite_article ? data.localize.favorite_article : '收藏文章') + '</button>\n');
                        arr.push('\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t<br>\n');
                        // 版权信息
                        arr.push('\t\t\t\t<div class="well well-sm text-muted">\n');
                        arr.push('\t\t\t\t\t' + (data.localize && data.localize.copyr_info ? data.localize.copyr_info : '除非特别说明，本博客均为原创，如需转载，请以链接形式标明来源出处。') + '<br>\n');
                        arr.push('\t\t\t\t\t' + (data.localize && data.localize.copyr_address ? data.localize.copyr_address : '本文博客网址') + ': ' + (article ? ((location.protocol.match(/https?:/) ? location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') : render.cdn_url) + '/#' + render.route(render.lang, 'detail', article.slug, 1, '', '')) : data.localize && data.localize.no_address ? data.localize.no_address : '还没有网址') + '\n');
                        arr.push('\t\t\t\t</div>\n');
                        // 点赞
                        arr.push('\t\t\t\t<button type="button" class="btn btn-success' + (render.login != 0 ? ' btn-likes' : ' login') + '">\n');
                        arr.push('\t\t\t\t\t<span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span> ' + (data.localize && data.localize.article_useful ? data.localize.article_useful : '这篇文章很有用') + '\n');
                        arr.push('\t\t\t\t</button>\n');
                        arr.push('\t\t\t\t<button type="button" class="btn btn-link text-primary" disabled="disabled">\n');
                        arr.push('\t\t\t\t\t<span class="glyphicon glyphicon-fire" aria-hidden="true"></span>\n');
                        arr.push('\t\t\t\t\t<span class="post-likes">' + (article ? article.likes : 0) + '</span> ' + (data.localize && data.localize.people_likes ? data.localize.people_likes : '人觉得这篇文章很赞') + '\n');
                        arr.push('\t\t\t\t</button>\n');
                        // 上一页下一页
                        var prev = null;
                        var next = null;
                        for (var i = 0; i < data.articles.length; i++) {
                            if (article && data.articles[i].id == article.id) {
                                if (i > 1) {
                                    prev = data.articles[i - 1];
                                }
                                if (i + 1 < data.articles.length) {
                                    next = data.articles[i + 1];
                                }
                                break;
                            }
                        }
                        arr.push('\t\t\t\t<ul class="pager">\n');
                        arr.push('\t\t\t\t\t<li class="previous' + (prev ? '' : ' disabled="disabled"') + '">\n');
                        if (prev) {
                            arr.push('\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'detail', prev.slug, 1, '', '') + '"><span aria-hidden="true">&larr;</span> Older</a>\n');
                        } else {
                            arr.push('\t\t\t\t\t\t<span aria-hidden="true">&larr; ' + (data.localize && data.localize.nothing ? data.localize.nothing : '没有了') + '</span>\n')
                        }
                        arr.push('\t\t\t\t\t</li>\n');
                        arr.push('\t\t\t\t\t<li class="next' + (next ? '' : ' disabled="disabled"') + '">\n');
                        if (next) {
                            arr.push('\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'detail', next.slug, 1, '', '') + '">Newer <span aria-hidden="true">&rarr;</span></a>\n');
                        } else {
                            arr.push('\t\t\t\t\t\t<span aria-hidden="true">' + (data.localize && data.localize.nothing ? data.localize.nothing : '没有了') + ' &rarr;</span>\n');
                        }
                        arr.push('\t\t\t\t\t</li>\n');
                        arr.push('\t\t\t\t</ul>\n');
                        // 内容标签
                        var tag_ids = article ? JSON.parse(article.tag_ids || '[]') : [];
                        if (tag_ids.length) {
                            arr.push('\t\t\t\t<hr>\n');
                            arr.push('\t\t\t\t<span class="glyphicon glyphicon-tags text-muted" aria-hidden="true"></span> &nbsp;\n');
                            data.tags.filter(function(el) {
                                return tag_ids.map(function(ele) {
                                    return parseInt(ele);
                                }).indexOf(el.id) !== -1;
                            }).forEach(function(item, i) {
                                arr.push((i > 0 ? ', ' : '') + '<a href="#' + render.route(render.lang, 'tag', item.slug, 1, '', '') + '" title="' + item.name + '">' + item.name + '</a>');
                            });
                        }
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                        // 相关文章
                        if (tag_ids.length) {
                            var related = data.articles.filter(function(item, i) {
                                var rel_ids = JSON.parse(item.tag_ids || '[]');
                                var condition = item.id != article.id;
                                for (i = 0; i < tag_ids.length; i++) {
                                    condition = condition && rel_ids.indexOf(tag_ids[i]) !== -1;
                                }
                                return condition;
                            }).slice(0, data.setting.related_num);
                            if (related.length) {
                                arr.push('\t\t<div class="panel panel-default">\n');
                                arr.push('\t\t\t<div class="panel-heading">\n');
                                arr.push('\t\t\t\t<h3 class="panel-title">' + (data.localize && data.localize.related_articles ? data.localize.related_articles : '相关文章') + '</h3>\n');
                                arr.push('\t\t\t</div>\n');
                                arr.push('\t\t\t<div class="panel-body">\n');
                                // 相册卡片
                                arr.push('\t\t\t\t<div class="row">\n');
                                related.forEach(function (item, i) {
                                    var match = item.content.match(/<img[^>]*src=["']([^"']*)["'][^>]*>/i);
                                    item.cover = (item.cover || (match ? match[1] : '')).replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1');
                                    arr.push('\t\t\t\t\t<div class="col-sm-4">\n');
                                    arr.push('\t\t\t\t\t\t<div class="thumbnail">\n');
                                    arr.push('\t\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'detail', item.slug, 1, '', '') + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '">\n');
                                    arr.push('\t\t\t\t\t\t\t\t<img style="width:100%;height:95px;background-color:#f1f1f1;" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + (item.cover ? item.cover : 'data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==') + '" alt="' + item.title + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '" />\n');
                                    arr.push('\t\t\t\t\t\t\t</a>\n');
                                    arr.push('\t\t\t\t\t\t\t<div class="caption">\n');
                                    arr.push('\t\t\t\t\t\t\t\t<h3 style="margin:0;font-size:14.7px;">\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t<a href="#' + render.route(render.lang, 'detail', item.slug, 1, '', '') + '" title="' + item.title.replace(/<[^>]*>/g, ' ') + '">' + item.title + '</a>\n');
                                    arr.push('\t\t\t\t\t\t\t\t</h3>\n');
                                    arr.push('\t\t\t\t\t\t\t</div>\n');
                                    arr.push('\t\t\t\t\t\t</div>\n');
                                    arr.push('\t\t\t\t\t</div>\n');
                                });
                                arr.push('\t\t\t\t</div>\n');
                                arr.push('\t\t\t</div>\n');
                                arr.push('\t\t</div>\n');
                            }
                        }
                        // 评论区域
                        arr.push('\t\t<div class="panel panel-default" id="comments">\n');
                        arr.push('\t\t\t<div class="panel-heading">\n');
                        arr.push('\t\t\t\t<h3 class="panel-title">' + (data.localize && data.localize.post_comment ? data.localize.post_comment : '发表评论') + '</h3>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t\t<div class="panel-body">\n');
                        arr.push('\t\t\t\t<div class="row">\n');
                        arr.push('\t\t\t\t\t<div class="col-md-12" id="comment-area">\n');
                        // 评论框
                        arr.push('\t\t\t\t\t\t<form id="commentForm" class="commentForm" style="position: relative">\n');
                        arr.push('\t\t\t\t\t\t\t<div class="form-group">\n');
                        if (article && article.can_comment == '0') {
                            arr.push('\t\t\t\t\t\t\t\t<textarea class="form-control" rows="3" name="comment" class="form-control" id="comment" placeholder="' + (data.localize && data.localize.comment_content ? data.localize.comment_content : '评论内容') + '..."' + (data.setting.can_comment == '1' && render.login == 0 ? ' disabled' : '') + ' required></textarea>\n');
                        }
                        if (article && article.can_comment == '0' && data.setting.can_comment == '1' && render.login == 0) {
                            arr.push('\t\t\t\t\t\t\t\t<p style="position: absolute;top: 30%;margin-top: -1rem;left: 50%;margin-left: -8rem;">' + (data.localize && data.localize.please ? data.localize.please : '请') + ' [<a class="login" href="javascript:;" rel="nofollow" title="' + (data.localize && data.localize.login ? data.localize.login : '登录') + '">' + (data.localize && data.localize.login ? data.localize.login : '登录') + '</a>] ' + (data.localize && data.localize.after_comment ? data.localize.after_comment : '后评论') + '</p>\n');
                        }
                        arr.push('\t\t\t\t\t\t\t</div>\n');
                        if (article && article.can_comment == '0') {
                            arr.push('\t\t\t\t\t\t\t<div class="form-group" style="position: relative;text-align: right;">\n');
                            arr.push('\t\t\t\t\t\t\t\t<input type="hidden" name="post_id" value="' + article.id + '" />\n');
                            arr.push('\t\t\t\t\t\t\t\t<input type="hidden" name="pid" value="0">\n');
                            if (render.login != 0 && render.login.auth_ids.indexOf(88) !== -1) {
                                arr.push('\t\t\t\t\t\t\t\t<input type="hidden" name="can_delete" value="1">\n');
                            } else {
                                arr.push('\t\t\t\t\t\t\t\t<input type="hidden" name="can_delete" value="0">\n');
                            }
                            arr.push('\t\t\t\t\t\t\t\t<input type="hidden" name="token" value="' + render.token + '">\n');
                            arr.push('\t\t\t\t\t\t\t\t<input type="hidden" name="anti_spam" value="' + data.anti_spam_val + '">\n');
                            arr.push('\t\t\t\t\t\t\t\t<button type="submit" class="btn btn-primary">\n');
                            arr.push('\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-send" aria-hidden="true"></span> ' + (data.localize && data.localize.post_comment ? data.localize.post_comment : '发表评论') + '\n');
                            arr.push('\t\t\t\t\t\t\t\t</button>\n');
                            arr.push('\t\t\t\t\t\t\t\t<span class="tips" style="position: absolute;left: 0;top: .5rem;"></span>\n');
                            arr.push('\t\t\t\t\t\t\t</div>\n');
                        }
                        arr.push('\t\t\t\t\t\t</form>\n');
                        // 评论列表
                        var comments = render.levels(data.comments.filter(function(item, i) {
                            return item.article_id == article ? article.id : 0;
                        }), 0, 0);
                        if (comments.length) {
                            var user = render.format(data.users, 'username');
                            comments.slice((render.p - 1) * render.limit, render.p * render.limit).forEach(function (item) {
                                arr.push('\t\t\t\t\t\t\t<div class="panel panel-default" id="comment-' + item.id + '">\n');
                                arr.push('\t\t\t\t\t\t\t\t<div class="panel-body">\n');
                                // 媒体对象
                                arr.push('\t\t\t\t\t\t\t\t\t<div class="media">\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t<div class="media-left">\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t\t<img class="media-object img-circle avatar" style="width: 64px;height: 64px;background-color: #f1f1f1;" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + (user[item.author] && user[item.author].avatar ? user[item.author].avatar.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') : '') + '" alt="' + (user[item.author] && user[item.author].nickname ? user[item.author].nickname : item.author) + '" title="' + (user[item.author] && user[item.author].nickname ? user[item.author].nickname : item.author) + '" />\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t</div>\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t<div class="media-body">\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t\t<h4 class="media-heading"><strong>' + (user[item.author] && user[item.author].nickname ? user[item.author].nickname : item.author) + '</strong> <cite>' + (data.localize && data.localize.say ? data.localize.say : '说道') + ': </cite></h4>\n');
                                // 评论内容
                                arr.push('\t\t\t\t\t\t\t\t\t\t\t' + item.comment.replace(/<img[^>]*src=(["'])([^"']+)(["'])[^>]*>/gi, function(match, p1, p2, p3) {
                                    return '<img src='+ p1 + 'data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' + p3 +' data-src='+ p1 + p2.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + p3 +' class='+ p1 + 'img-thumbnail' + p3 +' alt='+ p1 + article.title.replace(/<[^>]*>/g, ' ') + p3 +' title='+ p1 + article.title.replace(/<[^>]*>/g, ' ') + p3 +' />';
                                }) + (render.login != 0 && render.login.auth_ids.indexOf(88) !== -1 ? ' (<a href="javascript:;" class="delete-comment text-danger" data-id="' + item.id + '" title="' + (data.localize && data.localize.delete ? data.localize.delete : '删除') + '">' + (data.localize && data.localize.delete ? data.localize.delete : '删除') + '</a>) ' : '') + '\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t\t<div class="clearfix" style="margin: 10px 0;">\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t\t\t<button type="button" data-id="' + item.id + '" class="pull-right btn btn-success btn-reply btn-sm media-right">\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span> ' + (data.localize && data.localize.reply ? data.localize.reply : '回复') + '\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t\t\t</button>\n');
                                arr.push('\t\t\t\t\t\t\t\t\t\t\t</div>\n');
                                // 回复列表
                                item.children.forEach(function (reply, i) {
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t<div class="media' + (i > 4 ? ' hidden' : '') + '" id="comment-' + reply.id + '">\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t\t<hr style="margin-top: 10px;" />\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t\t<div class="media-left">\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t\t\t<img class="media-object img-circle avatar" style="width: 64px;height: 64px;background-color: #f1f1f1;" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-src="' + (user[reply.author] && user[reply.author].avatar ? user[reply.author].avatar.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') : '') + '" alt="' + (user[reply.author] && user[reply.author].nickname ? user[reply.author].nickname : reply.author) + '" title="' + (user[reply.author] && user[reply.author].nickname ? user[reply.author].nickname : reply.author) + '" />\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t\t</div>\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t\t<div class="media-body">\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t\t\t<h4 class="media-heading">' + (user[reply.author] && user[reply.author].nickname ? user[reply.author].nickname : reply.author) + ' ' + (data.localize && data.localize.reply ? data.localize.reply : '回复') + ': </h4>\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t\t\t' + reply.comment.replace(/<img[^>]*src=(["'])([^"']+)(["'])[^>]*>/gi, function(match, p1, p2, p3) {
                                        return '<img src='+ p1 + 'data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' + p3 +' data-src='+ p1 + p2.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + p3 +' class='+ p1 + 'img-thumbnail' + p3 +' alt='+ p1 + article.title.replace(/<[^>]*>/g, ' ') + p3 +' title='+ p1 + article.title.replace(/<[^>]*>/g, ' ') + p3 +' />';
                                    }) + (render.login != 0 && render.login.auth_ids.indexOf(88) !== -1 ? ' (<a href="javascript:;" class="delete-comment text-danger" data-id="' + reply.id + '" title="' + (data.localize && data.localize.delete ? data.localize.delete : '删除') + '">' + (data.localize && data.localize.delete ? data.localize.delete : '删除') + '</a>) ' : '') + '\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t\t</div>\n');
                                    arr.push('\t\t\t\t\t\t\t\t\t\t\t</div>\n');
                                    // 回复分页
                                    if (i == item.children.length - 1 && i > 4) {
                                        arr.push('\t\t\t\t\t\t\t\t\t\t\t<nav aria-label="Page navigation">\n');
                                        arr.push('\t\t\t\t\t\t\t\t\t\t\t\t<hr />\n');
                                        arr.push('\t\t\t\t\t\t\t\t\t\t\t\t<ul class="pager pager-reply" data-index="0">\n');
                                        arr.push('\t\t\t\t\t\t\t\t\t\t\t\t\t<li class="disabled" data-type="prev"><a href="javascript:;" title="Previous">Previous</a></li>\n');
                                        arr.push('\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="next"><a href="javascript:;" title="Next">Next</a></li>\n');
                                        arr.push('\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="all"><a href="javascript:;" title="All">All</a></li>\n');
                                        arr.push('\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n');
                                        arr.push('\t\t\t\t\t\t\t\t\t\t\t</nav>\n');
                                    }
                                });
                                arr.push('\t\t\t\t\t\t\t\t\t\t</div>\n');
                                arr.push('\t\t\t\t\t\t\t\t\t</div>\n');
                                arr.push('\t\t\t\t\t\t\t\t</div>\n');
                                arr.push('\t\t\t\t\t\t\t</div>\n');
                            });
                        } else {
                            arr.push('\t\t\t\t\t\t\t<p class="text-center text-muted no-comment">' + (data.localize && data.localize.no_comment ? data.localize.no_comment : '还没有评论') + '</p>\n');
                        }
                        arr.push('\t\t\t\t\t\t</div>\n');
                        arr.push('\t\t\t\t\t</div>\n');
                        // 评论分页
                        if (article && article.can_comment == '0') {
                            arr.push(render.pager(comments.length, render.limit));
                        }
                        arr.push('\t\t\t\t</div>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                        arr.push(render.sidebar(data));
                        arr.push('\t</div>\n');
                        arr.push('</div>\n');
                    } else {
                        var title = data.localize && data.localize.page_not_found ? data.localize.page_not_found : '页面未找到';
                        var msg = data.localize && data.localize.sorry_not_found ? data.localize.sorry_not_found : '抱歉，你要访问的页面不存在！'
                        arr.push(render.info(title, msg));
                    }
                    return arr.join('');
                },

                // 独立页面
                page: function (data) {
                    var arr = [];
                    var page = data.pages.filter(function(item, i) {
                        return item.slug == render.slug;
                    })[0];
                    // 文章收藏或点赞列表
                    if (page && page.slug.match(/^page-/) && render[page.slug.replace('-', '_')]) {
                        arr.push(render[page.slug.replace('-', '_')](data, page));
                    } else {
                        if (page) {
                            var childs = render.trees(data.pages, page ? page.id : -1, 0);
                            arr.push('<div class="container">\n');
                            // 宽屏页面
                            if (page && page.is_full == '1') {
                                // 子宽屏页
                                if (childs.length) {
                                    arr.push(render.list_page(childs));
                                } else {
                                    arr.push('\t<div class="row">\n');
                                    // 宽屏内容
                                    arr.push('\t\t<div class="col-md-12 entry-content">\n');
                                    if (page) {
                                        arr.push('\t\t\t' + page.content.replace(/<img[^>]*src=(["'])([^"']+)(["'])[^>]*>/gi, function(match, p1, p2, p3) {
                                            return '<img src='+ p1 + 'data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' + p3 +' data-src='+ p1 + p2.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + p3 +' class='+ p1 + 'img-thumbnail' + p3 +' alt='+ p1 + page.title.replace(/<[^>]*>/g, ' ') + p3 +' title='+ p1 + page.title.replace(/<[^>]*>/g, ' ') + p3 +' />';
                                        }) + '\n');
                                    } else {
                                        arr.push('\t\t\t<p class="text-center text-muted>' + (data.localize && data.localize.no_pages ? data.localize.no_pages : '还没有页面') + '</p>\n');
                                    }
                                    arr.push('\t\t</div>\n');
                                    arr.push('\t</div>\n');
                                }
                                arr.push('</div>\n');
                            } else {
                                arr.push('\t<div class="row">\n');
                                // 左侧列表
                                arr.push('\t\t<div class="col-md-8">\n');
                                // 子页面
                                if (childs.length) {
                                    arr.push(render.list_page(childs));
                                } else {
                                    arr.push('\t\t\t<div class="panel panel-default">\n');
                                    arr.push('\t\t\t\t<div class="panel-body">\n');
                                    // 页面内容
                                    arr.push('\t\t\t\t\t<div class="row">\n');
                                    arr.push('\t\t\t\t\t\t<div class="col-md-12 entry-content">\n');
                                    if (page) {
                                        arr.push('\t\t\t\t\t\t\t' + page.content.replace(/<img[^>]*src=(["'])([^"']+)(["'])[^>]*>/gi, function(match, p1, p2, p3) {
                                            return '<img src='+ p1 + 'data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' + p3 +' data-src='+ p1 + p2.replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1') + p3 +' class='+ p1 + 'img-thumbnail' + p3 +' alt='+ p1 + page.title.replace(/<[^>]*>/g, ' ') + p3 +' title='+ p1 + page.title.replace(/<[^>]*>/g, ' ') + p3 +' />';
                                        }) + '\n');
                                    } else {
                                        arr.push('\t\t\t\t\t\t\t<p class="text-center text-muted">' + (data.localize && data.localize.no_pages ? data.localize.no_pages : '还没有页面') + '</p>\n');
                                    }
                                    arr.push('\t\t\t\t\t\t</div>\n');
                                    arr.push('\t\t\t\t\t</div>\n');
                                    arr.push('\t\t\t\t</div>\n');
                                    arr.push('\t\t\t</div>\n');
                                }
                                arr.push('\t\t</div>\n');
                                arr.push(render.sidebar(data));
                                arr.push('\t</div>\n');
                            }
                        } else {
                            var title = data.localize && data.localize.page_not_found ? data.localize.page_not_found : '页面未找到';
                            var msg = data.localize && data.localize.sorry_not_found ? data.localize.sorry_not_found : '抱歉，你要访问的页面不存在！'
                            arr.push(render.info(title, msg));
                        }
                    }
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 收藏页面
                page_favorites: function (data, page) {
                    var arr = [];
                    arr.push('<div class="container">\n');
                    arr.push('\t<div class="row">\n');
                    // 左侧列表
                    arr.push('\t\t<div class="col-md-8">\n');
                    // 左侧顶部
                    arr.push('\t\t\t<div class="panel panel-default">\n');
                    arr.push('\t\t\t\t<div class="panel-body">\n');
                    // 页面描述
                    var match = page.content.match(/<img[^>]*src=["']([^"']*)["'][^>]*>/i);
                    page.cover = (page.cover || (match ? match[1] : '')).replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1');
                    arr.push('\t\t\t\t\t<div class="row">\n');
                    arr.push('\t\t\t\t\t\t<div class="col-sm-2 col-md-2">\n');
                    arr.push('\t\t\t\t\t\t\t<img class="img-thumbnail" style="width:100%;max-height:100px;background-color:#f1f1f1;" src="' + (page.cover || 'data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'32\' height=\'32\' viewBox=\'0 0 32 32\'%3E%3Cpath d=\'M32 12.408l-11.056-1.607-4.944-10.018-4.944 10.018-11.056 1.607 8 7.798-1.889 11.011 9.889-5.199 9.889 5.199-1.889-11.011 8-7.798z\'%3E%3C/path%3E%3C/svg%3E%0A') + '" alt="' + (page.title || (data.localize && data.localize.untitled ? data.localize.untitled : '无标题')) + '" title="' + (page.title || (data.localize && data.localize.untitled ? data.localize.untitled : '无标题')) + '" />\n');
                    arr.push('\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t\t<div class="col-sm-10 col-md-10">\n');
                    arr.push('\t\t\t\t\t\t\t<h1 style="margin-top: 0;">' + (page.title || (data.localize && data.localize.untitled ? data.localize.untitled : '无标题')) + ' <span class="label label-info"><i id="page-counts">0</i> ' + (data.localize && data.localize.articles ? data.localize.articles : '篇文章') + '</span></h1>\n');
                    arr.push('\t\t\t\t\t\t\t<p class="well well-sm">' + (page.description || (data.localize && data.localize.no_description ? data.localize.no_description : '还没有描述信息')) + '</p>\n');
                    arr.push('\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t</div>\n');
                    arr.push('\t\t\t</div>\n');
                    // 面板左侧列表
                    arr.push('\t\t\t<div class="panel panel-default">\n');
                    arr.push('\t\t\t\t<div class="panel-body" id="page-lists" data-slug="page-favorites" data-store="'+ (data.langs && data.langs.length ? 'multiPostFavorites' : 'postFavorites') +'"></div>\n');
                    arr.push('\t\t\t</div>\n');
                    arr.push('\t\t</div>\n');
                    // 右侧侧栏
                    arr.push(render.sidebar(data));
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 点赞页面
                page_likes: function (data, page) {
                    var arr = [];
                    arr.push('<div class="container">\n');
                    arr.push('\t<div class="row">\n');
                    // 左侧列表
                    arr.push('\t\t<div class="col-md-8">\n');
                    // 左侧顶部
                    arr.push('\t\t\t<div class="panel panel-default">\n');
                    arr.push('\t\t\t\t<div class="panel-body">\n');
                    // 页面描述
                    var match = page.content.match(/<img[^>]*src=["']([^"']*)["'][^>]*>/i);
                    page.cover = (page.cover || (match ? match[1] : '')).replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1');
                    arr.push('\t\t\t\t\t<div class="row">\n');
                    arr.push('\t\t\t\t\t\t<div class="col-sm-2 col-md-2">\n');
                    arr.push('\t\t\t\t\t\t\t<img class="img-thumbnail" style="width:100%;max-height:100px;background-color:#f1f1f1;" src="' + (page.cover || 'data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'32\' height=\'32\' viewBox=\'0 0 32 32\'%3E%3Cpath d=\'M29 18c2.281 0 1 6-1 6 1 0 0 5-2 5 0 2-2 3-4 3-8.448 0-5.477-2.114-14-3v-16c7.529-2.258 15-7.92 15-13 1.656 0 6 2 0 12 0 0 5 0 6 0 3 0 2 6 0 6zM6 13v16h2v1h-4c-1.1 0-2-1.35-2-3v-12c0-1.65 0.9-3 2-3h4v1h-2z\'%3E%3C/path%3E%3C/svg%3E%0A') + '" alt="' + (page.title || (data.localize && data.localize.untitled ? data.localize.untitled : '无标题')) + '" title="' + (page.title || (data.localize && data.localize.untitled ? data.localize.untitled : '无标题')) + '" />\n');
                    arr.push('\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t\t<div class="col-sm-10 col-md-10">\n');
                    arr.push('\t\t\t\t\t\t\t<h1 style="margin-top: 0;">' + (page.title || (data.localize && data.localize.untitled ? data.localize.untitled : '无标题')) + ' <span class="label label-info"><i id="page-counts">0</i> ' + (data.localize && data.localize.articles ? data.localize.articles : '篇文章') + '</span></h1>\n');
                    arr.push('\t\t\t\t\t\t\t<p class="well well-sm">' + (page.description || (data.localize && data.localize.no_description ? data.localize.no_description : '还没有描述信息')) + '</p>\n');
                    arr.push('\t\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t\t</div>\n');
                    arr.push('\t\t\t\t</div>\n');
                    arr.push('\t\t\t</div>\n');
                    // 面板左侧列表
                    arr.push('\t\t\t<div class="panel panel-default">\n');
                    arr.push('\t\t\t\t<div class="panel-body" id="page-lists" data-slug="page-likes" data-store="'+ (data.langs && data.langs.length ? 'multiPostLikes' : 'postLikes') +'"></div>\n');
                    arr.push('\t\t\t</div>\n');
                    arr.push('\t\t</div>\n');
                    // 右侧侧栏
                    arr.push(render.sidebar(data));
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 分页
                pager: function (count, limit) {
                    var arr = [];
                    var total = Math.max(Math.ceil(count / limit), 1);
                    var prev = Math.max(render.p - 1, 1);
                    var next = Math.min(render.p + 1, total);
                    var begin = 1;
                    var end = 1;
                    if (render.p <= 2) {
                        begin = 1;
                        end = Math.min(total, 5);
                    } else {
                        end = Math.min(render.p + 2, total);
                        begin = Math.max(end - 4, 1);
                    }
                    if (render.p < 1) {
                        render.p = 1;
                        location.hash = '#'+ render.route(render.lang, render.type, render.slug, render.p, render.q, render.anchor);
                    } else if (render.p > total) {
                        render.p = total;
                        location.hash = '#'+ render.route(render.lang, render.type, render.slug, render.p, render.q, render.anchor);
                    } else {
                        arr.push('<div class="row">\n');
                        arr.push('\t<div class="col-md-12 text-center">\n');
                        arr.push('\t\t<nav aria-label="Page navigation">\n');
                        arr.push('\t\t\t<ul class="pagination">\n');
                        arr.push('\t\t\t\t<li' + (render.p == 1 ? ' class="disabled"' : '') + '><a href="' + (render.p == 1 ? 'javascript:;' : '#' + render.route(render.lang, render.type, render.slug, prev, render.q, render.anchor)) + '" aria-label="Previous" title="Previous"><span aria-hidden="true">&laquo;</span></a></li>\n');
                        for (var i = begin; i <= end; i++) {
                            arr.push('\t\t\t\t<li' + (render.p == i ? ' class="active"' : '') + '><a href="' + (render.p == i ? 'javascript:;' : '#' + render.route(render.lang, render.type, render.slug, i, render.q, render.anchor)) + '" title="Page ' + i + '">' + i + '</a></li>\n');
                        }
                        arr.push('\t\t\t\t<li' + (render.p == total ? ' class="disabled"' : '') + '><a href="' + (render.p == total ? 'javascript:;' : '#' + render.route(render.lang, render.type, render.slug, next, render.q, render.anchor)) + '" aria-label="Next" title="Next"><span aria-hidden="true">&raquo;</span></a></li>\n')
                        arr.push('\t\t\t</ul>\n');
                        arr.push('\t\t</nav>\n');
                        arr.push('\t</div>\n');
                        arr.push('</div>\n');
                    }
                    return arr.join('');
                },

                // Ajax请求前
                beforeSend: function () {
                    // 重置变量
                    render.stop();
                    render.stopped = true;
                    render.audio = new Audio();
                    render.audioArray = [];
                    render.textArray = [];
                    render.nodes = [];
                    render.speechInstance = null;
                    render.offLine = false;
                    render.ttsApi = '';
                    render.playErrors = 0;
                    render.playErrorTimer = null;
                    render.timer = null;
                    render.affixTop = 0;
                    render.docHeight = 0;
                    // 解绑事件
                    $(window).off('click');
                    $(window).off('change');
                    $(window).off('submit');
                    $(window).off('scroll');
                    // 设置语言
                    $('html').attr('lang', render.lang);
                    render.loader();
                },

                // Ajax请求错误
                error: function (XMLHttpRequest, statusText) {
                    // 解绑事件
                    $(window).off('click');
                    $(window).off('change');
                    $(window).off('submit');
                    $(window).off('scroll');
                    if (XMLHttpRequest.responseText && XMLHttpRequest.responseText.match(/404 Not found/i)) {
                        return $('#app').html(render.err404());
                    }
                    $('#app').html(render.info('Error', 'Status code: ' + XMLHttpRequest.status));
                },

                // info信息
                info: function (title, msg) {
                    var arr = [];
                    arr.push('<div class="container">\n');
                    arr.push('\t<div class="panel panel-default">\n');
                    arr.push('\t\t<div class="panel-heading">\n');
                    arr.push('\t\t\t<h3 class="panel-title text-center text-muted">' + (title || 'Page not found') + '</h3>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t\t<div class="panel-body">\n');
                    arr.push('\t\t\t<p class="text-muted">'+ (msg || 'Sorry, The page you are looking for cannot be found!') +'</p>\n');
                    arr.push('\t\t</div>\n');
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    return arr.join('');
                },

                // 加载器
                loader: function () {
                    var arr = [];
                    $('#loader').remove();
                    arr.push('<div id="loader">\n');
                    arr.push('\t<div class="inner">\n');
                    arr.push('\t\t<h3>Loading...</h3>\n');
                    arr.push('\t\t<div id="loading"><i class="glyphicon icon-loading" aria-hidden="true"></i></div>\n');
                    arr.push('\t</div>\n');
                    arr.push('</div>\n');
                    $('#app').append(arr.join(''));
                },

                // 字符串截取
                cutstr: function (str, n, suffix) {
                    var len = 0;
                    var arr = [];
                    for (var i in str) {
                        arr.push(str[i]);
                        len += str[i].length;
                        if (str[i].charCodeAt(0).toString(16).length == 4) {
                            len += 1;
                        }
                        if (len > n) {
                            arr.pop();
                            arr.push(suffix || '...');
                            break;
                        }
                    }
                    return arr.join('');
                },

                // format key
                format: function(dataArr, key) {
                    var obj = {};
                    dataArr.forEach(function(item, i) {
                        obj[item[key]] = item;
                    });
                    return obj;
                },

                // levels tree
                levels: function(dataArr, pid, level) {
                    var res = [];
                    for (var i = 0; i < dataArr.length; i++) {
                        var data = dataArr[i];
                        if (data.pid == pid) {
                            var node = {};
                            for (var key in data) {
                                if (data.hasOwnProperty(key)) {
                                    node[key] = data[key];
                                }
                            }
                            node.level = level;
                            node.children = render.levels(dataArr, data.id, level + 1);
                            res.push(node);
                        }
                    }
                    return res;
                },

                // trees plat
                trees: function(dataArr, pid, level) {
                    var res = [];
                    for (var i = 0; i < dataArr.length; i++) {
                        var data = dataArr[i];
                        if (data.pid == pid) {
                            var node = {};
                            for (var key in data) {
                                if (data.hasOwnProperty(key)) {
                                    node[key] = data[key];
                                }
                            }
                            node.level = level;
                            res.push(node);
                            var childNodes = render.trees(dataArr, data.id, level + 1);
                            for (var j = 0; j < childNodes.length; j++) {
                                res.push(childNodes[j]);
                            }
                        }
                    }
                    return res;
                },

                // recursive root
                parents: function(dataArr, id) {
                    var res = [];
                    for (var i = 0; i < dataArr.length; i++) {
                    var data = dataArr[i];
                    if (data.id == id) {
                        var node = {};
                        for (var key in data) {
                            if (data.hasOwnProperty(key)) {
                                node[key] = data[key];
                            }
                        }
                        res.push(node);
                        var parentNodes = render.parents(dataArr, data.pid);
                        for (var j = 0; j < parentNodes.length; j++) {
                            res.push(parentNodes[j]);
                        }
                        break;
                    }
                    }
                    return res;
                },

                // plate level tree
                plates: function(dataArr, res) {
                    res = res || [];
                    for (var i = 0; i < dataArr.length; i++) {
                        var data = {};
                        for (var key in dataArr[i]) {
                            if (dataArr[i].hasOwnProperty(key)) {
                                data[key] = dataArr[i][key];
                            }
                        }
                        if (data.children) {
                            var children = data.children.slice();
                            delete data.children;
                            res.push(data);
                            render.plates(children, res);
                        } else {
                            res.push(data);
                        }
                    }
                    return res;
                },

                // 语音朗读
                play: function() {
                    $('.fixed-bottom .play-btn').removeClass('play-btn').addClass('pause-btn').html('<span class="glyphicon glyphicon-pause" aria-hidden="true"></span>');
                    $('.btn-group .btn-play').next('.btn-stop').remove();
                    $('.btn-group .btn-play').after('<button type="button" class="btn btn-default btn-stop" aria-label="Left Align"><span class="glyphicon glyphicon-stop" aria-hidden="true"></span></button>');
                    $('.btn-group .btn-play').removeClass('btn-play').addClass('btn-pause').html('<span class="glyphicon glyphicon-pause" aria-hidden="true"></span>');
                    if (render.stopped) {
                        if (render.nodes.length < 1) {
                            return false;
                        }
                        $('#loading').html('<i class="glyphicon icon-loading" aria-hidden="true"></i> Please wait ...');
                        var icon = new Image();
                        icon.src = 'https://translate.google.com/favicon.ico?t=' + new Date().getTime();
                        var timer = setTimeout(function () {
                            icon.onerror = icon.onload = null;
                            render.baidu_fanyi_tts();
                        }, 3000);
                        icon.onerror = function () {
                            clearTimeout(timer);
                            timer = null;
                            render.baidu_fanyi_tts();
                        }
                        icon.onload = function () {
                            clearTimeout(timer);
                            timer = null;
                            render.google_translate_tts();
                        }
                    } else {
                        if (!render.offLine) {
                            render.audio.play();
                        } else {
                            window.speechSynthesis.resume();
                        }
                    }
                    return false;
                },
                pause: function() {
                    $('.fixed-bottom .pause-btn').removeClass('pause-btn').addClass('play-btn').html('<span class="glyphicon glyphicon-play" aria-hidden="true"></span>');
                    $('.btn-group .btn-pause').removeClass('btn-pause').addClass('btn-play').html('<span class="glyphicon glyphicon-play" aria-hidden="true"></span>');
                    if (!render.offLine) {
                        render.audio.pause();
                    } else {
                        if (window.speechSynthesis.speaking) {
                            window.speechSynthesis.pause();
                        }
                    }
                    return false;
                },
                stop: function() {
                    $('.fixed-bottom .pause-btn').removeClass('pause-btn').addClass('play-btn').html('<span class="glyphicon glyphicon-play" aria-hidden="true"></span>');
                    $('.btn-group .btn-stop').prev('.btn').removeClass('btn-pause').addClass('btn-play').html('<span class="glyphicon glyphicon-play" aria-hidden="true"></span>');
                    $('.btn-group .btn-stop').remove();
                    if (!render.offLine) {
                        render.audio.pause();
                        render.audio.removeEventListener('ended', render.playEndedHandler);
                        render.audio.removeEventListener('error', render.playEndedHandler);
                        render.audioArray = [];
                    } else {
                        window.speechSynthesis.cancel();
                        render.speechInstance && render.speechInstance.removeEventListener('end', render.playEndedHandler);
                    }
                    render.stopped = true;
                    render.textArray = [];
                    for (var i = 0; i < render.nodes.length; i++) {
                        if (render.nodes[i].node.nodeType === 1) {
                            $(render.nodes[i].node).removeClass('tts');
                        }
                    }
                    return false;
                },
                google_translate_tts: function() {
                    render.offLine = false;
                    render.ttsApi = 'https://translate.google.com/translate_tts?client=webapp&ie=UTF-8&oe=UTF-8&tl=' + (render.voice || 'cmn-Hans-CN') + '&q=';
                    render.doPlay();
                },
                baidu_fanyi_tts: function() {
                    var icon = new Image();
                    icon.src = 'https://fanyi.baidu.com/favicon.ico?t=' + new Date().getTime();
                    var timer = setTimeout(function () {
                        icon.onerror = icon.onload = null;
                        if (render.offLine) {
                            render.doPlay();
                        } else {
                            render.stop();
                            $('#loading').html('<div class="text-warning"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Read error, please try again!</div>');
                        }
                    }, 3000);
                    icon.onerror = function () {
                        clearTimeout(timer);
                        timer = null;
                        if (render.offLine) {
                            render.doPlay();
                        } else {
                            render.stop();
                            $('#loading').html('<div class="text-warning"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Read error, please try again!</div>');
                        }
                    }
                    icon.onload = function () {
                        clearTimeout(timer);
                        timer = null;
                        var support = { 'zh-CN': 'zh', 'zh-TW': 'zh', en: 'en', ja: 'jp', ko: 'kor' };
                        if (support[render.lang]) {
                            render.offLine = false;
                            render.ttsApi = 'https://fanyi.baidu.com/gettts?lan=' + support[render.lang] + '&spd=5&source=web&text=';
                            render.doPlay();
                        } else {
                            $('#loading').html('<div class="text-warning"><span class="glyphicon glyphicon-alert"></span> Language not support, need scientific access internet.</div>');
                            $('.btn-group .btn-play').attr('disabled', true);
                        }
                    }
                },
                doPlay: function() {
                    var num = 200;
                    for (var i = 0; i < render.nodes.length; i++) {
                        var arrs = $(render.nodes[i].node).text().trim().split(/(\r\n|\r|\n)/g);
                        for (var j = 0; j < arrs.length; j++) {
                            var aAudioText = arrs[j].trim();
                            if (aAudioText && !render.offLine) {
                                while (aAudioText.length >= num) {
                                    var arr = [];
                                    for (var k in aAudioText) {
                                        arr.push(aAudioText[k]);
                                        if (arr.join('').length >= num) {
                                            arr.pop();
                                            break;
                                        }
                                    }
                                    var pos = arr.join('').length;
                                    render.textArray.push({ text: aAudioText.slice(0, pos), index: render.nodes[i].index });
                                    aAudioText = aAudioText.slice(pos);
                                }
                            }
                            aAudioText && render.textArray.push({ text: aAudioText, index: render.nodes[i].index });
                        }
                    }
                    if (render.textArray.length < 1) {
                        return false;
                    }
                    if (!render.offLine) {
                        for (var i = 0; i < render.textArray.length; i++) {
                            var address = render.ttsApi + encodeURIComponent(render.textArray[i].text);
                            if (render.ttsApi.match(/\/\/[\w]+\.google/)) {
                                address += '&tk=' + render.getTk(render.textArray[i].text);
                            }
                            render.audioArray.unshift(address);
                        }
                        render.audio.preload = true;
                        render.audio.controls = true;
                        render.audio.src = render.audioArray.pop();
                        render.audio.addEventListener('ended', render.playEndedHandler);
                        render.audio.addEventListener('error', render.playEndedHandler);
                        render.audio.loop = false;
                        render.audio.play();
                    }
                    render.stopped = false;
                    var reader = render.textArray.shift();
                    if (render.offLine) {
                        render.speechInstance = new SpeechSynthesisUtterance();
                        window.speechSynthesis.cancel();
                        render.speechInstance.lang = render.offLine;
                        render.speechInstance.text = reader.text;
                        window.speechSynthesis.speak(render.speechInstance);
                        render.speechInstance.addEventListener('end', render.playEndedHandler);
                    }
                    for (var i = 0; i < render.nodes.length; i++) {
                        if (reader.index == render.nodes[i].index) {
                            if (render.nodes[i].node.nodeType === 3) {
                                var wrapper = document.createElement('span');
                                render.nodes[i].node.parentNode.insertBefore(wrapper, render.nodes[i].node);
                                render.nodes[i].node.parentNode.removeChild(render.nodes[i].node);
                                wrapper.appendChild(render.nodes[i].node);
                                render.nodes[i].node = wrapper;
                            }
                            $(render.nodes[i].node).addClass('tts');
                        } else {
                            if (render.nodes[i].node.nodeType === 1) {
                                $(render.nodes[i].node).removeClass('tts');
                            }
                        }
                    }
                    $('#loading').html('');
                },
                playEndedHandler: function() {
                    render.playErrors = 0;
                    if (render.textArray.length > 0) {
                        if (!render.offLine) {
                            render.audio.src = render.audioArray.pop();
                            render.audio.play();
                        }
                        var reader = render.textArray.shift();
                        if (render.offLine) {
                            render.speechInstance.text = reader.text;
                            window.speechSynthesis.speak(render.speechInstance);
                        }
                        var elem = null;
                        for (var i = 0; i < render.nodes.length; i++) {
                            if (reader.index == render.nodes[i].index) {
                                if (render.nodes[i].node.nodeType === 3) {
                                    var wrapper = document.createElement('span');
                                    render.nodes[i].node.parentNode.insertBefore(wrapper, render.nodes[i].node);
                                    render.nodes[i].node.parentNode.removeChild(render.nodes[i].node);
                                    wrapper.appendChild(render.nodes[i].node);
                                    render.nodes[i].node = wrapper;
                                }
                                elem = render.nodes[i].node;
                                $(render.nodes[i].node).addClass('tts');
                            } else {
                                if (render.nodes[i].node.nodeType === 1) {
                                    $(render.nodes[i].node).removeClass('tts');
                                }
                            }
                        }
                        var clientHeight = $(window).height();
                        var scrollTop = $(window).scrollTop();
                        var pos = $(elem).offset().top;
                        var topH = $(elem).height();
                        if (pos > clientHeight + scrollTop - topH) {
                            $('html, body').stop().animate({
                                scrollTop: pos - 10
                            });
                        }
                    } else {
                        render.stop();
                        setTimeout(function () {
                            $('html, body').stop().animate({
                                scrollTop: 0
                            });
                        }, 1000);
                    }
                },
                playErrorHandler: function() {
                    render.playErrorTimer && clearTimeout(render.playErrorTimer);
                    render.playErrorTimer = setTimeout(function () {
                        if (render.playErrors % 10 < 9) {
                            render.playErrors++;
                            render.audio.src = render.audio.src.split('&t=')[0] + '&t=' + new Date().getTime();
                            render.audio.play();
                        } else {
                            clearTimeout(render.playErrorTimer);
                            render.playErrorTimer = null;
                            render.playErrors = 0;
                            render.stop();
                            $('#loading').html('<div class="text-warning"><span class="glyphicon glyphicon-alert"></span> Error! Audio error code: ' + render.audio.error.code + '</div>');
                        }
                    }, 3000 + Math.ceil(Math.random() * 2000));
                },

                // 简单加密
                encrypt: function (s) {
                    var es = [], c = '', ec = '';
                    s = s.split('');
                    for (var i = 0, length = s.length; i < length; i++) {
                        c = s[i];
                        ec = encodeURIComponent(c);
                        if (ec == c) {
                            ec = c.charCodeAt().toString(16);
                            ec = ('00' + ec).slice(-2);
                        }
                        es.push(ec);
                    }
                    return es.join('').replace(/%/g,'').toUpperCase();
                },

                // 字母图像
                generateAvatar: function(username) {
                    var canvas = document.createElement('canvas');
                    var context = canvas.getContext('2d');
                    // 设置画布尺寸
                    canvas.width = 200;
                    canvas.height = 200;
                    // 绘制背景
                    context.fillStyle = '#f4f4f4';
                    context.fillRect(0, 0, canvas.width, canvas.height);
                    // 绘制头像形状
                    context.beginPath();
                    context.arc(canvas.width / 2, canvas.height / 2, 80, 0, Math.PI * 2);
                    context.closePath();
                    context.clip();
                    // 绘制用户名首字母
                    context.fillStyle = '#555555';
                    context.font = '100px Arial';
                    context.textAlign = 'center';
                    context.textBaseline = 'middle';
                    context.fillText(username.charAt(0).toUpperCase(), canvas.width / 2, canvas.height / 2);
                    // 将生成的图像转为 base64 编码
                    var base64Image = canvas.toDataURL();
                    return base64Image;
                },

                // 谷歌百度tk算法(默认谷歌)
                getTk: function(a, t) {
                    var gtk = t ? '320305.131321201' : '406398.2087938574';
                    var e = gtk.split('.'), h = Number(e[0]) || 0, g = [], d = 0, i, j;
                    for (var f = 0; f < a.length; f++) {
                        var c = a.charCodeAt(f);
                        128 > c ? g[d++] = c : (2048 > c ? g[d++] = c >> 6 | 192 : (55296 == (c & 64512) && f + 1 < a.length && 56320 == (a.charCodeAt(f + 1) & 64512) ? (c = 65536 + ((c & 1023) << 10) + (a.charCodeAt(++f) & 1023), g[d++] = c >> 18 | 240, g[d++] = c >> 12 & 63 | 128) : g[d++] = c >> 12 | 224, g[d++] = c >> 6 & 63 | 128), g[d++] = c & 63 | 128)
                    }
                    a = h;
                    for (var d = 0; d < g.length; d++) {
                        a += g[d];
                        i = '+-a^+6';
                        for (var k = 0; k < i.length - 2; k += 3) {
                            j = i.charAt(k + 2);
                            j = 'a' <= j ? j.charCodeAt(0) - 87 : Number(j);
                            j = '+' == i.charAt(k + 1) ? a >>> j : a << j;
                            a = '+' == i.charAt(k) ? a + j & 4294967295 : a ^ j;
                        }
                    }
                    i = '+-3^+b+-f';
                    for (var k = 0; k < i.length - 2; k += 3) {
                        j = i.charAt(k + 2);
                        j = 'a' <= j ? j.charCodeAt(0) - 87 : Number(j);
                        j = '+' == i.charAt(k + 1) ? a >>> j : a << j;
                        a = '+' == i.charAt(k) ? a + j & 4294967295 : a ^ j;
                    }
                    a ^= Number(e[1]) || 0;
                    0 > a && (a = (a & 2147483647) + 2147483648);
                    a %= 1E6;
                    return a.toString() + '.' + (a ^ h);
                },

                // Cookie操作
                setCookie: function(name, value, options) {
                    options = options || {};
                    if (value === null) {
                        value = '';
                        options.expires = -1;
                    }
                    var expires = '';
                    if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {
                        var date;
                        if (typeof options.expires == 'number') {
                            date = new Date();
                            date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000));
                        } else {
                            date = options.expires;
                        }
                        // use expires attribute, max-age is not supported by IE
                        expires = '; expires=' + date.toUTCString();
                    }
                    var path = options.path ? '; path=' + options.path : '';
                    var domain = options.domain ? '; domain=' + options.domain : '';
                    var secure = options.secure ? '; secure' : '';
                    var c = [name, '=', encodeURIComponent(value)].join('');
                    var cookie = [c, expires, path, domain, secure].join('');
                    document.cookie = cookie;
                },
                getCookie: function(name) {
                    var cookieValue = null;
                    if (document.cookie && document.cookie != '') {
                        var cookies = document.cookie.split(';');
                        for (var i = 0; i < cookies.length; i++) {
                            var cookie = cookies[i].trim();
                            // Does this cookie string begin with the name we want?
                            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                break;
                            }
                        }
                    }
                    return cookieValue;
                },

                // 美化数据
                sanitize: function (data) {
                    // 侧栏固定
                    if ((render.type == 'detail' || render.type == 'category') && $('#panel-affix').length) {
                        render.docHeight = $(document).height();
                        render.affixTop = $('#panel-affix').offset().top;
                    }

                    var article = data.articles.filter(function(item, i) {
                        return render.type == 'detail' && item.slug == render.slug;
                    })[0];

                    // 点击数更新
                    if ($('.post-views').length && article) {
                        var views = parseInt(article.views);
                        var store = render.getItem(data.langs && data.langs.length ? 'multiPostViews' : 'postViews', 1) || [];
                        var obj = null;
                        while (store.length > 50) store.shift();
                        for (var i = 0; i < store.length; i++) {
                            if (store[i].id == article.id) {
                                obj = store[i];
                            }
                        }
                        if (obj) {
                            // 拒绝2小时内恶意刷新
                            if (+new Date() - obj.timestamp >= 2 * 3600 * 1000) {
                                obj.views = views + 1;
                                obj.timestamp = +new Date();
                                obj.lang = render.lang;
                                render.setItem(data.langs && data.langs.length ? 'multiPostViews' : 'postViews', store, 1);
                                $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/views.html', { id: article.id, views: views, token: render.token }, 'json');
                            }
                            $('.post-views').html(obj.views);
                        } else {
                            // 首次执行
                            store.push({ id: article.id, views: views + 1, timestamp: +new Date(), lang: render.lang });
                            render.setItem(data.langs && data.langs.length ? 'multiPostViews' : 'postViews', store, 1);
                            $('.post-views').html(views + 1);
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/views.html', { id: article.id, views: views, token: render.token }, 'json');
                        }
                    }

                    // 收藏文章
                    if ($('.entry-content').length && article) {
                        var store = render.getItem(data.langs && data.langs.length ? 'multiPostFavorites' : 'postFavorites') || [];
                        var obj = null;
                        for (var i = 0; i < store.length; i++) {
                            if (store[i].id == article.id) {
                                obj = store[i];
                            }
                        }
                        if (obj) {
                            $('.btn-favorite').removeClass('btn-warning').attr('title', (data.localize && data.localize.favorite_cancel ? data.localize.favorite_cancel : '取消收藏')).html('<span class="glyphicon glyphicon-star" aria-hidden="true"></span> ' + (data.localize && data.localize.favorite_success ? data.localize.favorite_success : '收藏成功'));
                        } else {
                            $('.btn-favorite').addClass('btn-warning').attr('title', (data.localize && data.localize.favorite_article ? data.localize.favorite_article : '收藏文章')).html('<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span> ' + (data.localize && data.localize.favorite_article ? data.localize.favorite_article : '收藏文章'));
                        }
                    }

                    // 点赞
                    if ($('.post-likes').length && article) {
                        var store = render.getItem(data.langs && data.langs.length ? 'multiPostLikes' : 'postLikes') || [];
                        var obj = null;
                        for (var i = 0; i < store.length; i++) {
                            if (store[i].id == article.id) {
                                obj = store[i];
                            }
                        }
                        if (obj) {
                            $('.btn-likes').addClass('disabled').addClass('btn-disabled');
                        }
                    }

                    // 更新点赞收藏文章数量
                    if ($('.panel-pages').length) {
                        var favorites = render.getItem(data.langs && data.langs.length ? 'multiPostFavorites' : 'postFavorites') || [];
                        var likes = render.getItem(data.langs && data.langs.length ? 'multiPostLikes' : 'postLikes') || [];
                        var findFavorites = [];
                        for (var i = 0; i < favorites.length; i++) {
                            if (favorites[i].lang == render.lang) {
                                findFavorites.push(favorites[i]);
                            }
                        }
                        var findLikes = [];
                        for (var i = 0; i < likes.length; i++) {
                            if (likes[i].lang == render.lang) {
                                findLikes.push(likes[i]);
                            }
                        }
                        $('#page-favorites').text(findFavorites.length);
                        $('#page-likes').text(findLikes.length);
                        $('.panel-pages .list-group .list-group-item').each(function (i, elem) {
                            $(elem).data('slug') == 'page-favorites' && $(elem).find('.badge').text(findFavorites.length);
                            $(elem).data('slug') == 'page-likes' && $(elem).find('.badge').text(findLikes.length);
                        });
                    }

                    // 获取收藏点赞文章列表
                    if ($('#page-lists').length) {
                        var slug = $('#page-lists').data('slug');
                        var storeName = slug == 'page-favorites' ? (data.langs && data.langs.length ? 'multiPostFavorites' : 'postFavorites') : (slug == 'page-likes' ? (data.langs && data.langs.length ? 'multiPostLikes' : 'postLikes') : '');
                        if (storeName == '') return false;
                        var ids = (render.getItem(storeName) || []).filter(function(item, i) {
                            return item.lang == render.lang;
                        }).map(function(item ,i) {
                            return parseInt(item.id);
                        });
                        var articles = data.articles.filter(function(item, i) {
                            return ids.indexOf(item.id) !== -1;
                        });
                        if (articles.length) {
                            var arr = [];
                            arr.push(render.list_item(articles.slice((render.p - 1) * render.limit, render.p * render.limit)));
                            // 分页
                            arr.push(render.pager(articles.length, render.limit));
                            $('#page-counts').text(articles.length);
                            $('#page-lists').html(arr.join(''));
                            evt_scroll();
                        } else {
                            $('#page-lists').html('<p class="text-center">' + (data.localize && data.localize.no_articles ? data.localize.no_articles : '还没有文章') + '</p>');
                        }
                    }

                    // 语音播报
                    if ($('.entry-content').length && data.setting.voice_read == '1') {
                        render.nodes = [];
                        render.offLine = false;
                        var ignore = ['STYLE', 'SCRIPT', 'IFRAME', 'VIDEO', 'AUDIO', 'SOURCE', 'PRE', 'CODE', 'IMG', 'BR', 'HR', 'TABLE', 'FORM', 'FIELDSET', 'LEGEND', 'LABEL', 'INPUT', 'TEXTAREA', 'SELECT', 'BUTTON'];
                        $('<meta name="referrer" content="same-origin" />').appendTo('head').remove();
                        $('.entry-content').contents().each(function (i, node) {
                            if (ignore.indexOf(node.tagName) === -1 && node.textContent.trim()) {
                                render.nodes.push({ node: node, index: i });
                            }
                        });
                        if ('speechSynthesis' in window) {
                            var i = 0;
                            var timer = setInterval(function () {
                                i++;
                                var voices = window.speechSynthesis.getVoices();
                                if (voices.length || i > 10) {
                                    clearInterval(timer);
                                    for (var j = 0; j < voices.length; j++) {
                                        if (voices[j].lang.indexOf(render.lang) !== -1) {
                                            render.offLine = voices[j].lang;
                                            break;
                                        }
                                    }
                                }
                            }, 100);
                        }
                    }

                    // 字母图像
                    if ($('.media .media-object.avatar').length) {
                        $('.media .media-object.avatar').each(function () {
                            if ($(this).attr('src').indexOf(render.site_url) == -1) {
                                $(this).attr('src', render.generateAvatar($(this).attr('alt')));
                            }
                        });
                    }

                    // zh-TW Lang
                    if (render.lang == 'zh-TW') {
                        var script = document.createElement('script');
                        script.type = 'text/javascript';
                        script.src = document.domain.match(/localhost|127.0.0.1/i) ? './static/js/jiantifanti-1.0.1.min.js' : 'https://fastly.jsdelivr.net/npm/jiantifanti@1.0.1/index.min.js';
                        script.onload = function() {
                            function zh_tranTW(obj, tran) {
                                var o = (typeof (obj) == 'object') ? obj.childNodes : document.body.childNodes;
                                for (var i = 0; i < o.length; i++) {
                                    var c = o.item(i);
                                    if (['BR', 'HR', 'TEXTAREA', 'SCRIPT'].indexOf(c.tagName) !== -1) continue;
                                    if (c.className != '' && c.className != null && c.className != undefined && c.className == 'ignore') continue;
                                    if (c.title != '' && c.title != null) {
                                        c.title = tran(c.title);
                                    }
                                    if (c.alt != '' && c.alt != null) {
                                        c.alt = tran(c.alt);
                                    }
                                    if (c.tagName == 'INPUT' && c.value != '' && c.type != 'text' && c.type != 'hidden' && c.type != 'password') {
                                        c.value = tran(c.value);
                                    }
                                    if (c.tagName == 'META' && c.getAttribute('name') == 'description' && c.getAttribute('content')) {
                                        c.setAttribute('content', tran(c.getAttribute('content')));
                                    }
                                    if (c.nodeType == 3) {
                                        c.data = tran(c.data);
                                    } else {
                                        zh_tranTW(c, tran);
                                    }
                                }
                            }
                            typeof jiantifanti == 'object' && zh_tranTW(document.body, jiantifanti.traditionalized);
                            typeof jiantifanti == 'object' && zh_tranTW(document.head, jiantifanti.traditionalized);
                        }
                        document.head.appendChild(script);
                    }

                    // mni-Mtei Lang
                    if (render.lang == 'mni-Mtei') {
                        var style = document.createElement('link');
                        style.rel = 'stylesheet';
                        style.href = document.domain.match(/localhost|127.0.0.1/i) ? './static/css/meetei-mayek.css' : 'https://fonts.googleapis.com/css?family=Noto Sans Meetei Mayek';
                        style.crossOrigin = 'anonymous';
                        style.onload = function() {
                            var font = 'Noto Sans Meetei Mayek'
                            var fonts = document.body.style.fontFamily.split(',').map(function(item) {
                                return item.trim();
                            }).filter(function(item) {
                                return item;
                            }) || [];
                            if (fonts.indexOf(font) === -1) {
                                fonts.push(font);
                                document.body.style.fontFamily = fonts.join(',');
                            }
                        }
                        document.head.appendChild(style);
                    }

                    // 回顶与播放
                    $('body .fixed-bottom').css({
                        position: 'fixed',
                        right: 'calc(' + ($(window).width() > 1280 ? ($(window).width() - $('.container').outerWidth()) / 2 : 50) + 'px - 40px)',
                        bottom: '30px',
                        width: '40px',
                        textAlign: 'center',
                        color: '#fff',
                        cursor: 'pointer',
                        zIndex: 10,
                        display: 'none'
                    });
                    $('body .fixed-bottom .play-btn, body .fixed-bottom .pause-btn, body .fixed-bottom .back-top').css({
                        height: '40px',
                        lineHeight: '40px',
                        background: 'rgba(0,0,0,.3)',
                        borderRadius: '50%'
                    });

                    // 代码高亮
                    if (render.type == 'detail') {
                        $('.entry-content p:first').addClass('lead');
                        window.prettyPrint && window.prettyPrint();
                    }

                    // 模态弹出框
                    function alertBox(msg, title, btn, callback) {
                        var arr = [];
                        arr.push('<div class="modal fade bs-modal-alert" tabindex="-1" role="dialog">\n')
                        arr.push('\t<div class="modal-dialog modal-sm" role="document">\n');
                        arr.push('\t\t<div class="modal-content">\n');
                        arr.push('\t\t\t<div class="modal-header">\n');
                        arr.push('\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n');
                        arr.push('\t\t\t\t<h4 class="modal-title">' + (title ? title : (data.localize && data.localize.info ? data.localize.info : '信息')) + '</h4>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t\t<div class="modal-body" id="alertBox">' + msg + '</div>\n');
                        arr.push('\t\t\t<div class="modal-footer">\n');
                        arr.push('\t\t\t\t<button type="button" class="btn btn-default btn-close" data-dismiss="modal">' + (btn ? btn : (data.localize && data.localize.sure ? data.localize.sure : '确定')) + '</button>\n');
                        arr.push('\t\t\t</div>\n');
                        arr.push('\t\t</div>\n');
                        arr.push('\t</div>\n');
                        arr.push('</div>\n');
                        $('.bs-modal-alert').modal('hide');
                        $('.bs-modal-alert').remove();
                        $('body').append(arr.join(''));
                        $('.bs-modal-alert').modal('show');
                        typeof callback === 'function' && callback();
                    }

                    // 点击事件
                    function evt_click(e) {
                        // 模态框
                        var loginArr = [];
                        var forgetArr = [];
                        var registerArr = [];
                        loginArr.push('<div class="modal fade bs-modal-login" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">\n');
                        loginArr.push('\t<div class="modal-dialog modal-sm" role="document">\n');
                        loginArr.push('\t\t<div class="modal-content">\n');
                        loginArr.push('\t\t\t<div class="modal-header">\n');
                        loginArr.push('\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n');
                        loginArr.push('\t\t\t\t<h4 class="modal-title">' + (data.localize && data.localize.login ? data.localize.login : '登录') + ' <small><a class="register" href="javascript:;" rel="nofollow" title="' + (data.localize && data.localize.switch_register ? data.localize.switch_register : '切换注册') + '">' + (data.localize && data.localize.switch_register ? data.localize.switch_register : '切换注册') + '</a></small></h4>\n');
                        loginArr.push('\t\t\t</div>\n');
                        loginArr.push('\t\t\t<div class="modal-body">\n');
                        loginArr.push('\t\t\t\t<form id="loginForm" class="loginForm" style="height: 240px;">\n');
                        loginArr.push('\t\t\t\t\t<div class="form-group">\n');
                        loginArr.push('\t\t\t\t\t\t<label for="inputUsername">' + (data.localize && data.localize.username ? data.localize.username : '用户名') + '</label>\n');
                        loginArr.push('\t\t\t\t\t\t<input type="text" class="form-control" name="username" value="anonymous" id="inputUsername" autocomplete="off" required placeholder="' + (data.localize && data.localize.username_or_email ? data.localize.username_or_email : '用户名或邮箱') + '" />\n');
                        loginArr.push('\t\t\t\t\t</div>\n');
                        loginArr.push('\t\t\t\t\t<div class="form-group">\n');
                        loginArr.push('\t\t\t\t\t\t<label for="inputPasswrod">' + (data.localize && data.localize.password ? data.localize.password : '密码') + '</label>\n');
                        loginArr.push('\t\t\t\t\t\t<input type="password" class="form-control" name="password" value="123456" id="inputPasswrod" autocomplete="off" required placeholder="' + (data.localize && data.localize.input_password ? data.localize.input_password : '请输入密码') + '" />\n');
                        loginArr.push('\t\t\t\t\t</div>\n');
                        loginArr.push('\t\t\t\t\t<div class="form-group">\n');
                        loginArr.push('\t\t\t\t\t\t<div style="position: relative;">\n');
                        loginArr.push('\t\t\t\t\t\t\t<label></label>\n');
                        loginArr.push('\t\t\t\t\t\t\t<a class="forget pull-right" href="javascript:;" rel="nofollow" title="' + (data.localize && data.localize.forget_password ? data.localize.forget_password : '忘记密码') + '">' + (data.localize && data.localize.forget_password ? data.localize.forget_password : '忘记密码') + '?</a>\n');
                        loginArr.push('\t\t\t\t\t\t</div>\n');
                        loginArr.push('\t\t\t\t\t</div>\n');
                        loginArr.push('\t\t\t\t\t<div class="form-group" style="position: relative;">\n');
                        loginArr.push('\t\t\t\t\t\t<input type="hidden" name="token" value="' + render.token + '" />\n');
                        loginArr.push('\t\t\t\t\t\t<button type="submit" class="btn btn-primary pull-right">' + (data.localize && data.localize.login ? data.localize.login : '登录') + '</button>\n');
                        loginArr.push('\t\t\t\t\t\t<span class="tips"></span>\n');
                        loginArr.push('\t\t\t\t\t</div>\n');
                        loginArr.push('\t\t\t\t</form>\n');
                        loginArr.push('\t\t\t</div>\n');
                        loginArr.push('\t\t</div>\n');
                        loginArr.push('\t</div>\n');
                        loginArr.push('</div>\n');
                        forgetArr.push('<div class="modal fade bs-modal-forget" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">\n');
                        forgetArr.push('\t<div class="modal-dialog modal-sm" role="document">\n');
                        forgetArr.push('\t\t<div class="modal-content">\n');
                        forgetArr.push('\t\t\t<div class="modal-header">\n');
                        forgetArr.push('\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n');
                        forgetArr.push('\t\t\t\t<h4 class="modal-title">' + (data.localize && data.localize.forget ? data.localize.forget : '找回密码') + ' <small><a class="login" href="javascript:;" rel="nofollow" title="' + (data.localize && data.localize.switch_login ? data.localize.switch_login : '切换登录') + '">' + (data.localize && data.localize.switch_login ? data.localize.switch_login : '切换登录') + '</a></small></h4>\n');
                        forgetArr.push('\t\t\t</div>\n');
                        forgetArr.push('\t\t\t<div class="modal-body">\n');
                        forgetArr.push('\t\t\t\t<form id="forgetForm" class="forgetForm" style="height: 350px;">\n');
                        forgetArr.push('\t\t\t\t\t<div class="form-group">\n');
                        forgetArr.push('\t\t\t\t\t\t<label for="inputForgetEmail">' + (data.localize && data.localize.email_address ? data.localize.email_address : '邮箱地址') + '</label>\n');
                        forgetArr.push('\t\t\t\t\t\t<input type="email" class="form-control" name="email" value="" id="inputForgetEmail" autocomplete="off" required placeholder="' + (data.localize && data.localize.register_email ? data.localize.register_email : '您的注册邮箱') + '" />\n');
                        forgetArr.push('\t\t\t\t\t</div>\n');
                        forgetArr.push('\t\t\t\t\t<div class="form-group">\n');
                        forgetArr.push('\t\t\t\t\t\t<label for="inputForgetCaptcha">' + (data.localize && data.localize.verycode ? data.localize.verycode : '验证码') + '</label>\n');
                        forgetArr.push('\t\t\t\t\t\t<div class="row row-no-gutters">\n');
                        forgetArr.push('\t\t\t\t\t\t\t<div class="col-xs-5">\n');
                        forgetArr.push('\t\t\t\t\t\t\t\t<input type="text" class="form-control" name="captcha" value="" id="inputForgetCaptcha" autocomplete="off" required placeholder="' + (data.localize && data.localize.verycode ? data.localize.verycode : '验证码') + '" />\n');
                        forgetArr.push('\t\t\t\t\t\t\t</div>\n');
                        forgetArr.push('\t\t\t\t\t\t\t<div class="col-xs-7" style="padding-left: 10px;">\n');
                        forgetArr.push('\t\t\t\t\t\t\t\t<button type="button" class="btn btn-default fetchCode">' + (data.localize && data.localize.fetch_verycode ? data.localize.fetch_verycode : '获取验证码') + '</button>\n');
                        forgetArr.push('\t\t\t\t\t\t\t</div>\n');
                        forgetArr.push('\t\t\t\t\t\t</div>\n');
                        forgetArr.push('\t\t\t\t\t</div>\n');
                        forgetArr.push('\t\t\t\t\t<div class="form-group">\n');
                        forgetArr.push('\t\t\t\t\t\t<label for="inputForgetPasswrod">' + (data.localize && data.localize.new_password ? data.localize.new_password : '新密码') + '</label>\n');
                        forgetArr.push('\t\t\t\t\t\t<input type="password" class="form-control" name="password" value="" id="inputForgetPasswrod" autocomplete="off" required placeholder="' + (data.localize && data.localize.input_new_password ? data.localize.input_new_password : '设置新密码') + '" />\n');
                        forgetArr.push('\t\t\t\t\t</div>\n');
                        forgetArr.push('\t\t\t\t\t<div class="form-group">\n');
                        forgetArr.push('\t\t\t\t\t\t<label for="inputForgetRepeatPasswrod">' + (data.localize && data.localize.confirm_password ? data.localize.confirm_password : '确认密码') + '</label>\n');
                        forgetArr.push('\t\t\t\t\t\t<input type="password" class="form-control" name="repeat_password" value="" id="inputForgetRepeatPasswrod" autocomplete="off" required placeholder="' + (data.localize && data.localize.repeat_new_password ? data.localize.repeat_new_password : '确认新密码') + '" />\n');
                        forgetArr.push('\t\t\t\t\t</div>\n');
                        forgetArr.push('\t\t\t\t\t<div class="form-group" style="position: relative;">\n');
                        forgetArr.push('\t\t\t\t\t\t<input type="hidden" name="verify" value="reset">\n');
                        forgetArr.push('\t\t\t\t\t\t<input type="hidden" name="token" value="' + render.token + '" />\n');
                        forgetArr.push('\t\t\t\t\t\t<button type="submit" class="btn btn-primary pull-right">' + (data.localize && data.localize.submit ? data.localize.submit : '提交') + '</button>\n');
                        forgetArr.push('\t\t\t\t\t\t<span class="tips"></span>\n');
                        forgetArr.push('\t\t\t\t\t</div>\n');
                        forgetArr.push('\t\t\t\t</form>\n');
                        forgetArr.push('\t\t\t</div>\n');
                        forgetArr.push('\t\t</div>\n');
                        forgetArr.push('\t</div>\n');
                        forgetArr.push('</div>\n');
                        registerArr.push('<div class="modal fade bs-modal-register" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">\n');
                        registerArr.push('\t<div class="modal-dialog modal-sm" role="document">\n');
                        registerArr.push('\t\t<div class="modal-content">\n');
                        registerArr.push('\t\t\t<div class="modal-header">\n');
                        registerArr.push('\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n');
                        registerArr.push('\t\t\t\t<h4 class="modal-title">' + (data.localize && data.localize.register ? data.localize.register : '注册') + ' <small><a class="login" href="javascript:;" rel="nofollow" title="' + (data.localize && data.localize.switch_login ? data.localize.switch_login : '切换登录') + '">' + (data.localize && data.localize.switch_login ? data.localize.switch_login : '切换登录') + '</a></small></h4>\n');
                        registerArr.push('\t\t\t</div>\n');
                        registerArr.push('\t\t\t<div class="modal-body">\n');
                        registerArr.push('\t\t\t\t<form id="registerForm" class="registerForm" style="height: 500px;">\n');
                        registerArr.push('\t\t\t\t\t<div class="form-group">\n');
                        registerArr.push('\t\t\t\t\t\t<label for="inputRegUsername">' + (data.localize && data.localize.username ? data.localize.username : '用户名') + '</label>\n');
                        registerArr.push('\t\t\t\t\t\t<input type="text" class="form-control" name="username" value="" id="inputRegUsername" autocomplete="off" required placeholder="' + (data.localize && data.localize.input_username ? data.localize.input_username : '请输入用户名') + '" />\n');
                        registerArr.push('\t\t\t\t\t</div>\n');
                        registerArr.push('\t\t\t\t\t<div class="form-group">\n');
                        registerArr.push('\t\t\t\t\t\t<label for="inputRegPasswrod">' + (data.localize && data.localize.password ? data.localize.password : '密码') + '</label>\n');
                        registerArr.push('\t\t\t\t\t\t<input type="password" class="form-control" name="password" value="" id="inputRegPasswrod" autocomplete="off" required placeholder="' + (data.localize && data.localize.input_password ? data.localize.input_password : '请输入密码') + '" />\n');
                        registerArr.push('\t\t\t\t\t</div>\n');
                        registerArr.push('\t\t\t\t\t<div class="form-group">\n');
                        registerArr.push('\t\t\t\t\t\t<label for="inputRegRepeatPassword">' + (data.localize && data.localize.repeat_password ? data.localize.repeat_password : '重复密码') + '</label>\n');
                        registerArr.push('\t\t\t\t\t\t<input type="password" class="form-control" name="repeat_password" value="" id="inputRegRepeatPassword" autocomplete="off" required placeholder="' + (data.localize && data.localize.input_repeat_password ? data.localize.input_repeat_password : '请重输入密码') + '" />\n');
                        registerArr.push('\t\t\t\t\t</div>\n');
                        registerArr.push('\t\t\t\t\t<div class="form-group">\n');
                        registerArr.push('\t\t\t\t\t\t<label for="inputRegEmail">' + (data.localize && data.localize.email ? data.localize.email : '邮箱') + '</label>\n');
                        registerArr.push('\t\t\t\t\t\t<input type="email" class="form-control" name="email" value="" id="inputRegEmail" autocomplete="off" placeholder="' + (data.localize && data.localize.find_password_use ? data.localize.find_password_use : '找回密码用') + ' (' + (data.localize && data.localize.optional ? data.localize.optional : '可选') + ')" />\n');
                        registerArr.push('\t\t\t\t\t</div>\n');
                        registerArr.push('\t\t\t\t\t<div class="form-group">\n');
                        registerArr.push('\t\t\t\t\t\t<label for="inputRegNickname">' + (data.localize && data.localize.nickname ? data.localize.nickname : '昵称') + '</label>\n');
                        registerArr.push('\t\t\t\t\t\t<input type="text" class="form-control" name="nickname" value="" id="inputRegNickname" autocomplete="off" placeholder="' + (data.localize && data.localize.optional ? data.localize.optional : '可选') + '" />\n');
                        registerArr.push('\t\t\t\t\t</div>\n');
                        registerArr.push('\t\t\t\t\t<div class="form-group">\n');
                        registerArr.push('\t\t\t\t\t\t<label for="inputRegPhone">' + (data.localize && data.localize.phone ? data.localize.phone : '手机') + '</label>\n');
                        registerArr.push('\t\t\t\t\t\t<input type="text" class="form-control" name="phone" value="" id="inputRegPhone" autocomplete="off" placeholder="' + (data.localize && data.localize.optional ? data.localize.optional : '可选') + '" />\n');
                        registerArr.push('\t\t\t\t\t</div>\n');
                        registerArr.push('\t\t\t\t\t<div class="form-group" style="position: relative;">\n');
                        registerArr.push('\t\t\t\t\t\t<input type="hidden" name="token" value="' + render.token + '" />\n');
                        registerArr.push('\t\t\t\t\t\t<button type="submit" class="btn btn-primary pull-right">' + (data.localize && data.localize.register ? data.localize.register : '注册') + '</button>\n');
                        registerArr.push('\t\t\t\t\t\t<span class="tips"></span>\n');
                        registerArr.push('\t\t\t\t\t</div>\n');
                        registerArr.push('\t\t\t\t</form>\n');
                        registerArr.push('\t\t\t</div>\n');
                        registerArr.push('\t\t</div>\n');
                        registerArr.push('\t</div>\n');
                        registerArr.push('</div>\n');

                        // 多语切换
                        if ($(e.target).hasClass('multiLang')) {
                            var lang = $(e.target).data('lang');
                            render.setConfig(lang);
                            return setTimeout(function() {
                                location.hash = '#' + render.route(lang);
                            });
                        }

                        // 登录框
                        if ($(e.target).hasClass('login')) {
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/islogin.html', { token: render.token }, function (res) {
                                if (res.code) return alertBox(res.msg);
                                $('.bs-modal-login').remove();
                                $('body').append(loginArr.join(''));
                                $('.bs-modal-register').modal('hide');
                                $('.bs-modal-forget').modal('hide');
                                $('.bs-modal-login').modal('show');
                            }, 'json');
                            return false;
                        }

                        // 忘记密码
                        if ($(e.target).hasClass('forget')) {
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/islogin.html', { token: render.token }, function (res) {
                                if (res.code) return alertBox(res.msg);
                                $('.bs-modal-forget').remove();
                                $('body').append(forgetArr.join(''));
                                $('.bs-modal-login').modal('hide');
                                $('.bs-modal-register').modal('hide');
                                $('.bs-modal-forget').modal('show');
                            }, 'json');
                            return false;
                        }

                        // 获取验证码
                        if ($(e.target).hasClass('fetchCode')) {
                            var othis = $(e.target);
                            var email = othis.parent().parent().parent().prev().find('input[name="email"]').val();
                            if (!email) {
                                return $('#forgetForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + (data.localize && data.localize.input_email_address ? data.localize.input_email_address : '请输入邮箱地址'));
                            }
                            if (!/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(email)) {
                                return $('#forgetForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + (data.localize && data.localize.email_format_error ? data.localize.email_format_error : '邮箱格式错误'));
                            }
                            $('#forgetForm .tips').html('<i class="glyphicon icon-loading" aria-hidden="true"></i> ' + (data.localize && data.localize.sending ? data.localize.sending : '发送中') + '...');
                            // 倒计时函数
                            var count = 60;
                            othis.attr('disabled', true).addClass('disabled');
                            var timer = setInterval(function () {
                                count--;
                                othis.text((data.localize && data.localize.resend ? data.localize.resend : '重新发送') + ' (' + count + ')');
                                if (count <= 0) {
                                    clearInterval(timer);
                                    othis.attr('disabled', false).removeClass('disabled').text(data.localize && data.localize.fetch_verycode ? data.localize.fetch_verycode : '获取验证码');
                                }
                            }, 1000);
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/forget.html', { email: email, verify: 'send', token: render.token }, function (res) {
                                if (res.code) {
                                    clearInterval(timer);
                                    othis.attr('disabled', false).removeClass('disabled').text(data.localize && data.localize.fetch_verycode ? data.localize.fetch_verycode : '获取验证码');
                                    return $('#forgetForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + res.msg);
                                }
                                $('#forgetForm .tips').html('<span class="glyphicon glyphicon-ok" aria-hidden="true"></span> ' + res.msg);
                            }, 'json');
                            return false;
                        }

                        // 注册框
                        if ($(e.target).hasClass('register')) {
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/islogin.html', { token: render.token }, function (res) {
                                if (res.code) return alertBox(res.msg);
                                $('.bs-modal-register').remove();
                                $('body').append(registerArr.join(''));
                                $('.bs-modal-login').modal('hide');
                                $('.bs-modal-forget').modal('hide');
                                $('.bs-modal-register').modal('show');
                            }, 'json');
                            return false;
                        }

                        // 登出
                        if ($(e.target).hasClass('logout')) {
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/logout.html', { token: render.token }, function (res) {
                                if (res.code) return alertBox(res.msg);
                                if (undefined !== res.token) {
                                    render.token = '';
                                    render.removeItem('webToken');
                                }
                                alertBox(res.msg);
                                setTimeout(function () {
                                    location.reload();
                                }, 1000);
                            }, 'json');
                            return false;
                        }

                        // 客户端
                        if ($(e.target).hasClass('client')) {
                            window.open(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/static/upload/Jesus_Christ.zip');
                            return false;
                        }

                        // 控制台
                        if ($(e.target).hasClass('console')) {
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/islogin.html', { token: render.token }, function (res) {
                                if (res.code) return window.open(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/admin/');
                                window.open(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/admin/login.html');
                            }, 'json');
                            return false;
                        }

                        // 下载内容
                        if ($(e.target).hasClass('btn-download') && article) {
                            $.ajax({
                                type: 'POST',
                                url: render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/download.html',
                                data: { post_id: article.id },
                                dataType: 'json',
                                cache: false,
                                beforeSend: function () {
                                    $(e.target).attr('disabled', 'disabled').removeClass('btn-download');
                                    $(e.target).parent().next('.btn-group').next('.loading').remove();
                                    $(e.target).parent().next('.btn-group').after('<div class="text-muted loading" style="margin-top:10px"><i class="glyphicon icon-loading" aria-hidden="true"></i> ' + (data.localize && data.localize.merging ? data.localize.merging : '正在合成，请稍后') + '...</div>');
                                },
                                success: function (res) {
                                    if (res.code) {
                                        $(e.target).removeAttr('disabled').addClass('btn-download');
                                        $(e.target).parent().next('.btn-group').next('.loading').removeClass('text-muted').addClass('text-danger').html('<span class="glyphicon glyphicon-remove"></span> ' + res.msg);
                                    } else {
                                        $(e.target).removeAttr('disabled').removeClass('btn-download').attr('href', res.link).attr('download', (render.lang == 'zh-CN' ? '' : render.lang + '-') + 'ID' + (Array(7).join('0') + article.id).slice(-7) + '-' + render.lang + '-' + res.msg + '.html');
                                        $(e.target).parent().next('.btn-group').next('.loading').removeClass('text-muted').addClass('text-success').html('<span class="glyphicon glyphicon-ok"></span> ' + (data.localize && data.localize.merge_success ? data.localize.merge_success : '合成成功！再次点击按钮下载。'));
                                    }
                                    setTimeout(function () {
                                        $(e.target).parent().next('.btn-group').next('.loading').remove();
                                    }, 5000);
                                },
                                error: function (response) {
                                    $(e.target).removeAttr('disabled').addClass('btn-download');
                                    $(e.target).parent().next('.btn-group').next('.loading').removeClass('text-muted').addClass('text-warning').html('<span class="glyphicon glyphicon-alert"></span> Error! ' + response.statusText + ' ' + response.status);
                                    setTimeout(function () {
                                        $(e.target).parent().next('.btn-group').next('.loading').remove();
                                    }, 3000);
                                }
                            });
                            return false;
                        }

                        // 收藏文章
                        if ($(e.target).hasClass('btn-favorite') && article) {
                            var store = render.getItem(data.langs && data.langs.length ? 'multiPostFavorites' : 'postFavorites') || [];
                            var obj = null;
                            while(store.length > 500) store.pop();
                            for (var i = 0; i < store.length; i++) {
                                if (store[i].id == article.id) {
                                    obj = store[i];
                                }
                            }
                            if (!obj && $(e.target).hasClass('btn-warning')) {
                                $(e.target).removeClass('btn-warning').attr('title', (data.localize && data.localize.favorite_cancel ? data.localize.favorite_cancel : '取消收藏')).html('<span class="glyphicon glyphicon-star" aria-hidden="true"></span> ' + (data.localize && data.localize.favorite_success ? data.localize.favorite_success : '收藏成功'));
                                store.unshift({ id: article.id, timestamp: +new Date(), lang: render.lang });
                            } else {
                                $(e.target).addClass('btn-warning').attr('title', (data.localize && data.localize.favorite_article ? data.localize.favorite_article : '收藏文章')).html('<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span> ' + (data.localize && data.localize.favorite_article ? data.localize.favorite_article : '收藏文章'));
                                var newArr = [];
                                for (var i = 0; i < store.length; i++) {
                                    if (store[i].id == article.id)
                                        continue;
                                    newArr.push(store[i]);
                                }
                                store = newArr;
                            }
                            render.setItem(data.langs && data.langs.length ? 'multiPostFavorites' : 'postFavorites', store);
                            $('.panel-pages .list-group a[data-slug="page-favorites"]').find('.badge').text(store.length);
                            return false;
                        }

                        // 点赞
                        if ($(e.target).hasClass('btn-likes') && article) {
                            var store = render.getItem(data.langs && data.langs.length ? 'multiPostLikes' : 'postLikes') || [];
                            while(store.length > 500) store.pop();
                            if ($(e.target).hasClass('disabled') || $(e.target).hasClass('btn-disabled'))
                                return false;
                            $(e.target).addClass('disabled').addClass('btn-disabled');
                            store.unshift({ id: article.id, likes: parseInt(article.likes) + 1, timestamp: +new Date(), lang: render.lang });
                            render.setItem(data.langs && data.langs.length ? 'multiPostLikes' : 'postLikes', store);
                            $('.post-likes').html(parseInt(article.likes) + 1);
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/likes.html', { id: article.id, likes: parseInt(article.likes), token: render.token }, 'json');
                            $('.panel-pages .list-group a[data-slug="page-likes"]').find('.badge').text(store.length);
                            return false;
                        }

                        // 语音朗读
                        if (($(e.target).hasClass('btn-play') || $(e.target).parent().hasClass('btn-play')) && !$(e.target).prop('disabled') && !$(e.target).parent().prop('disabled')) {
                            return render.play();
                        }
                        if ($(e.target).hasClass('btn-pause') || $(e.target).parent().hasClass('btn-pause')) {
                            return render.pause();
                        }
                        if ($(e.target).hasClass('btn-stop') || $(e.target).parent().hasClass('btn-stop')) {
                            return render.stop();
                        }

                        // 更改字体大小
                        if ($(e.target).hasClass('font-zoom') || $(e.target).parent().hasClass('font-zoom')) {
                            var thisEle = $('.entry-content').css('font-size');
                            var textFontSize = parseFloat(thisEle);
                            var unit = thisEle.slice(-2); //
                            var cName = $(e.target).data('size') || $(e.target).parent().data('size');
                            if (cName == 'bigger') {
                                if (textFontSize <= 24) {
                                    textFontSize += 2;
                                }
                            } else if (cName == 'smaller') {
                                if (textFontSize >= 14) {
                                    textFontSize -= 2;
                                }
                            }
                            $('.entry-content').css('font-size', textFontSize + unit);
                            return false;
                        }

                        // 回复评论
                        if ($(e.target).hasClass('btn-reply') || $(e.target).parent().hasClass('btn-reply')) {
                            $('#comment-area .btn-cancel-reply').removeClass('btn-cancel-reply').addClass('btn-reply').removeClass('btn-danger').addClass('btn-success').html('<span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span> ' + (data.localize && data.localize.reply ? data.localize.reply : '回复'));
                            ($(e.target).hasClass('btn-reply') ? $(e.target) : $(e.target).parent()).removeClass('btn-reply').addClass('btn-cancel-reply').removeClass('btn-success').addClass('btn-danger').html(data.localize && data.localize.cancel_reply ? data.localize.cancel_reply : '取消回复').parent().after($('#commentForm'));
                            $(e.target).removeClass('btn-reply').addClass('btn-cancel-reply').removeClass('btn-success').addClass('btn-danger').html(data.localize && data.localize.cancel_reply ? data.localize.cancel_reply : '取消回复').parent().after($('#commentForm'));
                            $('#commentForm button[type="submit"]').html('@ ' + (data.localize && data.localize.reply_comment ? data.localize.reply_comment : '回复评论'));
                            $('#commentForm').find('input[name="pid"]').val(($(e.target).hasClass('btn-reply') ? $(e.target) : $(e.target).parent()).data('id'));
                            $('#commentForm').find('input[name="pid"]').val($(e.target).data('id'));
                            return false;
                        }

                        // 取消回复
                        if ($(e.target).hasClass('btn-cancel-reply') || $(e.target).parent().hasClass('btn-cancel-reply')) {
                            $('#comment-area').prepend($('#commentForm')).find('.btn-cancel-reply').removeClass('btn-cancel-reply').addClass('btn-reply').removeClass('btn-danger').addClass('btn-success').html('<span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span> ' + (data.localize && data.localize.reply ? data.localize.reply : '回复'));
                            $('#commentForm button[type="submit"]').html('<span class="glyphicon glyphicon-send" aria-hidden="true"></span> ' + (data.localize && data.localize.post_comment ? data.localize.post_comment : '发表评论'));
                            $('#commentForm').find('input[name="pid"]').val(0);
                            return false;
                        }

                        // 删除评论
                        if ($(e.target).hasClass('delete-comment')) {
                            if ($(e.target).parent().find('#commentForm').length) return false;
                            var comment_id = $(e.target).data('id');
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/delete_comment.html', { comment_id: comment_id, token: render.token }, function (res) {
                                if (res.code) return alertBox(res.msg);
                                var item = $('#comment-area #comment-' + comment_id);
                                var num = item.parent('.media-body').find('.media').length - 1;
                                if (num > 5) {
                                    if (!item.parent('.media-body').find('.pager').length) {
                                        var str = '<nav aria-label="Page navigation">\n';
                                        str += '<hr />\n';
                                        str += '<ul class="pager pager-reply" data-index="0">\n';
                                        str += '<li class="disabled" data-type="prev"><a href="javascript:;" title="Previous">Previous</a></li>\n';
                                        str += '<li data-type="next"><a href="javascript:;" title="Next">Next</a></li>\n';
                                        str += '<li data-type="all"><a href="javascript:;" title="All">All</a></li>\n';
                                        str += '</ul>\n';
                                        str += '</nav>\n';
                                        item.parent('.media-body').append(str);
                                    }
                                } else {
                                    item.parent('.media-body').find('.pager').parent().remove();
                                    item.parent('.media-body').find('.media').removeClass('hidden');
                                }
                                item.remove();
                                !$('#comment-area>.panel').length && $('<p class="text-center text-muted no-comment">' + (data.localize && data.localize.no_comment ? data.localize.no_comment : '还没有评论') + '</p>').appendTo('#comment-area');
                            }, 'json');
                            return false;
                        }

                        // 回复评论分页
                        if ($(e.target).parent().parent().hasClass('pager-reply')) {
                            var type = $(e.target).parent().data('type');
                            var index = parseInt($(e.target).parent().parent().data('index'));
                            var total = $(e.target).parent().parent().parent().parent().children('.media').length;
                            if ($(e.target).parent().hasClass('disabled')) return false;
                            if (type === 'all') {
                                $(e.target).parent().parent().children('li').addClass('disabled');
                                $(e.target).parent().parent().parent().parent().children('.media').removeClass('hidden');
                                $(e.target).parent().parent().parent().remove();
                                return false;
                            }
                            if (type === 'prev') {
                                index -= 5;
                                if (index <= 0) index = 0;
                            }
                            if (type === 'next') {
                                index += 5;
                                if (index >= total) index -= 5;
                            }
                            $(e.target).parent().parent().data('index', index);
                            if (index === 0) {
                                $(e.target).parent().parent().children('li[data-type="prev"]').addClass('disabled');
                            } else {
                                $(e.target).parent().parent().children('li[data-type="prev"]').removeClass('disabled');
                            }
                            if (index + 5 >= total) {
                                $(e.target).parent().parent().children('li[data-type="next"]').addClass('disabled');
                            } else {
                                $(e.target).parent().parent().children('li[data-type="next"]').removeClass('disabled');
                            }
                            $(e.target).parent().parent().parent().parent().children('.media').each(function (i, elem) {
                                if (i < index || i >= index + 5) {
                                    $(elem).addClass('hidden');
                                } else {
                                    $(elem).removeClass('hidden');
                                }
                            });
                            return false;
                        }


                        // 侧栏分页
                        if ($(e.target).parent().parent().hasClass('pager-list')) {
                            var type = $(e.target).parent().data('type');
                            var index = parseInt($(e.target).parent().parent().data('index'));
                            var total = $(e.target).parent().parent().parent().parent().children('a.list-group-item').length;
                            if ($(e.target).parent().hasClass('disabled')) return false;
                            if (type === 'all') {
                                $(e.target).parent().parent().children('li').addClass('disabled');
                                $(e.target).parent().parent().parent().parent().children('a.list-group-item').removeClass('hidden');
                                $(e.target).parent().parent().parent().remove();
                                return false;
                            }
                            if (type === 'prev') {
                                index -= 10;
                                if (index <= 0) index = 0;
                            }
                            if (type === 'next') {
                                index += 10;
                                if (index >= total) index -= 10;
                            }
                            $(e.target).parent().parent().data('index', index);
                            if (index === 0) {
                                $(e.target).parent().parent().children('li[data-type="prev"]').addClass('disabled');
                            } else {
                                $(e.target).parent().parent().children('li[data-type="prev"]').removeClass('disabled');
                            }
                            if (index + 10 >= total) {
                                $(e.target).parent().parent().children('li[data-type="next"]').addClass('disabled');
                            } else {
                                $(e.target).parent().parent().children('li[data-type="next"]').removeClass('disabled');
                            }
                            $(e.target).parent().parent().parent().parent().children('a.list-group-item').each(function (i, elem) {
                                if (i < index || i >= index + 10) {
                                    $(elem).addClass('hidden');
                                } else {
                                    $(elem).removeClass('hidden');
                                }
                            });
                            return false;
                        }

                        // 回顶与播放
                        if ($(e.target).hasClass('pause-btn') || $(e.target).parent().hasClass('pause-btn')) {
                            $('.btn-group .btn-pause').trigger('click');
                            return false;
                        }
                        if ($(e.target).hasClass('play-btn') || $(e.target).parent().hasClass('play-btn') || $(e.target).hasClass('resume-btn') || $(e.target).parent().hasClass('resume-btn')) {
                            if ($('.btn-group .btn-resume').length) {
                                $('.btn-group .btn-resume').trigger('click');
                            } else {
                                $('.btn-group .btn-play').trigger('click');
                            }
                            return false;
                        }
                        if ($(e.target).hasClass('back-top') || $(e.target).parent().hasClass('back-top')) {
                            $('html, body').stop().animate({
                                scrollTop: 0
                            });
                            return false;
                        }

                        // 社会化分享
                        if (($(e.target).hasClass('share-btn') || $(e.target).parent().hasClass('share-btn') || $(e.target).parent().parent().hasClass('share-btn')) && article) {
                            var platform = $(e.target).data('platform') || $(e.target).parent().data('platform') || $(e.target).parent().parent().data('platform');
                            var match = article.content.match(/<img[^>]*src=["']([^"']*)["'][^>]*>/i);
                            var shareData = {
                                title: encodeURIComponent((article.title + '-' + data.setting.webName).replace(/<[^>]*>/g, '')),
                                desc: encodeURIComponent(render.cutstr((article.description || article.content).replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' '), 70, '...')),
                                source: encodeURIComponent((location.protocol.match(/https?:/) ? location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') : render.cdn_url) + '/'),
                                url: encodeURIComponent((location.protocol.match(/https?:/) ? location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') : render.cdn_url) + '/#' + render.route(render.lang, 'detail', article.slug, 1, '', '')),
                                image: encodeURIComponent((article.cover || (match ? match[1] : '')).replace(/^.*?(\/static\/.+)$/i, render.cdn_url + '$1'))
                            };
                            var shareMethods = {
                                wechat: function () {
                                    alertBox('', data.localize.scan_wechat ? data.localize.scan_wechat : '微信扫一扫', '', function () {
                                        try {
                                            $('#alertBox').next('.modal-footer').remove();
                                            $('#alertBox').addClass('text-center').html('').qrcode({
                                                text: decodeURIComponent(shareData.url),
                                                width: 200,
                                                height: 200
                                            });
                                        } catch (e) { }
                                    });
                                },
                                qq: function () {
                                    window.open('http://connect.qq.com/widget/shareqq/index.html?url=' + shareData.url + '&title=' + shareData.title + '&pics=' + shareData.image + '&desc=' + shareData.desc, '_blank', 'width=600,height=400');
                                },
                                weibo: function () {
                                    window.open('http://service.weibo.com/share/share.php?url=' + shareData.url + '&title=' + shareData.title + '&pic=' + shareData.image, '_blank', 'width=600,height=400');
                                },
                                facebook: function () {
                                    window.open('https://www.facebook.com/sharer/sharer.php?u=' + shareData.url + '&title=' + shareData.title + '&description=' + shareData.desc + '&picture=' + shareData.image, '_blank', 'width=600,height=400');
                                },
                                twitter: function () {
                                    window.open('https://x.com/intent/tweet?text=' + shareData.title + '&url=' + shareData.url, '_blank', 'width=600,height=400');
                                },
                                linkedin: function () {
                                    window.open('https://www.linkedin.com/shareArticle?mini=true&url=' + shareData.url + '&title=' + shareData.title + '&summary=' + shareData.desc, '_blank', 'width=600,height=400');
                                },
                                pinterest: function () {
                                    window.open('https://pinterest.com/pin/create/button/?url=' + shareData.url + '&media=' + shareData.image + '&description=' + shareData.title, '_blank', 'width=600,height=400');
                                },
                                whatsapp: function () {
                                    window.open('https://api.whatsapp.com/send?text=' + shareData.title + '%20' + shareData.url, '_blank', 'width=600,height=400');
                                },
                                telegram: function () {
                                    window.open('https://telegram.me/share/url?url=' + shareData.url + '&text=' + shareData.title, '_blank', 'width=600,height=400');
                                },
                                email: function() {
                                    alertBox('<input type="email" class="form-control" id="share-email" placeholder="your@example.com"><span class="help-block" id="share-tips"></span>', data.localize.share_email ? data.localize.share_email : '分享到邮箱', data.localize.close ? data.localize.close : '关闭', function () {
                                        try {
                                            $('#alertBox').next('.modal-footer').append('<button type="button" class="btn btn-primary" id="send-share-email">'+ (data.localize && data.localize.send ? data.localize.send : '发送') +'</button>');
                                            $('#send-share-email').click(function() {
                                                var email = $('#share-email').val();
                                                if (!email) {
                                                    return $('#share-tips').html('<i class="glyphicon glyphicon-remove" aria-hidden="true"></i> ' + (data.localize && data.localize.input_email_address ? data.localize.input_email_address : '请输入邮箱地址'));
                                                }
                                                if (!/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(email)) {
                                                    return $('#share-tips').html('<i class="glyphicon glyphicon-remove" aria-hidden="true"></i> ' + (data.localize && data.localize.email_format_error ? data.localize.email_format_error : '邮箱格式错误'));
                                                }
                                                $('#share-tips').html('<i class="glyphicon icon-loading" aria-hidden="true"></i> ' + (data.localize && data.localize.sending ? data.localize.sending : '发送中') + '...');
                                                $('#send-share-email').attr('disabled', true).addClass('disabled');
                                                $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/share_email.html', { post_id: article.id, email: email, token: render.token }, function (res) {
                                                    $('#send-share-email').attr('disabled', false).removeClass('disabled');
                                                    if (res.code) {
                                                        return $('#share-tips').html('<i class="glyphicon glyphicon-remove" aria-hidden="true"></i> ' + res.msg);
                                                    }
                                                    $('#share-tips').html('<span class="glyphicon glyphicon-ok" aria-hidden="true"></span> ' + res.msg);
                                                }, 'json');
                                            });
                                        } catch (e) { }
                                    });
                                }
                            };
                            if (platform && shareMethods[platform]) {
                                shareMethods[platform]();
                            }
                            return false;
                        }
                    }

                    // 改变事件
                    function evt_change(e) {
                        // 多语切换
                        if ($(e.target).hasClass('selectLanguage')) {
                            var lang = $(e.target).val();
                            render.setConfig(lang);
                            return setTimeout(function() {
                                location.hash = '#' + render.route(lang);
                            });
                        }
                    }

                    // 提交事件
                    function evt_submit(e) {
                        e.preventDefault();
                        // 搜索框
                        if ($(e.target).hasClass('search-form')) {
                            var q = $(e.target).find('input[name="q"]').val().trim();
                            if (!q.length) return false;
                            location.hash = '#' + render.route(render.lang, 'search', 'i', 1, q, '');
                            return false;
                        }

                        // 登录
                        if ($(e.target).hasClass('loginForm')) {
                            $('#loginForm .tips').html('<i class="glyphicon icon-loading" aria-hidden="true"></i> ' + (data.localize && data.localize.logining ? data.localize.logining : '登录中') + '...');
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/login.html', $('#loginForm').serialize(), function (res) {
                                if (res.code) return $('#loginForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + res.msg);
                                $('#loginForm .tips').html('<span class="glyphicon glyphicon-ok" aria-hidden="true"></span> ' + res.msg + ', ' + (data.localize && data.localize.redirecting ? data.localize.redirecting : '跳转中') + '...');
                                if (undefined !== res.token) {
                                    render.token = render.encrypt(res.token);
                                    render.login = res.login;
                                    render.setItem('webToken', render.token);
                                }
                                setTimeout(function () {
                                    $('.bs-modal-login').modal('hide');
                                    location.reload();
                                }, 1000);
                            }, 'json');
                            return false;
                        }

                        // 忘记密码
                        if ($(e.target).hasClass('forgetForm')) {
                            var email = $('#forgetForm').find('input[name="email"]').val();
                            if (!email) {
                                return $('#forgetForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + (data.localize && data.localize.input_email_address ? data.localize.input_email_address : '请输入邮箱地址'));
                            }
                            if (!/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(email)) {
                                return $('#forgetForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + (data.localize && data.localize.email_format_error ? data.localize.email_format_error : '邮箱格式错误'));
                            }
                            $('#forgetForm .tips').html('<i class="glyphicon icon-loading" aria-hidden="true"></i> ' + (data.localize && data.localize.reseting ? data.localize.reseting : '重置中') + '...');
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/forget.html', $('#forgetForm').serialize(), function (res) {
                                if (res.code) return $('#forgetForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + res.msg);
                                $('#forgetForm .tips').html('<span class="glyphicon glyphicon-ok" aria-hidden="true"></span> ' + res.msg + ', ' + (data.localize && data.localize.redirecting ? data.localize.redirecting : '跳转中') + '...');
                                render.token = '';
                                render.login = 0;
                                render.removeItem('webToken');
                                setTimeout(function () {
                                    $('.bs-modal-forget').modal('hide');
                                    location.reload();
                                }, 1500);
                            }, 'json');
                            return false;
                        }

                        // 注册
                        if ($(e.target).hasClass('registerForm')) {
                            $('#registerForm .tips').html('<i class="glyphicon icon-loading" aria-hidden="true"></i> ' + (data.localize && data.localize.registering ? data.localize.registering : '注册中') + '...');
                            $.post(render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/register.html', $('#registerForm').serialize(), function (res) {
                                if (res.code) return $('#registerForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + res.msg);
                                $('#registerForm .tips').html('<span class="glyphicon glyphicon-ok" aria-hidden="true"></span> ' + res.msg + ', ' + (data.localize && data.localize.redirecting ? data.localize.redirecting : '跳转中') + '...');
                                if (undefined !== res.token) {
                                    render.token = render.encrypt(res.token);
                                    render.login = res.login;
                                    render.setItem('webToken', render.token);
                                }
                                setTimeout(function () {
                                    $('.bs-modal-register').modal('hide');
                                    location.reload();
                                }, 1000);
                            }, 'json');
                            return false;
                        }

                        // 提交评论
                        if ($(e.target).hasClass('commentForm')) {
                            var type = $('#comment-area .btn-cancel-reply').length;
                            $('#commentForm .tips').html('<i class="glyphicon icon-loading" aria-hidden="true"></i> ' + (data.localize && data.localize.submiting ? data.localize.submiting : '提交中') + '...');
                            $('#commentForm button[type="submit"]').attr('disabled', true);
                            $.ajax({
                                url: render.site_url + (render.lang == 'zh-CN' ? '' : '/' + render.lang) + '/ajax/comment.html',
                                type: 'POST',
                                dataType: 'json',
                                data: $('#commentForm').serialize(),
                                success: function (res) {
                                    if (res.code) {
                                        $('#commentForm .tips').html('<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> ' + res.msg);
                                        setTimeout(function () {
                                            $('#commentForm button[type="submit"]').attr('disabled', false);
                                            $('#commentForm .tips').html('');
                                        }, 2000);
                                        return false;
                                    }
                                    $('#commentForm .tips').html('<span class="glyphicon glyphicon-ok" aria-hidden="true"></span> ' + res.msg);
                                    var say = type ? res.data.nickname + ' ' + (data.localize && data.localize.reply ? data.localize.reply : '回复') + ': ' : '<strong>' + res.data.nickname + '</strong> <cite>' + (data.localize && data.localize.say ? data.localize.say : '说道') + ': </cite>';
                                    html = type ? '' : '<div class="panel panel-default" id="comment-' + res.data.id + '"><div class="panel-body">';
                                    html += '<div class="media" id="comment-' + res.data.id + '">';
                                    html += type ? '<hr style="margin-top: 10px;">' : '';
                                    html += '<div class="media-left">';
                                    html += '<img class="media-object img-circle avatar" style="width: 64px;height: 64px;background-color: #f1f1f1;" src="' + (res.data.avatar ? res.data.avatar : render.generateAvatar(res.data.nickname)) + '" alt="' + res.data.nickname + '">';
                                    html += '</div>';
                                    html += '<div class="media-body">';
                                    html += '<h4 class="media-heading">' + say + '</h4>';
                                    html += res.data.comment + (res.data.status != '0' ? ' [<span class="text-success">' + (data.localize && data.localize.pending ? data.localize.pending : '审核中') + '</span>]' : '');
                                    html += $('#commentForm input[name="can_delete"]').val() == '1' ? ' (<a href="javascript:;" class="delete-comment text-danger" data-id="' + res.data.id + '" title="' + (data.localize && data.localize.delete ? data.localize.delete : '删除') + '">' + (data.localize && data.localize.delete ? data.localize.delete : '删除') + '</a>) ' : '';
                                    html += type ? '' : '<div class="clearfix" style="margin: 10px 0;"><button type="button" data-id="' + res.data.id + '" class="pull-right btn btn-success btn-sm media-right btn-reply"><span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span> ' + (data.localize && data.localize.reply ? data.localize.reply : '回复') + '</button></div>';
                                    html += '</div>';
                                    html += '</div>';
                                    html += type ? '' : '</div></div>';
                                    $('#commentForm').after(html);
                                    $('#commentForm #comment').val(null);
                                    if (type) {
                                        var obj = $('#commentForm').parent('.media-body');
                                        var num = $('#commentForm').parent('.media-body').find('.media').length - 1;
                                        if (num > 4) {
                                            obj.find('.media').eq(5).addClass('hidden');
                                            if (!obj.find('.pager').length) {
                                                var str = '<nav aria-label="Page navigation">\n';
                                                str += '<hr />\n';
                                                str += '<ul class="pager pager-reply" data-index="0">\n';
                                                str += '<li class="disabled" data-type="prev"><a href="javascript:;">Previous</a></li>\n';
                                                str += '<li data-type="next"><a href="javascript:;">Next</a></li>\n';
                                                str += '<li data-type="all"><a href="javascript:;">All</a></li>\n';
                                                str += '</ul>\n';
                                                str += '</nav>\n';
                                                obj.append(str);
                                            }
                                        } else {
                                            obj.find('.pager').parent().remove();
                                        }
                                    }
                                    $('#comment-area>.panel').length && $('#comment-area>.no-comment').remove();
                                    setTimeout(function () {
                                        $('#commentForm .tips').html('');
                                        $('#commentForm button[type="submit"]').attr('disabled', false);
                                        $('#comment-area .btn-cancel-reply').trigger('click');
                                    }, 1000);
                                },
                                error: function (XMLHttpRequest, textStatus) {
                                    $('#commentForm .tips').html(textStatus + ': ' + XMLHttpRequest.status);
                                }
                            });
                            return false;
                        }
                    }

                    // 滚动事件
                    function evt_scroll(e) {
                        // 节流
                        if (render.timer) return false;
                        render.timer = setTimeout(function() {
                            // 图片懒加载
                            $('img').each(function (i, elem) {
                                if ($('html, body').scrollTop() + $(window).innerHeight() > $(elem).offset().top) {
                                    if ($(elem).attr('src').match(/^data:image/) && $(elem).data('src') && $(elem).data('src').match(/\./)) {
                                        $(elem).prop('src', $(elem).data('src'));
                                    }
                                }
                            });

                            // 模块跟随
                            if ($("#panel-affix").length) {
                                var scrollTop = $(window).scrollTop();
                                var newPosition = scrollTop - render.affixTop + 20;
                                var maxPosition = render.docHeight - (render.affixTop + $('#panel-affix').height() + 200);
                                if (scrollTop > render.affixTop && maxPosition > 0) {
                                    $('#panel-affix').css({ 'position': 'relative', 'top': Math.min(maxPosition, newPosition) });
                                } else {
                                    $('#panel-affix').css({ 'position': 'relative', 'top': 0 });
                                }
                            }

                            // 回顶与播放
                            if ($(window).scrollTop() > 300) {
                                $('body .fixed-bottom').css('display', 'block');
                            } else {
                                $('body .fixed-bottom').css('display', 'none');
                            }
                            clearTimeout(render.timer);
                            render.timer = null;
                        }, 500);
                    }

                    // 绑定事件
                    $(window).on('click', evt_click);
                    $(window).on('change', evt_change);
                    $(window).on('submit', evt_submit);
                    $(window).on('scroll', evt_scroll);
                    $('#carousel-example-generic').carousel('cycle');
                    evt_scroll();
                }
            }
            render.init();
        });
    </script>
</body>

</html>